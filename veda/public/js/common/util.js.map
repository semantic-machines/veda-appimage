{"version":3,"sources":["../../../source-web/js/common/util.js"],"names":["zeroPref","n","formatString","value","condition","language","veda","user","preferences","formatDate","date","day","getDate","month","getMonth","year","getFullYear","hours","getHours","mins","getMinutes","secs","getSeconds","UTChours","getUTCHours","UTCmins","getUTCMinutes","UTCsecs","getUTCSeconds","join","fdate","ftime","substr","formatNumber","replace","flattenIndividual","object","prefix","union","visited","uri","indexOf","property_uri","push","values","prefixed","i","length","type","individ","IndividualModel","data","isNew","properties","Backend","Util","mergeMutualChanges","high","low","base","key","merged","Object","hasOwnProperty","call","highBaseDiff","diff","lowBaseDiff","highLowDiff","lowHighDiff","missing","added","differ","conflicts","changed","hasValue","delta","decimalDatetimeReviver","Date","parseFloat","individual","property","any","filter","valueOf","toJson","JSON","stringify","simpleHash","str","char","hash","charCodeAt","processQuery","vql","sql","sort","limit","queryDelta","processDelta","pause","fn","fetchResult","cursor","query","ticket","from","top","databases","then","query_result","estimated","append","apply","result","fetchingProgress","console","log","Math","floor","toString","timeEnd","splice","processResult","toISOString","time","processPortion","portion","reduce","prom","item","catch","error","stack","Promise","resolve","total","processingProgress","setTimeout","genUri","uid","guid","test","d","getTime","performance","now","r","random","isInteger","formatValue","formatted","Number","String","forSubIndividual","net","id","func","forEach","el","removeSubIndividual","flatten","array","mutable","node","prototype","nodes","slice","pop","reverse","unique","arr","isFinite","isFloat","queryFromIndividualPT","orderBy","match","dir","clause","range","ontology","get","by","buildQuery","tables","where","keys","map","Error","table","oneProp","a","b","start","end","setHours","Boolean","lines","trim","split","lineQueries","line","words","acc","order","queryFromIndividualTT_SUB","withDeleted","groupBy","props","re","prop","sub","group","queryFromIndividualTT_JOIN","table_counter","_type","type_index","parent_prop","alias","table_aliased","where_aliased","queryFromIndividual","flat","allProps","getOwnPropertyNames","q","word","complexLabel","cache","get_cached","get_individual","get_localized_chain","startPoint","intermediates","parts","part","lang","toLowerCase","getTimezoneOffset","temp","propertyItem","availableLanguages","languages","languageValue","languageUri","typeValue","typeUri","pattern","replaced","indexes","substring","chain","localedChain","concat","err","areEqual","x","y","constructor","p"],"mappings":"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","sourcesContent":["// Utilities\n\nimport veda from '../common/veda.js';\n\nimport IndividualModel from '../common/individual_model.js';\n\nimport Backend from '../common/backend.js';\n\nconst Util = veda.Util || {};\n\nexport default veda.Util = Util;\n\nUtil.mergeMutualChanges = function (high, low, base) {\n  let key; const merged = {};\n  for (key in base) {\n    if (Object.hasOwnProperty.call(base, key)) {\n      merged[key] = base[key];\n    }\n  }\n  const highBaseDiff = Util.diff(high, base);\n  const lowBaseDiff = Util.diff(low, base);\n  const highLowDiff = Util.diff(high, low);\n  const lowHighDiff = Util.diff(low, high);\n  for (key in lowBaseDiff.missing) {\n    if (Object.hasOwnProperty.call(lowBaseDiff.missing, key)) {\n      delete merged[key];\n    }\n  }\n  for (key in highBaseDiff.missing) {\n    if (Object.hasOwnProperty.call(highBaseDiff.missing, key)) {\n      delete merged[key];\n    }\n  }\n  for (key in lowBaseDiff.added) {\n    if (Object.hasOwnProperty.call(lowBaseDiff.added, key)) {\n      merged[key] = lowBaseDiff.added[key];\n    }\n  }\n  for (key in highBaseDiff.added) {\n    if (Object.hasOwnProperty.call(highBaseDiff.added, key)) {\n      merged[key] = highBaseDiff.added[key];\n    }\n  }\n  for (key in lowBaseDiff.differ) {\n    if (Object.hasOwnProperty.call(lowBaseDiff.differ, key)) {\n      merged[key] = lowBaseDiff.differ[key];\n    }\n  }\n  for (key in highBaseDiff.diff) {\n    if (Object.hasOwnProperty.call(highBaseDiff.diff, key)) {\n      merged[key] = highBaseDiff.differ[key];\n    }\n  }\n  return {\n    merged: merged,\n    conflicts: {\n      high: highLowDiff.differ,\n      low: lowHighDiff.differ,\n    },\n  };\n};\n\nUtil.diff = function (changed, base) {\n  const delta = {\n    added: {},\n    missing: {},\n    differ: {},\n  };\n  let key; let values; let value; let length; let i; let hasValue;\n  for (key in base) {\n    if ( !(key in changed) ) {\n      delta.missing[key] = base[key];\n    } else {\n      if (key === '@') {\n        if (changed[key] !== base[key]) {\n          delta.differ[key] = changed[key];\n        }\n        continue;\n      }\n      values = base[key];\n      length = values.length;\n      hasValue = (length === changed[key].length);\n      for (i = 0; i < length && hasValue; i++) {\n        value = values[i];\n        hasValue = hasValue && Util.hasValue(changed, key, value);\n      }\n      if ( !hasValue ) {\n        delta.differ[key] = changed[key];\n      }\n    }\n  }\n  for (key in changed) {\n    if ( !(key in base) ) {\n      delta.added[key] = changed[key];\n    }\n  }\n  return delta;\n};\n\nUtil.decimalDatetimeReviver = function (key, value) {\n  return key === 'data' && this.type === 'Datetime' ? new Date(value) : key === 'data' && this.type === 'Decimal' ? parseFloat(value) : value;\n};\n\nUtil.hasValue = function (individual, property, value) {\n  const any = !!(individual && individual[property] && individual[property].length);\n  if (!value) return any;\n  return !!(any && individual[property].filter((i) => {\n    return (i.type === value.type && i.data.valueOf() === value.data.valueOf());\n  }).length);\n};\n\nUtil.toJson = function (value) {\n  return JSON.stringify(value, null, 2);\n};\n\nUtil.simpleHash = function (str) {\n  let hash = 0; let char;\n  if (str.length === 0) {\n    return hash;\n  }\n  for (let i = 0; i < str.length; i++) {\n    char = str.charCodeAt(i);\n    hash = ((hash<<5)-hash)+char;\n    hash = hash & hash;\n  }\n  return hash;\n};\n\nUtil.processQuery = function (vql, sql, sort, limit, queryDelta, processDelta, pause, fn) {\n  const fetchResult = function (cursor) {\n    const from = cursor || 0;\n    Backend.query({\n      ticket: veda.ticket,\n      query: vql,\n      sql: sql,\n      sort: sort || '\\'v-s:created\\' desc',\n      from: from,\n      top: queryDelta,\n      limit: limit,\n      databases: undefined\n    }).then((query_result) => {\n      const cursor = query_result.cursor;\n      const estimated = query_result.estimated;\n      if ( limit > estimated ) {\n        limit = estimated;\n      }\n      append.apply(result, query_result.result);\n      if ( cursor/limit - fetchingProgress >= 0.05 ) {\n        fetchingProgress = cursor/limit;\n        console.log('Fetching progress:', Math.floor(fetchingProgress * 100) + '%', '(' + cursor, 'of', limit + ')');\n      }\n      if ( cursor === estimated || cursor >= limit ) {\n        console.log((new Date()).toString(), 'Fetching done:', limit);\n        console.timeEnd('Fetching total');\n        result.splice(limit - cursor || limit); // cut result to limit\n        Util.processResult(result, processDelta, pause, fn);\n      } else {\n        fetchResult(query_result.cursor);\n      }\n    });\n  };\n\n  if (typeof vql === 'object') {\n    sort = vql.sort;\n    limit = vql.limit;\n    queryDelta = vql.queryDelta;\n    processDelta = vql.processDelta;\n    pause = vql.pause;\n    fn = vql.fn;\n    sql = vql.sql;\n    vql = vql.vql;\n  }\n  console.log((new Date()).toISOString(), 'Process query results |||', 'query:', vql || sql, ' | ', 'limit:', limit, ' | ', 'query delta:', queryDelta, ' | ', 'process delta:', processDelta, ' | ', 'pause:', pause);\n  const result = []; const append = [].push; let fetchingProgress = 0;\n  console.time('Fetching total');\n  fetchResult();\n  return;\n};\n\nUtil.processResult = function (result, delta, pause, fn) {\n  const processPortion = function () {\n    const portion = result.splice(0, delta);\n    portion.reduce((prom, item) => {\n      return prom.then(() => {\n        return fn(item);\n      }).catch((error) => {\n        console.log('Error processing item:', item);\n        console.log(error, error.stack);\n      });\n    }, Promise.resolve()).then(() => {\n      if ( (total - result.length) / total - processingProgress >= 0.05 ) {\n        processingProgress = (total - result.length) / total;\n        console.log('Processing progress:', Math.floor(processingProgress * 100) + '%', '(' + (total - result.length), 'of', total + ')');\n      }\n      if ( result.length ) {\n        setTimeout ? setTimeout(processPortion, pause) : processPortion();\n      } else {\n        console.log('Processing done:', total);\n        console.timeEnd('Processing total');\n      }\n    });\n  };\n\n  const total = result.length;\n  let processingProgress = 0;\n  console.log((new Date()).toISOString(), 'Process results |||', 'total:', total, ' | ', 'delta:', delta, ' | ', 'pause:', pause);\n  console.time('Processing total');\n  processPortion();\n};\n\nUtil.genUri = function () {\n  const uid = Util.guid(); const re = /^\\d/;\n  return (re.test(uid) ? 'd:a' + uid : 'd:' + uid);\n};\nUtil.guid = function () {\n  let d = new Date().getTime();\n  if (typeof performance !== 'undefined' && typeof performance.now === 'function') {\n    d += performance.now(); // use high-precision timer if available\n  }\n  return 'xxxxxxxxxxxxxxxxxxxxxxxxxx'.replace(/x/g, function (c) {\n    const r = (d + Math.random() * 36) % 36 | 0;\n    d = Math.floor(d / 36);\n    return r.toString(36);\n  });\n};\n\nUtil.isInteger = function (n) {\n  return n % 1 === 0;\n};\n\n/**\n * Prefix with 0 if number has single digit\n * @param {number} n\n * @return {string}\n */\nfunction zeroPref (n) {\n  return n > 9 ? String(n) : '0' + n;\n}\n\nUtil.formatValue = function (value) {\n  let formatted;\n  switch (true) {\n  case value instanceof Date:\n    formatted = formatDate(value);\n    break;\n  case value instanceof Number || typeof value === 'number':\n    formatted = formatNumber(value);\n    break;\n  case value instanceof String || typeof value === 'string':\n    formatted = formatString(value);\n    break;\n  default:\n    formatted = typeof value !== 'undefined' ? value.toString() : value;\n  }\n  return formatted;\n};\n\n/**\n * Format string\n * @param {Object} value\n * @return {string}\n */\nfunction formatString (value) {\n  const condition = !value.language || value.language === 'NONE' || ( veda.user && veda.user.preferences && veda.user.preferences.language && value.language in veda.user.preferences.language );\n  return condition ? value : undefined;\n}\n\n/**\n * Format date\n * @param {Date} date\n * @return {string}\n */\nfunction formatDate (date) {\n  const day = date.getDate();\n  const month = date.getMonth() + 1;\n  const year = date.getFullYear();\n  const hours = date.getHours();\n  const mins = date.getMinutes();\n  const secs = date.getSeconds();\n\n  const UTChours = date.getUTCHours();\n  const UTCmins = date.getUTCMinutes();\n  const UTCsecs = date.getUTCSeconds();\n  if ( (UTChours + UTCmins + UTCsecs) === 0 ) {\n    return [zeroPref(day), zeroPref(month), year].join('.');\n  }\n  const fdate = [zeroPref(day), zeroPref(month), year].join('.');\n  const ftime = [zeroPref(hours), zeroPref(mins), zeroPref(secs)].join(':');\n  return (fdate === '01.01.1970' ? '' : fdate) + (ftime === '00:00:00' ? '' : ' ' + ( secs === 0 ? ftime.substr(0, 5) : ftime) );\n};\n\n/**\n * Format date\n * @param {number} n\n * @return {string}\n */\nfunction formatNumber (n) {\n  return (n+'').replace(/.(?=(?:[0-9]{3})+\\b)/g, '$& ');\n};\n\nUtil.forSubIndividual = function (net, property, id, func) {\n  if (net[property] === undefined) {\n    return;\n  }\n  net[property].forEach((el) => {\n    if (el.id == id) {\n      func(el);\n    }\n  });\n};\n\nUtil.removeSubIndividual = function (net, property, id) {\n  if (net[property] === undefined) {\n    return;\n  }\n  return net[property].filter((item) => item.id !== id);\n};\n\n/*\n * from http://stackoverflow.com/questions/27266550/how-to-flatten-nested-array-in-javascript\n * by http://stackoverflow.com/users/2389720/aduch\n *\n * This is done in a linear time O(n) without recursion\n * memory complexity is O(1) or O(n) if mutable param is set to false\n */\nUtil.flatten = function (array, mutable) {\n  const toString = Object.prototype.toString;\n  const arrayTypeStr = '[object Array]';\n\n  const result = [];\n  const nodes = (mutable && array) || array.slice();\n  let node;\n\n  if (!array.length) {\n    return result;\n  }\n\n  node = nodes.pop();\n\n  do {\n    if (toString.call(node) === arrayTypeStr) {\n      nodes.push(...node);\n    } else {\n      result.push(node);\n    }\n  } while (nodes.length && (node = nodes.pop()) !== undefined);\n\n  result.reverse(); // we reverse result to restore the original order\n  return result;\n};\n\nUtil.unique = function (arr) {\n  const n = {}; const r = [];\n  for (let i = 0; i < arr.length; i++) {\n    if (!n[arr[i]]) {\n      n[arr[i]] = true;\n      r.push(arr[i]);\n    }\n  }\n  return r;\n};\n\nNumber.isFinite = Number.isFinite || function (value) {\n  return typeof value === 'number' && isFinite(value);\n};\nNumber.isInteger = Number.isInteger || function (value) {\n  return typeof value === 'number' &&\n    Number.isFinite(value) &&\n    !(value % 1);\n};\nNumber.isFloat = Number.isFloat || function (value) {\n  return typeof value === 'number' &&\n    Number.isFinite(value) &&\n    (value % 1);\n};\n\nUtil.queryFromIndividualPT = function (individual, sort) {\n  const orderBy = function (sort) {\n    if (typeof sort === 'string' || sort instanceof String) {\n      return sort.replace(/'(.+?)'\\s+(\\w+)/gi, function (match, property_uri, dir) {\n        const range = veda.ontology.properties[property_uri].get('rdfs:range')[0];\n        const by = property_uri.replace(re, '_');\n        let clause;\n        switch (range.id) {\n        case 'xsd:dateTime':\n          clause = by + '.date ' + dir;\n          break;\n        case 'xsd:boolean':\n        case 'xsd:integer':\n          clause = by + '.int ' + dir;\n          break;\n        case 'xsd:decimal':\n          clause = by + '.dec ' + dir;\n          break;\n        case 'xsd:string':\n        default:\n          clause = by + '.str ' + dir;\n          break;\n        }\n        return clause;\n      });\n    }\n  };\n\n  const buildQuery = function (individual) {\n    const tables = [];\n    let i = -1;\n    const where = Object.keys(individual.properties)\n      .map((property_uri) => {\n        if (property_uri.indexOf('.') >= 0 || property_uri.indexOf('*') >= 0) {\n          throw new Error('VQL style property nesting: ' + property_uri);\n        }\n        if (property_uri === '@') {\n          return;\n        }\n        i++;\n        const table = 'veda_pt.`' + property_uri + '` as p' + i;\n        tables[i] = table;\n        const values = individual.get(property_uri).sort((a, b) => a < b ? - 1 : a === b ? 0 : 1);\n        let oneProp;\n        switch (true) {\n        case Number.isInteger(values[0]):\n          oneProp = 'p' + i + '.int[1] >= ' + values[0] + ' AND p' + i + '.int[1] <= ' + values[values.length-1];\n          break;\n        case Number.isFloat(values[0]):\n          oneProp = 'p' + i + '.dec[1] >= ' + values[0] + ' AND p' + i + '.dec[1] <= ' + values[values.length-1];\n          break;\n        case values[0] instanceof Date:\n          let start = new Date(values[0]);\n          let end = new Date(values[values.length-1]);\n          start.setHours(0, 0, 0, 0);\n          end.setHours(23, 59, 59, 999);\n          start = Math.floor(start.valueOf() / 1000);\n          end = Math.floor(end.valueOf() / 1000);\n          oneProp = 'p' + i + '.date[1] >= toDateTime(' + start + ') AND p' + i + '.date[1] <= toDateTime(' + end + ')';\n          break;\n        case typeof values[0] === 'boolean':\n          oneProp = values\n            .map((value) => {\n              return 'p' + i + '.int[1] = ' + (value ? 1 : 0);\n            }).join(' OR ');\n          break;\n        case values[0] instanceof String:\n          oneProp = values\n            .filter(Boolean)\n            .map((value) => {\n              const q = value;\n              const lines = q.trim().split('\\n');\n              const lineQueries = lines.map((line) => {\n                const words = line\n                  .trim()\n                  .replace(/[-*\\s]+/g, ' ')\n                  .split(' ');\n                return words.length && 'arrayStringConcat(' + 'p' + i + '.str, \\' \\') LIKE \\'%' + words.join('% %').replace(/\\'/g, '\\\\\\'').replace(/\\\"/g, '\\'') + '%\\'';\n              });\n              return lineQueries.filter(Boolean).join(' OR ');\n            })\n            .filter(Boolean)\n            .join(' OR ');\n          break;\n        case values[0] instanceof IndividualModel:\n          oneProp = values\n            .filter(Boolean)\n            .map((value) => {\n              if ( value.isNew() ) {\n                return;\n              } else {\n                return 'has(' + 'p' + i + '.str, \\'' + value.id + '\\')';\n              }\n            })\n            .filter(Boolean)\n            .join(' OR ');\n          break;\n        }\n        if (!oneProp) {\n          return;\n        }\n        return oneProp.indexOf(' OR ') > 0 ? '( ' + oneProp + ' )' : oneProp;\n      })\n      .filter(Boolean)\n      .join(' AND ');\n\n    const from = tables.reduce((acc, table, i) => {\n      return acc ? acc + ' JOIN ' + table + ' ON p' + (i - 1) + '.id = p' + i + '.id' : table;\n    }, '');\n\n    return 'SELECT DISTINCT id FROM ' + from + (where ? ' WHERE ' + where : '');\n  };\n\n  const re = /[^a-zA-Z0-9]/g;\n  try {\n    let query = buildQuery;\n    const order = orderBy(sort);\n    query = query && order ? query + ' ORDER BY ' + order : query;\n    return query;\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nUtil.queryFromIndividualTT_SUB = function (individual, sort, withDeleted) {\n  const groupBy = function (sort) {\n    const by = 'id';\n    let props;\n    if (typeof sort === 'string' || sort instanceof String) {\n      props = sort.replace(/'(.+?)'\\s+(\\w+)/gi, function (match, property_uri) {\n        const range = veda.ontology.properties[property_uri].get('rdfs:range')[0];\n        let by = property_uri.replace(re, '_');\n        switch (range.id) {\n        case 'xsd:dateTime':\n          by = by + '_date';\n          break;\n        case 'xsd:boolean':\n        case 'xsd:integer':\n          by = by + '_int';\n          break;\n        case 'xsd:decimal':\n          by = by + '_dec';\n          break;\n        case 'xsd:string':\n        default:\n          by = by + '_str';\n          break;\n        }\n        return by;\n      });\n    }\n    return props ? by + ', ' + props : by;\n  };\n\n  const orderBy = function (sort) {\n    if (typeof sort === 'string' || sort instanceof String) {\n      return sort.replace(/'(.+?)'\\s+(\\w+)/gi, function (match, property_uri, dir) {\n        const range = veda.ontology.properties[property_uri].get('rdfs:range')[0];\n        const by = property_uri.replace(re, '_');\n        let clause;\n        switch (range.id) {\n        case 'xsd:dateTime':\n          clause = by + '_date ' + dir;\n          break;\n        case 'xsd:boolean':\n        case 'xsd:integer':\n          clause = by + '_int ' + dir;\n          break;\n        case 'xsd:decimal':\n          clause = by + '_dec ' + dir;\n          break;\n        case 'xsd:string':\n        default:\n          clause = by + '_str ' + dir;\n          break;\n        }\n        return clause;\n      });\n    }\n  };\n\n  const buildQuery = function (individual) {\n    if (individual.id in visited) {\n      return;\n    } else {\n      visited[individual.id] = true;\n    }\n    let where = Object.keys(individual.properties)\n      .map((property_uri, i) => {\n        if (property_uri.indexOf('.') >= 0 || property_uri.indexOf('*') >= 0) {\n          throw new Error('VQL style property nesting: ' + property_uri);\n        }\n        if (property_uri === '@' || property_uri === 'rdf:type') {\n          return;\n        }\n        const values = individual.get(property_uri).sort((a, b) => {\n          return a < b ? - 1 : a === b ? 0 : 1;\n        });\n        const prop = property_uri.replace(re, '_');\n        let oneProp;\n        switch (true) {\n        case Number.isInteger(values[0]):\n          oneProp = prop + '_int[1] >= ' + values[0] + ' AND ' + prop + '_int[1] <= ' + values[values.length-1];\n          break;\n        case Number.isFloat(values[0]):\n          oneProp = prop + '_dec[1] >= ' + values[0] + ' AND ' + prop + '_dec[1] <= ' + values[values.length-1];\n          break;\n          // Date\n        case values[0] instanceof Date:\n          let start = new Date(values[0]);\n          let end = new Date(values[values.length-1]);\n          start.setHours(0, 0, 0, 0);\n          end.setHours(23, 59, 59, 999);\n          start = Math.floor(start.valueOf() / 1000);\n          end = Math.floor(end.valueOf() / 1000);\n          oneProp = prop + '_date[1] >= toDateTime(' + start + ') AND ' + prop + '_date[1] <= toDateTime(' + end + ')';\n          break;\n        case typeof values[0] === 'boolean':\n          oneProp = values\n            .map((value) => {\n              return prop + '_int[1] = ' + (value ? 1 : 0);\n            }).join(' OR ');\n          break;\n        case values[0] instanceof String:\n          oneProp = values\n            .filter(Boolean)\n            .map((value) => {\n              const q = value;\n              const lines = q.trim().split('\\n');\n              const lineQueries = lines.map((line) => {\n                const words = line\n                  .trim()\n                  .replace(/[-*\\s]+/g, ' ')\n                  .split(' ');\n                // 'text' is a special single-value column without suffix with all text content of an individual\n                if ( /\\.\\*$/.test(prop) ) {\n                  prop = prop.replace('*', 'text');\n                }\n                if ( /\\.text$/.test(prop) ) {\n                  return words.length && prop + ' LIKE \\'%' + words.join('% %').replace(/\\'/g, '\\\\\\'').replace(/\\\"/g, '\\'') + '%\\'';\n                } else {\n                  return words.length && 'lowerUTF8(arrayStringConcat(' + prop + '_str, \\' \\')) LIKE lowerUTF8(\\'%' + words.join('% %').replace(/\\'/g, '\\\\\\'').replace(/\\\"/g, '\\'') + '%\\')';\n                }\n              });\n              return lineQueries.filter(Boolean).join(' OR ');\n            })\n            .filter(Boolean)\n            .join(' OR ');\n          break;\n        case values[0] instanceof IndividualModel:\n          oneProp = values\n            .filter(Boolean)\n            .map((value) => {\n              if ( value.isNew() ) {\n                const sub = buildQuery(value);\n                return sub ? prop + '_str IN ( ' + sub + ' )' : undefined;\n              } else {\n                return 'has(' + prop + '_str, \\'' + value + '\\')';\n              }\n            })\n            .filter(Boolean)\n            .join(' OR ');\n          break;\n        }\n        if (!oneProp) {\n          return;\n        }\n        return oneProp.indexOf(' OR ') > 0 ? '( ' + oneProp + ' )' : oneProp;\n      })\n      .filter(Boolean)\n      .join(' AND ');\n\n    if (!withDeleted) {\n      where += where ? ' AND ' : '';\n      where += 'NOT v_s_deleted_int = [1]';\n    }\n\n    if (Object.keys(visited).length > 1 && !where) {\n      return;\n    }\n\n    return individual.get('rdf:type')\n      .map((type) => {\n        const from = 'veda_tt.`' + type.id + '`';\n        const query = 'SELECT id FROM ' + from + (where ? ' WHERE ' + where : '');\n        return query;\n      })\n      .filter(Boolean)\n      .join(' UNION ALL ');\n  };\n\n  try {\n    let query = buildQuery(individual);\n    const group = groupBy(sort);\n    query = query && group ? query + ' GROUP BY ' + group : query;\n    const order = orderBy(sort);\n    query = query ? query + ' HAVING sum(sign) > 0' : query;\n    query = query && order ? query + ' ORDER BY ' + order : query;\n    return query;\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nUtil.queryFromIndividualTT_JOIN = function (individual, sort, withDeleted) {\n  let table_counter = 0;\n  const re = /[^a-zA-Z0-9]/g;\n  try {\n    return individual['rdf:type'].map((_type, type_index) => {\n      let from = '';\n      let where = '';\n      const visited = visited || {};\n      buildQuery(individual, undefined, type_index);\n      let query = from ? 'SELECT id FROM ' + from : '';\n      query = query && where ? query + ' WHERE ' + where : query;\n      const group = groupBy(sort);\n      query = query && group ? query + ' GROUP BY ' + group : query;\n      const order = orderBy(sort);\n      query = query ? query + ' HAVING sum(sign) > 0' : query;\n      query = query && order ? query + ' ORDER BY ' + order : query;\n      return query;\n\n      /**\n       * Form `group by` clause\n       * @param {string} sort\n       * @return {string}\n       */\n      function groupBy (sort) {\n        const by = 'id';\n        let props;\n        if (typeof sort === 'string' || sort instanceof String) {\n          props = sort.replace(/'(.+?)'\\s+(\\w+)/gi, function (match, property_uri) {\n            const range = veda.ontology.properties[property_uri].get('rdfs:range')[0];\n            let by = property_uri.replace(re, '_');\n            switch (range.id) {\n            case 'xsd:dateTime':\n              by = by + '_date';\n              break;\n            case 'xsd:boolean':\n            case 'xsd:integer':\n              by = by + '_int';\n              break;\n            case 'xsd:decimal':\n              by = by + '_dec';\n              break;\n            case 'xsd:string':\n            default:\n              by = by + '_str';\n              break;\n            }\n            return by;\n          });\n        }\n        return props ? by + ', ' + props : by;\n      }\n\n      /**\n       * Form `order by` clause\n       * @param {string} sort\n       * @return {string}\n       */\n      function orderBy (sort) {\n        if (typeof sort === 'string' || sort instanceof String) {\n          return sort.replace(/'(.+?)'\\s+(\\w+)/gi, function (match, property_uri, dir) {\n            const range = veda.ontology.properties[property_uri].get('rdfs:range')[0];\n            const by = property_uri.replace(re, '_');\n            let clause;\n            switch (range.id) {\n            case 'xsd:dateTime':\n              clause = by + '_date ' + dir;\n              break;\n            case 'xsd:boolean':\n            case 'xsd:integer':\n              clause = by + '_int ' + dir;\n              break;\n            case 'xsd:decimal':\n              clause = by + '_dec ' + dir;\n              break;\n            case 'xsd:string':\n            default:\n              clause = by + '_str ' + dir;\n              break;\n            }\n            return clause;\n          });\n        }\n      }\n\n      /**\n       * Recursive from & where population\n       * @param {IndividualModel} individual\n       * @param {string} parent_prop\n       * @param {number} type_index\n       */\n      function buildQuery (individual, parent_prop, type_index) {\n        if (!individual.hasValue('rdf:type')) {\n          return;\n        }\n        table_counter++;\n        type_index = type_index || 0;\n        const type = individual.get('rdf:type')[type_index].id;\n        const alias = 't' + table_counter;\n        visited[individual.id] = alias;\n        const table_aliased = 'veda_tt.`' + type + '` AS ' + alias;\n        if (!parent_prop) {\n          from += table_aliased;\n        } else {\n          from += ' JOIN ' + table_aliased + ' ON ' + parent_prop + ' = [' + alias + '.id]';\n        }\n\n        if (!withDeleted) {\n          where += where ? ' AND ' : '';\n          where += 'NOT ' + alias + '.v_s_deleted_int = [1]';\n        }\n\n        const where_aliased = Object.keys(individual.properties)\n          .map((property_uri, i) => {\n            if (property_uri.indexOf('.') >= 0 || property_uri.indexOf('*') >= 0) {\n              throw new Error('VQL style property nesting: ' + property_uri);\n            }\n            if (property_uri === '@' || property_uri === 'rdf:type') {\n              return;\n            }\n            const values = individual.get(property_uri).sort((a, b) => {\n              return a < b ? - 1 : a === b ? 0 : 1;\n            });\n            const prop = alias + '.' + property_uri.replace(re, '_');\n            let oneProp;\n            switch (true) {\n            case Number.isInteger(values[0]):\n              oneProp = prop + '_int[1] >= ' + values[0] + ' AND ' + prop + '_int[1] <= ' + values[values.length-1];\n              break;\n            case Number.isFloat(values[0]):\n              oneProp = prop + '_dec[1] >= ' + values[0] + ' AND ' + prop + '_dec[1] <= ' + values[values.length-1];\n              break;\n            case values[0] instanceof Date:\n              let start = new Date(values[0]);\n              let end = new Date(values[values.length-1]);\n              start.setHours(0, 0, 0, 0);\n              end.setHours(23, 59, 59, 999);\n              start = Math.floor(start.valueOf() / 1000);\n              end = Math.floor(end.valueOf() / 1000);\n              oneProp = prop + '_date[1] >= toDateTime(' + start + ') AND ' + prop + '_date[1] <= toDateTime(' + end + ')';\n              break;\n            case typeof values[0] === 'boolean':\n              oneProp = values\n                .map((value) => {\n                  return prop + '_int[1] = ' + (value ? 1 : 0);\n                }).join(' OR ');\n              break;\n            case values[0] instanceof String:\n              oneProp = values\n                .filter(Boolean)\n                .map((value) => {\n                  const q = value;\n                  const lines = q.trim().split('\\n');\n                  const lineQueries = lines.map((line) => {\n                    const words = line\n                      .trim()\n                      .replace(/[-*\\s]+/g, ' ')\n                      .split(' ');\n                    // 'text' is a special single-value column without suffix with all text content of an individual\n                    if ( /\\.\\*$/.test(prop) ) {\n                      prop = prop.replace('*', 'text');\n                    }\n                    if ( /\\.text$/.test(prop) ) {\n                      return words.length && prop + ' LIKE \\'%' + words.join('% %').replace(/\\'/g, '\\\\\\'').replace(/\\\"/g, '\\'') + '%\\'';\n                    } else {\n                      return words.length && 'lowerUTF8(arrayStringConcat(' + prop + '_str, \\' \\')) LIKE lowerUTF8(\\'%' + words.join('% %').replace(/\\'/g, '\\\\\\'').replace(/\\\"/g, '\\'') + '%\\')';\n                    }\n                  });\n                  return lineQueries.filter(Boolean).join(' OR ');\n                })\n                .filter(Boolean)\n                .join(' OR ');\n              break;\n            case values[0] instanceof IndividualModel:\n              oneProp = values\n                .filter(Boolean)\n                .map((value) => {\n                  if ( value.isNew() && !(value.id in visited)) {\n                    return buildQuery(value, prop + '_str');\n                  } else if ( value.isNew() && value.id in visited ) {\n                    return 'has(' + prop + '_str, ' + visited[value.id] + '.id' + ')';\n                  } else {\n                    return 'has(' + prop + '_str, \\'' + value + '\\')';\n                  }\n                })\n                .filter(Boolean)\n                .join(' OR ');\n              break;\n            }\n            if (!oneProp) {\n              return;\n            }\n            return oneProp.indexOf(' OR ') > 0 ? '( ' + oneProp + ' )' : oneProp;\n          })\n          .filter(Boolean)\n          .join(' AND ');\n\n        if (!where_aliased) {\n          return;\n        }\n\n        if (!where) {\n          where = where_aliased;\n        } else {\n          where += ' AND ' + where_aliased;\n        }\n      }\n    }).join(' UNION ALL ');\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nUtil.queryFromIndividual = function (individual) {\n  const flat = flattenIndividual(individual.properties);\n  if ( individual.hasValue('*') && individual.get('*')[0].indexOf('==') > 0 ) {\n    return individual.get('*')[0];\n  }\n  const allProps = Object.getOwnPropertyNames(flat)\n    .map((property_uri) => {\n      if (property_uri === '@' || property_uri === 'v-s:isDraft') {\n        return;\n      }\n      const values = flat[property_uri].sort((a, b) => {\n        return a.data < b.data ? - 1 : a.data === b.data ? 0 : 1;\n      });\n      let oneProp;\n      switch (values[0].type) {\n      case 'Integer':\n      case 'Decimal':\n        oneProp = '\\'' + property_uri + '\\'==[' + values[0].data + ',' + values[values.length-1].data + ']';\n        break;\n        // Date\n      case 'Datetime':\n        const start = new Date(values[0].data);\n        const end = new Date(values[values.length-1].data);\n        start.setHours(0, 0, 0, 0);\n        end.setHours(23, 59, 59, 999);\n        oneProp = '\\'' + property_uri + '\\'==[' + start.toISOString() + ',' + end.toISOString() + ']';\n        break;\n      case 'Boolean':\n        oneProp = values\n          .map((value) => {\n            return '\\'' + property_uri + '\\'==\\'' + value.data + '\\'';\n          })\n          .join(' || ');\n        break;\n      case 'String':\n        oneProp = values\n          .filter((item) => !!item && !!item.valueOf())\n          .map((value) => {\n            const q = value.data;\n            if ( !q.match(/[\\+\\-\\*]/) ) {\n              const lines = q.trim().split('\\n');\n              const lineQueries = lines.map((line) => {\n                const words = line\n                  .trim()\n                  .replace(/[-*\\s]+/g, ' ')\n                  .split(' ');\n                line = words.map((word) => {\n                  return '+' + word + '*';\n                }).join(' ');\n                return '\\'' + property_uri + '\\'==\\'' + line + '\\'';\n              });\n              return lineQueries.join(' || ');\n            } else {\n              return '\\'' + property_uri + '\\'==\\'' + q + '\\'';\n            }\n          })\n          .join(' || ');\n        break;\n      case 'Uri':\n        oneProp = values\n          .filter((item) => !!item && !!item.valueOf())\n          .map((value) => {\n            if (property_uri === 'rdf:type') {\n              return '\\'' + property_uri + '\\'==\\'' + value.data + '\\'';\n            } else {\n              return '\\'' + property_uri + '\\'==\\'' + value.data + '\\'';\n            }\n          })\n          .join(' || ');\n        break;\n      }\n      return oneProp ? '( ' + oneProp + ' )' : undefined;\n    })\n    .filter((item) => typeof item !== 'undefined')\n    .join(' && ');\n  const query = allProps ? '( ' + allProps + ' )' : undefined;\n  return query;\n};\n\n/**\n * Flatten individual\n * @param {Object} object\n * @param {string} prefix\n * @param {Object} union\n * @param {Array} visited\n * @return {Object} union\n */\nfunction flattenIndividual (object, prefix, union, visited) {\n  const uri = object['@'];\n  union = typeof union !== 'undefined' ? union : {};\n  prefix = typeof prefix !== 'undefined' ? prefix : '';\n  visited = typeof visited !== 'undefined' ? visited : [];\n  if (visited.indexOf(uri) > -1) {\n    return;\n  } else {\n    visited.push(uri);\n  }\n  for (const property_uri in object) {\n    if (property_uri === '@') {\n      continue;\n    }\n    const values = object[property_uri];\n    const prefixed = prefix ? prefix + '.' + property_uri : property_uri;\n    for (let i = 0; i < values.length; i++) {\n      const value = values[i];\n      if (value.type === 'Uri') {\n        const individ = new IndividualModel(value.data);\n        if ( individ.isNew() ) {\n          flattenIndividual(individ.properties, prefixed, union, visited);\n        } else {\n          union[prefixed] = union[prefixed] ? union[prefixed] : [];\n          union[prefixed].push( value );\n        }\n      } else {\n        union[prefixed] = union[prefixed] ? union[prefixed] : [];\n        union[prefixed].push( value );\n      }\n    }\n  }\n  return union;\n}\n\n/**\n *    \n *\n * @param individual \n * @returns {Array}\n */\n\nUtil.complexLabel = function (individual) {\n  individual = individual.properties || individual;\n  const cache = {};\n  cache[individual['@']] = individual;\n  const re_date = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.*Z$/i;\n  const get_cached = function (uri) {\n    return cache[uri] ? cache[uri] : cache[uri] = get_individual(veda.ticket, uri);\n  };\n  const get_localized_chain = function (language, uri, ...properties) {\n    const startPoint = get_cached(uri);\n    if (!startPoint) {\n      return '';\n    }\n    let intermediates = [startPoint];\n    for (let i = 0, property; (property = properties[i]); i++) {\n      const length = properties.length;\n      if (i === length - 1) {\n        const parts = [];\n        intermediates.forEach((item) => {\n          if (item[property]) {\n            const part = item[property].reduce((acc, value) => {\n              if ( !value.lang || value.lang === 'NONE' || value.lang.toLowerCase() === language.toLowerCase() ) {\n                let data = value.data;\n                if ( data instanceof Date || re_date.test(data) ) {\n                  data = new Date(data);\n                  data = new Date(data.getTime() - (data.getTimezoneOffset() * 60000)).toISOString().substr(0, 10);\n                }\n                return acc += data;\n              } else {\n                return acc;\n              }\n            }, '');\n            parts.push(part);\n          }\n        });\n        return parts.join(', ');\n      }\n      const temp = [];\n      intermediates.forEach((item) => {\n        if (Util.hasValue(item, property)) {\n          item[property].forEach((propertyItem) => {\n            temp.push(get_cached(propertyItem.data));\n          });\n        }\n      });\n      if (temp.length) {\n        intermediates = temp;\n      } else {\n        return '';\n      }\n    }\n    return '';\n  };\n\n  try {\n    const availableLanguages = get_cached('v-ui:AvailableLanguage');\n    const languages = availableLanguages['rdf:value'].map((languageValue) => {\n      const languageUri = languageValue.data;\n      const language = get_cached(languageUri);\n      return language['rdf:value'][0].data;\n    });\n    return individual['rdf:type'].reduce((acc, typeValue) => {\n      const typeUri = typeValue.data;\n      const type = get_cached(typeUri);\n      if ( !type || !Util.hasValue(type, 'v-s:labelPattern') ) {\n        return acc;\n      }\n      const pattern = type['v-s:labelPattern'][0].data;\n      languages.forEach((language) => {\n        const replaced = pattern.replace(/{(\\s*([^{}]+)\\s*)}/g, function (match, group) {\n          let indexes = null;\n          if (group.indexOf(' ') != -1) {\n            const temp = group.split(' ');\n            group = temp[0];\n            indexes = temp[1].substring(1, temp[1].length-1).split(',');\n          }\n          const chain = group.split('.');\n          if (chain[0] === '@') {\n            chain[0] = individual['@'];\n          }\n          const localedChain = get_localized_chain.apply({}, [language].concat(chain));\n          return indexes == null? localedChain : localedChain.substring(+indexes[0], +indexes[1]);\n        });\n        const result = {\n          data: replaced,\n          lang: language,\n          type: 'String',\n        };\n        acc.push(result);\n      });\n      return acc;\n    }, []);\n  } catch (err) {\n    console.log('Complex label error', err, err.stack);\n    return [];\n  }\n};\n\nUtil.areEqual = function (x, y) {\n  if ( x === y ) return true;\n  if ( ! ( x instanceof Object ) || ! ( y instanceof Object ) ) return false;\n  if ( x.constructor !== y.constructor ) return false;\n  for ( const p in x ) {\n    if ( ! x.hasOwnProperty( p ) ) continue;\n    if ( ! y.hasOwnProperty( p ) ) return false;\n    if ( x[p] === y[p] ) continue;\n    if ( typeof( x[p] ) !== 'object' ) return false;\n    if ( ! Util.areEqual( x[p], y[p] ) ) return false;\n  }\n  for ( const p in y ) {\n    if ( y.hasOwnProperty( p ) && ! x.hasOwnProperty( p ) ) return false;\n  }\n  return true;\n};\n"],"file":"util.js"}