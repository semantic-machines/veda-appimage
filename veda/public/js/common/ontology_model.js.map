{"version":3,"sources":["../../../source-web/js/common/ontology_model.js"],"names":["OntologyModel","prototype","_singletonInstance","ontology","ontologies","datatypes","classes","properties","specifications","models","classTree","templates","init","veda","IndividualModel","Backend","Util","proto","window","query","ticket","then","queryResult","ontology_uris","result","get_individuals","console","log","length","processOntology","loadFile","ontologyJSON","JSON","parse","error","stack","getClassProperties","_class_uri","getProps","props","_class","concat","apply","superClasses","map","unique","getClassSpecifications","getSpecs","specs","superSpecsArray","superSpecs","property_uri","getClassTemplate","classTemplates","ontologyIndividuals","json","stringify","forEach","individual","type","data","uri","id","hasOwnProperty","defineProperty","forClass","push","Object","keys","hasValue","superClass","property","spec","prop","sort","cur","prev","templateSpec","initPromises","Promise","resolve","all"],"mappings":"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","sourcesContent":["// Ontology Model\n\nimport veda from '../common/veda.js';\n\nimport IndividualModel from '../common/individual_model.js';\n\nimport Backend from '../common/backend.js';\n\nimport Util from '../common/util.js';\n\nexport default veda.OntologyModel = OntologyModel;\n\n/**\n * Ontology\n * @return {OntologyModel}\n */\nfunction OntologyModel () {\n  // Singleton pattern\n  if (OntologyModel.prototype._singletonInstance) {\n    return OntologyModel.prototype._singletonInstance;\n  }\n\n  this.ontology = [];\n  this.ontologies = {};\n  this.datatypes = {};\n  this.classes = {};\n  this.properties = {};\n  this.specifications = {};\n  this.models = {};\n  this.classTree = {};\n  this.templates = {};\n\n  return OntologyModel.prototype._singletonInstance = this.init();\n};\n\nconst proto = OntologyModel.prototype;\n\nproto.init = function () {\n  if (typeof window !== 'undefined') {\n    return Backend.loadFile('/ontology.json')\n      .then((ontologyJSON) => {\n        this.ontology = JSON.parse(ontologyJSON);\n        return this.processOntology();\n      })\n      .catch((error) => {\n        console.log('Ontology load error.', error.stack);\n        throw error;\n      });\n  } else {\n    return Backend.query(veda.ticket, '\\'rdf:type\\' == \\'owl:Ontology\\' || \\'rdf:type\\' == \\'rdfs:Class\\' || \\'rdf:type\\' == \\'rdf:Property\\' || \\'rdf:type\\' == \\'rdfs:Datatype\\' || \\'rdf:type\\' == \\'v-ui:PropertySpecification\\' || \\'rdf:type\\' == \\'v-ui:ClassModel\\'')\n      .then((queryResult) => {\n        const ontology_uris = queryResult.result;\n        return Backend.get_individuals(veda.ticket, ontology_uris);\n      })\n      .then((ontology) => {\n        this.ontology = ontology;\n        console.log('Ontology length:', ontology.length);\n        return this.processOntology();\n      });\n  }\n};\n\nproto.getClassProperties = function (_class_uri) {\n  const classTree = this.classTree;\n  const getProps = (_class_uri) => {\n    const _class = classTree[_class_uri];\n    let props;\n    if (_class) {\n      props = _class.properties;\n      return [].concat.apply( props, _class.superClasses.map( getProps ) );\n    } else {\n      return getProps('rdfs:Resource');\n    }\n  };\n  return Util.unique( getProps(_class_uri) );\n};\n\nproto.getClassSpecifications = function (_class_uri) {\n  const classTree = this.classTree;\n  const getSpecs = (_class_uri) => {\n    const _class = classTree[_class_uri];\n    let specs;\n    if (_class) {\n      specs = _class.specifications;\n      const superSpecsArray = _class.superClasses.map( getSpecs );\n      superSpecsArray.map((superSpecs) => {\n        for (const property_uri in superSpecs) {\n          if ( !specs[property_uri] ) {\n            specs[property_uri] = superSpecs[property_uri];\n          }\n        }\n      });\n    } else {\n      specs = getSpecs( 'rdfs:Resource' );\n    }\n    return specs;\n  };\n  return getSpecs(_class_uri);\n};\n\nproto.getClassTemplate = function (_class_uri) {\n  const classTemplates = this.templates[_class_uri];\n  if (!classTemplates) return null;\n  return classTemplates[0];\n};\n\nproto.processOntology = function () {\n  const ontology = this.ontology;\n  const ontologies = this.ontologies;\n  const datatypes = this.datatypes;\n  const classes = this.classes;\n  const properties = this.properties;\n  const specifications = this.specifications;\n  const classTree = this.classTree;\n  const models = this.models;\n  const templates = this.templates;\n\n  // Allocate ontology objects\n  const ontologyIndividuals = ontology.map((json) => {\n    if (JSON.stringify(json) === '{\"@\":\"\"}') {\n      return;\n    }\n    return new IndividualModel(json, 1, false);\n  });\n\n  ontologyIndividuals.forEach((individual) => {\n    try {\n      if ( !individual ) {\n        return;\n      }\n      const type = individual.properties['rdf:type'][0].data;\n      const uri = individual.id;\n\n      switch ( type ) {\n      case 'rdfs:Class':\n      case 'owl:Class':\n        classes[uri] = individual;\n        break;\n      case 'rdf:Property':\n      case 'owl:DatatypeProperty':\n      case 'owl:ObjectProperty':\n      case 'owl:OntologyProperty':\n      case 'owl:AnnotationProperty':\n        properties[uri] = individual;\n        // Initialize individual properties in IndividualModel.prototype\n        if ( !IndividualModel.prototype.hasOwnProperty(uri) ) {\n          IndividualModel.defineProperty(uri);\n        }\n        break;\n      case 'v-ui:PropertySpecification':\n      case 'v-ui:DatatypePropertySpecification':\n      case 'v-ui:ObjectPropertySpecification':\n        specifications[uri] = individual;\n        break;\n      case 'owl:Ontology':\n        ontologies[uri] = individual;\n        break;\n      case 'rdfs:Datatype':\n        datatypes[uri] = individual;\n        break;\n      case 'v-ui:ClassModel':\n        models[uri] = individual;\n        break;\n      case 'v-ui:TemplateSpecification':\n        const forClass = individual.properties['v-ui:forClass'][0].data;\n        if (templates[forClass]) {\n          templates[forClass].push(individual);\n        } else {\n          templates[forClass] = [individual];\n        }\n        break;\n      }\n    } catch (error) {\n      console.log('Ontology init error, uri =', individual.id, error.stack);\n    }\n  });\n\n  // Process classes\n  Object.keys(classes).forEach((uri) => {\n    try {\n      const _class = classes[uri];\n      // populate classTree\n      if ( !classTree[_class.id] ) {\n        classTree[_class.id] = {\n          superClasses: [],\n          properties: [],\n          specifications: {},\n        };\n      }\n      // rdfs:Resource is a top level class\n      if ( _class.id === 'rdfs:Resource' ) {\n        return;\n      }\n      // If class is not a subclass of another then make it a subclass of rdfs:Resource\n      if ( !_class.hasValue('rdfs:subClassOf') ) {\n        _class['rdfs:subClassOf'] = [classes['rdfs:Resource']];\n      }\n      _class['rdfs:subClassOf'].map((superClass) => {\n        classTree[_class.id].superClasses.push( superClass.id );\n      });\n    } catch (error) {\n      console.log('Ontology init error, uri =', uri, error.stack);\n    }\n  });\n\n  // Process properties\n  Object.keys(properties).forEach((uri) => {\n    try {\n      const property = properties[uri];\n      if (!property['rdfs:domain']) {\n        return;\n      }\n      property['rdfs:domain'].map(( _class ) => {\n        classTree[_class.id].properties.push(property.id);\n      });\n    } catch (error) {\n      console.log('Ontology init error, uri =', uri, error.stack);\n    }\n  });\n\n  // Process specifications\n  Object.keys(specifications).forEach((uri) => {\n    try {\n      const spec = specifications[uri];\n      if (!spec['v-ui:forClass']) {\n        return;\n      }\n      spec['v-ui:forClass'].map((_class) => {\n        spec['v-ui:forProperty'].map((prop) => {\n          classTree[_class.id].specifications[prop.id] = spec.id;\n        });\n      });\n    } catch (error) {\n      console.log('Ontology init error, uri =', uri, error.stack);\n    }\n  });\n\n  // Process template specifications\n  Object.keys(templates).forEach((uri) => {\n    try {\n      templates[uri] = templates[uri].sort((cur, prev) => {\n        if (cur.properties['v-s:loadPriority']) {\n          if (prev.properties['v-s:loadPriority']) {\n            return cur.properties['v-s:loadPriority'][0].data - prev.properties['v-s:loadPriority'][0].data;\n          } else {\n            return -1;\n          }\n        } else {\n          return 1;\n        }\n      }).map((templateSpec) => templateSpec.properties['v-ui:defaultTemplate'][0].data);\n    } catch (error) {\n      console.log('Ontology init error, uri =', uri, error.stack);\n    }\n  });\n\n  // Init ontology individuals\n  const initPromises = ontologyIndividuals.map((individual, i) => {\n    return individual.init()\n      .catch((error) => console.log('Ontology individual init error, uri =', individual.id, error.stack));\n  });\n\n  if (typeof window !== 'undefined') {\n    return Promise.all(initPromises).then(() => this);\n  } else {\n    return Promise.resolve(this);\n  }\n};\n\n"],"file":"ontology_model.js"}