{"version":3,"sources":["../../../source-web/js/browser/veda_controls.js"],"names":["veda_literal_input","options","propertyModifiedHandler","input","isSingle","field","value","veda","Util","formatValue","individual","get","property_uri","start_shift","selectionStart","length","end_shift","selectionEnd","ex","console","log","keyupHandler","e","$","target","which","val","data","change","focus","timeout","opts","extend","defaults","template","spec","placeholder","attr","hasValue","map","join","pop","id","toLowerCase","replace","on","parser","set","concat","keyup","clearTimeout","setTimeout","one","off","stopPropagation","tooltip","title","placement","container","trigger","animation","veda_multilingual","handler","each","i","el","self","lang","forEach","language","document","activeElement","tabindex","removeAttr","find","Object","keys","user","preferences","language_name","localedInput","text","formControl","values","append","toString","loadImage","imageFile","Promise","resolve","reject","reader","FileReader","onload","image","Image","onerror","Error","src","result","readAsDataURL","resizeImage","maxWidth","width","System","then","module","Cropper","styleSheet","adoptedStyleSheets","cropper","autoCrop","ready","ratio","height","resized","getCroppedCanvas","maxHeight","Math","floor","toDataURL","destroy","cropImage","imageForCrop","modal","html","style","cssText","temp","aspectRatio","movable","rotable","scalable","click","img","remove","ftQuery","prefix","sort","withDeleted","incrementalSearch","cursor","limit","results","Backend","query","ticket","queryString","getLanguage","from","top","queryResult","estimated","trim","lines","split","filter","Boolean","lineQueries","line","special","indexOf","words","word","unique","getList","uri","cached","cache","load","get_individuals","uris","individuals","j","IndividualModel","init","all","fulfilled","renderValue","interpolate","promises","re_interpolate","re_evaluate","match","group","rendered","eval","push","properties","shift","getChainValue","autosize","fn","veda_generic","control","call","Date","parse","test","isNaN","parseFloat","individ","isSync","isNew","veda_string","veda_uri","veda_text","update","veda_integer","type","int","parseInt","veda_worktime","mainInput","hide","pseudoInputs","summaryText","fillMainInput","count","fillPseudoInput","summaryTime","days","hours","minutes","veda_decimal","float","moment","veda_dateTime","format","singleValueHandler","datetimepicker","locale","allowInputToggle","sideBySide","useCurrent","widgetPositioning","horizontal","vertical","timestamp","toDate","veda_date","symbolicDate","d","getDate","m","getMonth","y","getFullYear","setUTCFullYear","setUTCHours","veda_time","setFullYear","setMonth","setDate","absolutDate","getUTCHours","getUTCMinutes","getUTCSeconds","setSeconds","veda_multilingualString","empty","veda_multilingualText","ta","veda_boolean","prop","closest","parents","veda_actor","performSearch","chosenActorType","fullName","fullNameProps","fullNameInput","fullNameQuery","token","ftQueryPromise","queryPrefix","onlyDeleted","renderResults","error","selected","rel_uri","renderedPromises","cont","addClass","tmpl","present","a","b","reduce","acc","curr","suggestions","clickOutsideMenuHandler","arrowHandler","fulltextMenu","show","clickHandler","preventDefault","currentTarget","suggestion_uri","suggestion","toggleClass","siblings","removeClass","setValue","dblTimeout","fulltext","dblclickHandler","hasClass","is","active","next","children","first","prev","last","complex","clearValue","persons","positions","departments","newValueStr","oldValueStr","specQueryPrefix","actorType","parent","ftValue","label","treeTmpl","$modal","cntr","target_rel_uri","rows","header","actions","delegateTarget","inputHandler","nav_keys","originalEvent","veda_select","params","populate","renderOptions","source","first_opt","appendTo","optionsPromises","index","opt","clone","rangeRestriction","range","item","placeholderLoaded","addValue","dataDeleted","veda_checkbox","hld","lbl","chk","removeValue","mode","veda_radio","rad","veda_booleanRadio","option","valueOf","trueOption","loaded","falseOption","veda_source","editorEl","sourceMode","debounce","f","ms","skip","ace","editor","edit","readOnly","selectionStyle","fontSize","setReadOnly","debouncedEditorHandler","editorHandler","session","getValue","debouncedIndividualHandler","individualHandler","veda_file","fileInput","indicatorPercentage","indicatorSpinner","accept","targetRatio","progress","progressEvent","lengthComputable","percentComplete","round","total","err","createFileIndividual","file","name","fileName","guid","path","toISOString","substring","fileIndividual","size","curRatio","thumbnail","thumbnailIndividual","uploadFile","save","fileIndividualPromise","fileIndividualPromises","files","fileIndividuals","veda_link","select","Array","filtered","createValue","newVal","create","inModal","rel_range","rights","escHandler","ok","close","keyCode","validation","state","tree","extra","renderedList","dropdown","downHandler"],"mappings":"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","sourcesContent":["// Veda controls implemented as JQuery plugins\n\n'use strict';\n\nimport veda from '../common/veda.js';\n\nimport $ from 'jquery';\n\nimport autosize from 'autosize';\n\nimport Util from '../common/util.js';\n\n// INPUT CONTROLS\n\n// Generic literal input behaviour\n\n/**\n * Basic literal input.\n * @param {Object} options\n * @this jQuery\n * @return {jQuery}\n */\nfunction veda_literal_input (options) {\n  const opts = $.extend( {}, veda_literal_input.defaults, options );\n  const input = $(opts.template);\n  const spec = opts.spec;\n  const placeholder = this.attr('placeholder') || (spec && spec.hasValue('v-ui:placeholder') ? spec['v-ui:placeholder'].map(Util.formatValue).join(' ') : '');\n  const property_uri = opts.property_uri;\n  const individual = opts.individual;\n  let timeout;\n\n  input.isSingle = typeof opts.isSingle !== 'undefined' ? opts.isSingle : (spec && spec.hasValue('v-ui:maxCardinality') ? spec['v-ui:maxCardinality'][0] === 1 : true);\n\n  input\n    .attr({\n      'placeholder': placeholder,\n      'name': (individual.hasValue('rdf:type') ? individual['rdf:type'].pop().id + '_' + property_uri : property_uri).toLowerCase().replace(/[-:]/g, '_'),\n    })\n    .on('change focusout', changeHandler)\n    .keyup( function (e) {\n      if (!input.isSingle) {\n        return;\n      }\n      if (e.which === 13) {\n        input.change();\n      }\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n      timeout = setTimeout(keyupHandler, 50, e);\n    });\n\n  individual.on(property_uri, propertyModifiedHandler);\n  input.one('remove', function () {\n    individual.off(property_uri, propertyModifiedHandler);\n  });\n  propertyModifiedHandler();\n\n  /**\n   * Individual property handler.\n   * @return {void}\n   */\n  function propertyModifiedHandler () {\n    if (input.isSingle) {\n      const field = input[0];\n      let value = veda.Util.formatValue( individual.get(property_uri)[0] );\n      value = typeof value !== 'undefined' ? value : '';\n      if (field.value != value) {\n        try {\n          const start_shift = field.selectionStart - field.value.length;\n          const end_shift = field.selectionEnd - field.value.length;\n          field.value = value;\n          field.selectionStart = value.length + start_shift;\n          field.selectionEnd = value.length + end_shift;\n        } catch (ex) {\n          field.value = value;\n          console.log('selectionStart/End error:', property_uri, value, typeof value);\n        }\n      }\n    }\n  }\n\n  /**\n   * Input change handler\n   * @param {Event} e\n   * @this jQuery\n   * @return {void}\n   */\n  function changeHandler (e) {\n    const value = opts.parser(this.value);\n    if (input.isSingle) {\n      individual.set(property_uri, [value]);\n    } else {\n      individual.set(property_uri, individual.get(property_uri).concat(value));\n      this.value = '';\n    }\n  }\n\n  /**\n   * Input keyup handler\n   * @param {Event} e\n   * @this jQuery\n   * @return {void}\n   */\n  function keyupHandler (e) {\n    const input = $(e.target);\n    if (\n      e.which !== 188 &&\n      e.which !== 190 &&\n      e.which !== 110 &&\n      input.val() !== input.data('prev')\n    ) {\n      input.data('prev', input.val());\n      input.change();\n    }\n    if (e.which !== 9) {\n      input.focus();\n    }\n  }\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n  });\n  this.val = function (value) {\n    if (!value) return input.val();\n    return input.val( veda.Util.formatValue(value) );\n  };\n  if (spec && spec.hasValue('v-ui:tooltip')) {\n    input.tooltip({\n      title: spec['v-ui:tooltip'].join(', '),\n      placement: 'bottom',\n      container: 'body',\n      trigger: 'manual',\n      animation: false,\n    }).one('remove', function () {\n      input.tooltip('destroy');\n    }).on('focusin', function () {\n      input.tooltip('show');\n    }).on('focusout change', function () {\n      input.tooltip('hide');\n    });\n  }\n  return input;\n};\nveda_literal_input.defaults = {\n  template: $('#string-control-template').html(),\n  parser: function (input) {\n    return (input || null);\n  },\n};\n\n// Generic input\n$.fn.veda_generic = function( options ) {\n  const opts = $.extend( {}, $.fn.veda_generic.defaults, options );\n  const control = veda_literal_input.call(this, opts);\n\n  const tabindex = this.attr('tabindex');\n  if (tabindex) {\n    this.removeAttr('tabindex');\n    control.attr('tabindex', tabindex);\n  }\n\n  this.append(control);\n  return this;\n};\n$.fn.veda_generic.defaults = {\n  template: $('#string-control-template').html(),\n  parser: function (input) {\n    if (!input || !input.trim()) {\n      return null;\n    } else if ( Date.parse(input) && (/^\\d{4}-\\d{2}-\\d{2}.*$/).test(input) ) {\n      return new Date(input);\n    } else if ( !isNaN( input.split(' ').join('').split(',').join('.') ) ) {\n      return parseFloat( input.split(' ').join('').split(',').join('.') );\n    } else if ( input === 'true' ) {\n      return true;\n    } else if ( input === 'false' ) {\n      return false;\n    } else {\n      const individ = new veda.IndividualModel(input);\n      if ( individ.isSync() && !individ.isNew() ) {\n        return individ;\n      }\n    }\n    return input;\n  },\n};\n\n// String input\n$.fn.veda_string = function( options ) {\n  const opts = $.extend( {}, $.fn.veda_string.defaults, options );\n  const control = veda_literal_input.call(this, opts);\n\n  const tabindex = this.attr('tabindex');\n  if (tabindex) {\n    this.removeAttr('tabindex');\n    control.attr('tabindex', tabindex);\n  }\n\n  this.append(control);\n  return this;\n};\n$.fn.veda_string.defaults = {\n  template: $('#string-control-template').html(),\n  parser: function (input) {\n    return (input ? String(input) : null);\n  },\n  isSingle: true,\n};\n\n// Uri input\n$.fn.veda_uri = function( options ) {\n  const opts = $.extend( {}, $.fn.veda_uri.defaults, options );\n  const control = $( opts.template );\n  const individual = opts.individual;\n\n  const tabindex = this.attr('tabindex');\n  if (tabindex) {\n    this.removeAttr('tabindex');\n    control.attr('tabindex', tabindex);\n  };\n\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n  });\n\n  control.attr({\n    'placeholder': individual.id,\n  }).on('change focusout', changeHandler);\n\n  /**\n   * Input change handler\n   * @return {void}\n   */\n  function changeHandler() {\n    if (control.val()) {\n      individual.id = control.val();\n    };\n  }\n\n  individual.on('idChanged', function() {\n    control.attr('placeholder', individual.id);\n  });\n\n  this.append(control);\n  return this;\n};\n$.fn.veda_uri.defaults = {\n  template: $('#string-control-template').html(),\n};\n\n// Text input\n$.fn.veda_text = function( options ) {\n  const opts = $.extend( {}, $.fn.veda_text.defaults, options );\n  const control = veda_literal_input.call(this, opts);\n\n  const tabindex = this.attr('tabindex');\n  if (tabindex) {\n    this.removeAttr('tabindex');\n    control.attr('tabindex', tabindex);\n  }\n\n  control.attr('rows', this.attr('rows'));\n  autosize(control);\n  this.on('edit', function () {\n    autosize.update(control);\n  });\n  this.one('remove', function () {\n    autosize.destroy(control);\n  });\n  this.append(control);\n  return this;\n};\n$.fn.veda_text.defaults = {\n  template: $('#text-control-template').html(),\n  parser: function (input) {\n    return (input ? String(input) : null);\n  },\n  isSingle: true,\n};\n\n// Integer control\n$.fn.veda_integer = function( options ) {\n  const opts = $.extend( {}, $.fn.veda_integer.defaults, options );\n  const control = veda_literal_input.call(this, opts);\n\n  const tabindex = this.attr('tabindex');\n  if (tabindex) {\n    this.removeAttr('tabindex');\n    control.attr('tabindex', tabindex);\n  }\n\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n    if (e.type === 'search') {\n      control.isSingle = false;\n    }\n  });\n  this.append(control);\n  return this;\n};\n$.fn.veda_integer.defaults = {\n  template: $('#integer-control-template').html(),\n  parser: function (input) {\n    const int = parseInt( input.split(' ').join('').split(',').join('.'), 10 );\n    return !isNaN(int) ? int : null;\n  },\n};\n\n// WorkTime control\n$.fn.veda_worktime = function( options ) {\n  const opts = $.extend( {}, $.fn.veda_worktime.defaults, options );\n  const mainInput = veda_literal_input.call(this, opts);\n\n  this.append( mainInput.hide() );\n  this.append( $('#worktime-control-template').html() );\n\n  const pseudoInputs = $('div.input-group>input', this);\n  const summaryText = $('#worktime-summary-text', this);\n  const fillMainInput = function () {\n    const count = pseudoInputs[0].value*480 + pseudoInputs[1].value*60 + pseudoInputs[2].value*1;\n    mainInput.val(count);\n    summaryText.text(veda.Util.formatValue(count));\n    mainInput.change();\n  };\n  const fillPseudoInput = function (summaryTime) {\n    if (summaryTime) {\n      summaryText.text(summaryTime);\n      summaryTime = parseInt( summaryTime.split(' ').join('').split(',').join('.'), 10 );\n      let days = 0; let hours = 0; let minutes = 0;\n      if (summaryTime != 0) {\n        days = Math.floor(summaryTime/480);\n        summaryTime = summaryTime-days*480;\n        if (summaryTime != 0) {\n          hours = Math.floor(summaryTime/60);\n          summaryTime = summaryTime-hours*60;\n          if (summaryTime != 0) {\n            minutes = summaryTime;\n          }\n        }\n      }\n      pseudoInputs[0].value = days;\n      pseudoInputs[1].value = hours;\n      pseudoInputs[2].value = minutes;\n    }\n  };\n  fillPseudoInput(mainInput.val());\n  pseudoInputs.change(fillMainInput);\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n  });\n  return this;\n};\n$.fn.veda_worktime.defaults = {\n  parser: function (input) {\n    const int = parseInt( input.split(' ').join('').split(',').join('.'), 10 );\n    return !isNaN(int) ? int : null;\n  },\n};\n\n// Decimal control\n$.fn.veda_decimal = function( options ) {\n  const opts = $.extend( {}, $.fn.veda_decimal.defaults, options );\n  const control = veda_literal_input.call(this, opts);\n\n  const tabindex = this.attr('tabindex');\n  if (tabindex) {\n    this.removeAttr('tabindex');\n    control.attr('tabindex', tabindex);\n  }\n\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n    if (e.type === 'search') {\n      control.isSingle = false;\n    }\n  });\n  this.append(control);\n  return this;\n};\n$.fn.veda_decimal.defaults = {\n  template: $('#decimal-control-template').html(),\n  parser: function (input) {\n    const float = parseFloat( input.split(' ').join('').split(',').join('.') );\n    return !isNaN(float) ? float : null;\n  },\n};\n\nSystem.import('moment').then(function (module) {\n  const moment = module.default;\n  System.import('datetimepicker/js/bootstrap-datetimepicker.min.js').then(function () {\n    System.import('datetimepicker/css/bootstrap-datetimepicker.min.css').then(function (module) {\n      const styleSheet = module.default;\n      document.adoptedStyleSheets = [...document.adoptedStyleSheets, styleSheet];\n    });\n\n    /**\n     * Common dateTime behaviour\n     * @param {Object} options\n     * @return {jQuery}\n     * @this jQuery\n     */\n    function veda_dateTime(options) {\n      const opts = $.extend( {}, veda_dateTime.defaults, options );\n      const control = $(opts.template);\n      const format = opts.format;\n      const spec = opts.spec;\n      const placeholder = this.attr('placeholder') || (spec && spec.hasValue('v-ui:placeholder') ? spec['v-ui:placeholder'].map(Util.formatValue).join(' ') : '');\n      const property_uri = opts.property_uri;\n      const individual = opts.individual;\n      const isSingle = spec && spec.hasValue('v-ui:maxCardinality') ? spec['v-ui:maxCardinality'][0] === 1 : true;\n      const input = $('input', control);\n      let change;\n\n      input.attr({\n        'placeholder': placeholder,\n        'name': (individual.hasValue('rdf:type') ? individual['rdf:type'].pop().id + '_' + property_uri : property_uri).toLowerCase().replace(/[-:]/g, '_'),\n      });\n\n      const singleValueHandler = function (values) {\n        if (values.length) {\n          input.val( moment(values[0]).format(format) );\n        } else {\n          input.val('');\n        }\n      };\n\n      if (isSingle) {\n        change = function (value) {\n          individual.set(property_uri, [value]);\n        };\n        if (individual.hasValue(property_uri)) {\n          input.val( moment(individual.get(property_uri)[0]).format(format) );\n        }\n        individual.on(property_uri, singleValueHandler);\n        control.one('remove', function () {\n          individual.off(property_uri, singleValueHandler);\n        });\n      } else {\n        change = function (value) {\n          individual.set(property_uri, individual.get(property_uri).concat(value));\n          input.val('');\n        };\n      }\n\n      if (spec && spec.hasValue('v-ui:tooltip')) {\n        control.tooltip({\n          title: spec['v-ui:tooltip'].join(', '),\n          placement: 'auto left',\n          container: 'body',\n          trigger: 'manual',\n          animation: false,\n        });\n        control.one('remove', function () {\n          control.tooltip('destroy');\n        });\n        input.on('focusin', function () {\n          control.tooltip('show');\n        }).on('focusout change', function () {\n          control.tooltip('hide');\n        });\n      }\n\n      control.datetimepicker({\n        locale: Object.keys(veda.user.preferences.language).length === 1 ? Object.keys(veda.user.preferences.language)[0] : 'EN',\n        allowInputToggle: true,\n        format: format,\n        sideBySide: true,\n        useCurrent: true,\n        widgetPositioning: {\n          horizontal: 'auto',\n          vertical: 'bottom',\n        },\n      });\n\n      input.on('change focusout', function (e) {\n        const value = opts.parser( e.target.value );\n        change(value);\n      });\n\n      this.on('view edit search', function (e) {\n        e.stopPropagation();\n        if (e.type === 'search') {\n          change = function (value) {\n            individual.set(property_uri, individual.get(property_uri).concat(value));\n            input.val('');\n          };\n        }\n      });\n\n      this.val = function (value) {\n        if (!value) return input.val();\n        return input.val(value);\n      };\n\n      this.one('remove', function () {\n        control.data('DateTimePicker').destroy();\n      });\n\n      return control;\n    };\n    veda_dateTime.defaults = {\n      template: $('#datetime-control-template').html(),\n      parser: function (input) {\n        if (input) {\n          const timestamp = moment(input, 'DD.MM.YYYY HH:mm').toDate();\n          return new Date(timestamp);\n        }\n        return null;\n      },\n      format: 'DD.MM.YYYY HH:mm',\n    };\n\n    // Date control\n    $.fn.veda_date = function( options ) {\n      const opts = $.extend( {}, $.fn.veda_date.defaults, options );\n      const control = veda_dateTime.call(this, opts);\n\n      const tabindex = this.attr('tabindex');\n      if (tabindex) {\n        this.removeAttr('tabindex');\n        control.find('input').attr('tabindex', tabindex);\n      }\n\n      this.append(control);\n      return this;\n    };\n    $.fn.veda_date.defaults = {\n      template: $('#datetime-control-template').html(),\n      parser: function (input) {\n        if (input) {\n          const timestamp = moment(input, 'DD.MM.YYYY').toDate();\n          const symbolicDate = new Date(timestamp);\n          const d = symbolicDate.getDate();\n          const m = symbolicDate.getMonth();\n          const y = symbolicDate.getFullYear();\n          symbolicDate.setUTCFullYear(y, m, d);\n          symbolicDate.setUTCHours(0, 0, 0, 0);\n          return symbolicDate;\n        }\n        return null;\n      },\n      format: 'DD.MM.YYYY',\n    };\n\n    // Time control\n    $.fn.veda_time = function( options ) {\n      const opts = $.extend( {}, $.fn.veda_time.defaults, options );\n      const control = veda_dateTime.call(this, opts);\n\n      const tabindex = this.attr('tabindex');\n      if (tabindex) {\n        this.removeAttr('tabindex');\n        control.find('input').attr('tabindex', tabindex);\n      }\n\n      this.append(control);\n      return this;\n    };\n    $.fn.veda_time.defaults = {\n      template: $('#datetime-control-template').html(),\n      parser: function (input) {\n        if (input) {\n          const timestamp = moment(input, 'HH:mm').toDate();\n          const result = new Date(timestamp);\n          result.setFullYear(1970);\n          result.setMonth(0);\n          result.setDate(1);\n          return result;\n        }\n        return null;\n      },\n      format: 'HH:mm',\n    };\n\n    // Date-Time control\n    $.fn.veda_dateTime = function( options ) {\n      const opts = $.extend( {}, $.fn.veda_dateTime.defaults, options );\n      const control = veda_dateTime.call(this, opts);\n\n      const tabindex = this.attr('tabindex');\n      if (tabindex) {\n        this.removeAttr('tabindex');\n        control.find('input').attr('tabindex', tabindex);\n      }\n\n      this.append(control);\n      return this;\n    };\n    $.fn.veda_dateTime.defaults = {\n      template: $('#datetime-control-template').html(),\n      parser: function (input) {\n        if (input) {\n          const timestamp = moment(input, 'DD.MM.YYYY HH:mm').toDate();\n          const absolutDate = new Date(timestamp);\n          if ((absolutDate.getUTCHours() + absolutDate.getUTCMinutes() + absolutDate.getUTCSeconds()) === 0) {\n            absolutDate.setSeconds(1);\n          }\n          return absolutDate;\n        }\n        return null;\n      },\n      format: 'DD.MM.YYYY HH:mm',\n    };\n  });\n});\n\n// MULTILINGUAL INPUT CONTROLS\n\n/**\n * Generic multilingual input behaviour\n * @param {Object} options\n * @return {jQuery}\n * @this jQuery\n */\nfunction veda_multilingual (options) {\n  const opts = $.extend( {}, veda_multilingual.defaults, options );\n  const self = this;\n  const individual = opts.individual;\n  const property_uri = opts.property_uri;\n  const spec = opts.spec;\n  const placeholder = this.attr('placeholder') || (spec && spec.hasValue('v-ui:placeholder') ? spec['v-ui:placeholder'].map(Util.formatValue).join(' ') : '');\n  let timeout;\n\n  const tabindex = this.attr('tabindex');\n  if (tabindex) {\n    this.removeAttr('tabindex');\n    this.find('input').attr('tabindex', tabindex);\n  }\n\n  Object.keys(veda.user.preferences.language).map(function (language_name) {\n    const localedInput = $(opts.template);\n\n    localedInput.find('.language-tag').text(language_name);\n\n    const formControl = localedInput.find('.form-control');\n    formControl\n      .attr({\n        'lang': language_name,\n        'placeholder': placeholder,\n        'name': (individual.hasValue('rdf:type') ? individual['rdf:type'].pop().id + '_' + property_uri : property_uri).toLowerCase().replace(/[-:]/g, '_'),\n      })\n      .on('change focusout', function () {\n        const values = self.find('.form-control').map(function (i, el) {\n          return opts.parser( el.value, el );\n        }).get();\n        individual.set(property_uri, values);\n      })\n      .keyup( function (e) {\n        if (e.which === 13) {\n          formControl.change();\n        }\n        if (timeout) {\n          clearTimeout(timeout);\n        }\n        timeout = setTimeout(keyupHandler, 50, e);\n      });\n\n    individual.get(property_uri).forEach(function (value) {\n      if ( value.language === language_name || !value.language ) {\n        formControl.val(value);\n      }\n    });\n\n    self.append( localedInput );\n  });\n\n  const input = self.find('.form-control');\n\n  individual.on(property_uri, handler);\n  self.one('remove', function () {\n    individual.off(property_uri, handler);\n  });\n\n  /**\n   * Input keyup handler\n   * @param {Event} e\n   * @return {void}\n   */\n  function keyupHandler (e) {\n    const input = $(e.target);\n    if (\n      e.which !== 188 &&\n      e.which !== 190 &&\n      e.which !== 110 &&\n      input.val() !== input.data('prev')\n    ) {\n      input.data('prev', input.val());\n      input.change();\n    }\n    if (e.which !== 9) {\n      input.focus();\n    }\n  }\n\n  /**\n   * Individual property change handler\n   * @param {Array} values\n   * @return {void}\n   */\n  function handler (values) {\n    input.each(function (i, el) {\n      const self = el;\n      const lang = el.lang;\n      individual.get(property_uri).forEach(function (value) {\n        if ( value.language === lang || !value.language && self.value != value) {\n          try {\n            if (self === document.activeElement) {\n              const start_shift = self.selectionStart - self.value.length;\n              const end_shift = self.selectionEnd - self.value.length;\n              self.value = value;\n              self.selectionStart = value.length + start_shift;\n              self.selectionEnd = value.length + end_shift;\n            } else {\n              self.value = value;\n            }\n          } catch (ex) {\n            self.value = value;\n            console.log('selectionStart/End error:', property_uri, value, typeof value);\n          }\n        }\n      });\n    });\n  }\n\n  self.on('view edit search', function (e) {\n    e.stopPropagation();\n  });\n\n  self.val = function (value) {\n    if (!value) {\n      return parser( input.val() );\n    }\n    input.each(function (i, el) {\n      if (value.language === el.lang || !value.language) {\n        el.value = value.toString();\n      }\n    });\n  };\n\n  if (spec && spec.hasValue('v-ui:tooltip')) {\n    self.tooltip({\n      title: spec['v-ui:tooltip'].join(', '),\n      placement: 'bottom',\n      container: 'body',\n      trigger: 'manual',\n      animation: false,\n    }).one('remove', function () {\n      self.tooltip('destroy');\n    });\n    input.on('focusin', function () {\n      self.tooltip('show');\n    }).on('focusout change', function () {\n      self.tooltip('hide');\n    });\n  }\n\n  return self;\n};\nveda_multilingual.defaults = {\n  parser: function (input, el) {\n    if (input) {\n      let value = String(input);\n      const lang = $(el).attr('lang');\n      if (lang) {\n        value = value + '@' + lang;\n      }\n      return value;\n    }\n    return null;\n  },\n};\n\n// Multilingual string control\n$.fn.veda_multilingualString = function (options) {\n  const opts = $.extend( {}, $.fn.veda_multilingualString.defaults, options );\n  const self = $(this);\n  const init = function () {\n    self.empty();\n    veda_multilingual.call(self, opts);\n  };\n  init();\n  veda.on('language:changed', init);\n  self.one('remove', function () {\n    veda.off('language:changed', init);\n  });\n  return this;\n};\n$.fn.veda_multilingualString.defaults = {\n  template: $('#multilingual-string-control-template').html(),\n};\n\n// Multilingual text control\n$.fn.veda_multilingualText = function (options) {\n  const opts = $.extend( {}, $.fn.veda_multilingualText.defaults, options );\n  const self = $(this);\n  const init = function () {\n    self.empty();\n    veda_multilingual.call(self, opts);\n    const ta = $('textarea', self);\n    ta.attr('rows', self.attr('rows'));\n    autosize(ta);\n    self.on('edit', function () {\n      autosize.update(ta);\n    });\n    self.one('remove', function () {\n      autosize.destroy(ta);\n    });\n  };\n  init();\n  veda.on('language:changed', init);\n  self.one('remove', function () {\n    veda.off('language:changed', init);\n  });\n  return this;\n};\n$.fn.veda_multilingualText.defaults = {\n  template: $('#multilingual-text-control-template').html(),\n};\n\n// BOOLEAN CONTROL\n$.fn.veda_boolean = function( options ) {\n  const opts = $.extend( {}, $.fn.veda_boolean.defaults, options );\n  const control = $( opts.template );\n  const individual = opts.individual;\n  const property_uri = opts.property_uri;\n  const spec = opts.spec;\n\n  const tabindex = this.attr('tabindex');\n  if (tabindex) {\n    this.removeAttr('tabindex');\n    control.attr('tabindex', tabindex);\n  }\n\n  const handler = function (doc_property_uri) {\n    if (individual.hasValue(property_uri)) {\n      if (individual.get(property_uri)[0] === true) {\n        control.prop('checked', true).prop('readonly', false).prop('indeterminate', false);\n      } else {\n        control.prop('checked', false).prop('readonly', false).prop('indeterminate', false);\n      }\n    } else {\n      control.prop('readonly', true).prop('indeterminate', true);\n    }\n  };\n  handler();\n\n  individual.on(property_uri, handler);\n  this.one('remove', function () {\n    individual.off(property_uri, handler);\n  });\n\n  control.click( function () {\n    if ( control.prop('readonly') ) {\n      individual.set(property_uri, [false]);\n    } else if ( !control.prop('checked') ) {\n      individual.set(property_uri, []);\n    } else {\n      individual.set(property_uri, [true]);\n    }\n  });\n\n  if ( control.closest('.checkbox.disabled').length ) {\n    control.attr('disabled', 'disabled');\n  }\n\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n    if (e.type === 'view') {\n      control.attr('disabled', 'disabled');\n    } else {\n      if ( control.closest('.checkbox.disabled').length ) {\n        control.attr('disabled', 'disabled');\n      } else {\n        control.removeAttr('disabled');\n      }\n      if (spec && spec.hasValue('v-ui:tooltip')) {\n        control.parents('label').tooltip({\n          title: spec['v-ui:tooltip'].join(', '),\n          placement: 'bottom',\n          container: control,\n          trigger: 'hover',\n          animation: false,\n        });\n      }\n    }\n  });\n  this.append(control);\n  return this;\n};\n$.fn.veda_boolean.defaults = {\n  template: $('#boolean-control-template').html(),\n};\n\n// ACTOR CONTROL\n$.fn.veda_actor = function( options ) {\n  const opts = $.extend( {}, $.fn.veda_actor.defaults, options );\n  const control = $( opts.template );\n  const individual = opts.individual;\n  const rel_uri = opts.property_uri;\n  const spec = opts.spec;\n  const placeholder = this.attr('data-placeholder') || ( spec && spec.hasValue('v-ui:placeholder') ? spec['v-ui:placeholder'].map(Util.formatValue).join(' ') : new veda.IndividualModel('v-s:StartTypingBundle') );\n  const specQueryPrefix = this.attr('data-query-prefix') || ( spec && spec.hasValue('v-ui:queryPrefix') ? spec['v-ui:queryPrefix'][0].toString() : undefined);\n  let queryPrefix;\n  const sort = this.attr('data-sort') || ( spec && spec.hasValue('v-ui:sort') && spec['v-ui:sort'][0].toString() );\n  const actorType = this.attr('data-actor-type') || 'v-s:Appointment v-s:Person v-s:Position v-s:Department';\n  const complex = this.attr('data-complex') || false;\n  const isSingle = this.attr('data-single') || ( spec && spec.hasValue('v-ui:maxCardinality') ? spec['v-ui:maxCardinality'][0] === 1 : true );\n  const withDeleted = false || this.attr('data-deleted');\n  let chosenActorType;\n  let fullName;\n  let onlyDeleted;\n\n  const tabindex = this.attr('tabindex');\n  if (tabindex) {\n    this.removeAttr('tabindex');\n    control.find('textarea').attr('tabindex', tabindex);\n  }\n\n  // Fulltext search feature\n  const fulltext = $('.fulltext', control);\n  const fulltextMenu = $('.fulltext-menu', control);\n\n  // Disable closing actor type dropdown on click\n  $('.dropdown-menu', control).click(function (e) {\n    e.stopPropagation();\n  });\n\n  // Close actor type dropdown on input click\n  fulltext.click(function () {\n    $('.dropdown-toggle', control).attr('aria-expanded', false).parent().removeClass('open');\n  });\n\n  // Filter allowed actor types, set label & handler\n  $('[name=\\'actor-type\\']', control).filter(function (i, el) {\n    if (actorType.indexOf(el.value) < 0) {\n      $(el).closest('.radio').remove();\n      return false;\n    } else {\n      $(el).parent().append( new veda.IndividualModel(el.value).toString() );\n      return true;\n    }\n  }).change(function (e) {\n    $('.tree', control).hide();\n    if ( $(e.target).is(':checked') ) {\n      chosenActorType = e.target.value;\n      if ( chosenActorType === 'v-s:Appointment' || chosenActorType === 'v-s:Person' || chosenActorType === 'v-s:Position' ) {\n        $('[name=\\'full-name\\']', control).parent().parent().show();\n        queryPrefix = '\\'rdf:type\\' === \\'v-s:Appointment\\'';\n      } else if (chosenActorType === 'v-s:Department') {\n        $('[name=\\'full-name\\']', control).parent().parent().hide();\n        queryPrefix = '\\'rdf:type\\' === \\'v-s:Appointment\\' || \\'rdf:type\\' === \\'v-s:Department\\'';\n        $('.tree', control).show();\n      }\n      queryPrefix = specQueryPrefix || queryPrefix;\n      const ftValue = $('.fulltext', control).val();\n      if (ftValue) {\n        performSearch(ftValue);\n      }\n    }\n  }).first().prop('checked', 'checked').change();\n\n  // Full name check label & handler\n  $('[name=\\'full-name\\']', control).each(function (i, el) {\n    const label = new veda.IndividualModel(el.value);\n    const self = el;\n    label.load().then(function (label) {\n      $(self).parent().append( new veda.IndividualModel(self.value).toString() );\n    });\n  }).change(function () {\n    fullName = $(el).is(':checked') ? true : false;\n    const ftValue = $('.fulltext', control).val();\n    if (ftValue) {\n      performSearch(ftValue);\n    }\n  });\n\n  $('[name=\\'only-deleted\\']', control).each(function (i, el) {\n    const label = new veda.IndividualModel(el.value);\n    const self = el;\n    label.load().then(function (label) {\n      $(self).parent().append( new veda.IndividualModel(self.value).toString() );\n    });\n  }).change(function () {\n    onlyDeleted = $(el).is(':checked') ? true : false;\n    const ftValue = $('.fulltext', control).val();\n    if (ftValue) {\n      performSearch(ftValue);\n    }\n  });\n\n  $('.clear', control).on('click keydown', function (e) {\n    if (isSingle) {\n      if (e.type !== 'click' && e.which !== 13 && e.which !== 32) {\n        return;\n      }\n      e.preventDefault();\n      e.stopPropagation();\n      individual.clearValue(rel_uri);\n      if ( complex ) {\n        individual.clearValue(rel_uri + '.v-s:employee');\n        individual.clearValue(rel_uri + '.v-s:occupation');\n      }\n    }\n    fulltextMenu.hide();\n    $(document).off('click', clickOutsideMenuHandler);\n    $(document).off('keydown', arrowHandler);\n    fulltext.val('').focus();\n  });\n\n  // Tree feature\n  $('.tree', control).on('click keydown', function (e) {\n    const treeTmpl = new veda.IndividualModel('v-ui:TreeTemplate');\n    const modal = $('#individual-modal-template').html();\n    if (e.type !== 'click' && e.which !== 13 && e.which !== 32) {\n      return;\n    }\n    e.preventDefault();\n    e.stopPropagation();\n    const $modal = $(modal);\n    const cntr = $('.modal-body', $modal);\n    $modal.on('hidden.bs.modal', function (e) {\n      $modal.remove();\n    });\n    $modal.modal();\n    $('body').append($modal);\n\n    const extra = {\n      target: individual,\n      target_rel_uri: rel_uri,\n      isSingle: isSingle,\n      withDeleted: withDeleted,\n      sort: sort,\n    };\n    spec.present(cntr, treeTmpl, undefined, extra);\n  });\n\n  if (placeholder instanceof veda.IndividualModel) {\n    placeholder.load().then(function (placeholder) {\n      fulltext.attr({\n        'placeholder': placeholder.toString(),\n        'name': (individual.hasValue('rdf:type') ? individual['rdf:type'][0].id + '_' + rel_uri : rel_uri).toLowerCase().replace(/[-:]/g, '_'),\n      });\n    });\n  } else {\n    fulltext.attr({\n      'placeholder': placeholder,\n      'name': (individual.hasValue('rdf:type') ? individual['rdf:type'][0].id + '_' + rel_uri : rel_uri).toLowerCase().replace(/[-:]/g, '_'),\n    });\n  }\n\n  fulltext.on('input change focus blur', function (e) {\n    const fulltext = $(e.target);\n    const value = fulltext.val();\n    if (value) {\n      const rows = value.split('\\n').length;\n      fulltext.prop('rows', rows);\n    } else {\n      fulltext.prop('rows', 1);\n    }\n  });\n\n  const header = $('.header', control);\n  Promise.all([\n    new veda.IndividualModel('v-s:SelectAll').load(),\n    new veda.IndividualModel('v-s:CancelSelection').load(),\n    new veda.IndividualModel('v-s:InvertSelection').load(),\n  ]).then(function (actions) {\n    header.find('.select-all')\n      .click(function () {\n        suggestions.children(':not(.selected)').click();\n      })\n      .text( actions[0].toString() );\n    header.find('.cancel-selection')\n      .click(function () {\n        suggestions.children('.selected').click();\n      })\n      .text( actions[1].toString() );\n    header.find('.invert-selection')\n      .click(function () {\n        suggestions.children().click();\n      })\n      .text( actions[2].toString() );\n    header.find('.close-menu')\n      .click(function () {\n        setValue(selected);\n        fulltextMenu.hide();\n        $(document).off('click', clickOutsideMenuHandler);\n        $(document).off('keydown', arrowHandler);\n      })\n      .text( 'Ok' );\n  });\n  if (isSingle) {\n    header.hide();\n  }\n\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n    if (e.type === 'search') {\n      const isSingle = false || $(e.delegateTarget).data('single');\n      if (isSingle) {\n        header.hide();\n      } else {\n        header.show();\n      }\n    }\n  });\n\n  const inputHandler = (function () {\n    let timeout;\n    const minLength = 3;\n    const nav_keys = [37, 38, 39, 40, 9, 16]; // Arrows, shift, tab\n    return function (e) {\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n      if (nav_keys.indexOf(e.which) >= 0) {\n        return;\n      }\n      timeout = setTimeout(function () {\n        const value = e.target.value;\n        if (value.length >= minLength) {\n          performSearch(value);\n        } else if (!value.length) {\n          if (isSingle) {\n            individual.clearValue(rel_uri);\n          }\n          suggestions.empty();\n          fulltextMenu.hide();\n          $(document).off('click', clickOutsideMenuHandler);\n          $(document).off('keydown', arrowHandler);\n        }\n      }, 750);\n    };\n  }());\n  fulltext.on('keydown', inputHandler);\n\n  /**\n   * Search actors\n   * @param {string} value\n   * @return {void}\n   */\n  function performSearch(value) {\n    if ( chosenActorType === 'v-s:Appointment' || chosenActorType === 'v-s:Person' || chosenActorType === 'v-s:Position' ) {\n      if ( fullName ) {\n        value = value.trim().split('\\n').map(function (line) {\n          const fullNameProps = ['v-s:employee.v-s:lastName', 'v-s:employee.v-s:firstName', 'v-s:employee.v-s:middleName'];\n          const fullNameInput = line.trim().replace(/\\s+/g, ' ').split(' ');\n          const fullNameQuery = fullNameInput.map(function (token, i) {\n            if (i < 3 && token) {\n              return '\\'' + fullNameProps[i] + '\\'==\\'' + token + '*\\'';\n            }\n          }).filter(Boolean).join(' && ');\n          return fullNameQuery;\n        }).join('\\n');\n      }\n    }\n\n    const ftQueryPromise = interpolate(queryPrefix, individual).then(function(queryPrefix) {\n      if (onlyDeleted) {\n        return ftQuery(queryPrefix + ' && \\'v-s:deleted\\'==\\'true\\'', value, sort, withDeleted);\n      } else {\n        return ftQuery(queryPrefix, value, sort, withDeleted);\n      };\n    });\n\n    ftQueryPromise\n      .then(renderResults)\n      .catch(function (error) {\n        console.log('Fulltext query error', error);\n      });\n  }\n\n  let selected = [];\n\n  /**\n   * Render found search results\n   * @param {Array} results\n   * @return {void}\n   */\n  function renderResults(results) {\n    selected = individual.get(rel_uri).concat(individual.get(rel_uri + '.v-s:employee'), individual.get(rel_uri + '.v-s:occupation'), individual.get(rel_uri + '.v-s:parentUnit'));\n    if (results.length) {\n      const renderedPromises = results.map(function (result) {\n        const cont = $('<a href=\\'#\\' class=\\'suggestion\\'></a>').attr('resource', result.id);\n        if (individual.hasValue(rel_uri, result) || individual.hasValue(rel_uri + '.v-s:employee', result) || individual.hasValue(rel_uri + '.v-s:occupation', result) || individual.hasValue(rel_uri + '.v-s:parentUnit', result)) {\n          cont.addClass('selected');\n        }\n        let tmpl;\n        if ( chosenActorType === 'v-s:Department' && result.hasValue('rdf:type', 'v-s:Appointment') ) {\n          tmpl = '<span about=\\'@\\' rel=\\'v-s:parentUnit\\' data-template=\\'v-ui:LabelTemplate\\'></span>';\n        } else {\n          tmpl = '<span about=\\'@\\' property=\\'rdfs:label\\'></span>';\n        }\n        return result.present(cont, tmpl)\n          .then(function () {\n            return cont;\n          });\n      });\n      Promise.all(renderedPromises).then(function (rendered) {\n        rendered = rendered.sort(function (a, b) {\n          return a.text() < b.text() ? -1 : 1;\n        }).reduce(function (acc, curr) {\n          if ( !acc.length || acc[acc.length - 1].text() !== curr.text() ) {\n            acc.push(curr);\n          }\n          return acc;\n        }, []);\n        suggestions.empty().append(rendered);\n        $(document).off('click', clickOutsideMenuHandler);\n        $(document).off('keydown', arrowHandler);\n        fulltextMenu.show();\n        $(document).on('click', clickOutsideMenuHandler);\n        $(document).on('keydown', arrowHandler);\n      }).catch(console.log);\n    } else {\n      suggestions.empty();\n      fulltextMenu.hide();\n      $(document).off('click', clickOutsideMenuHandler);\n      $(document).off('keydown', arrowHandler);\n    }\n  }\n\n  const suggestions = $('.suggestions', control);\n  let dblTimeout;\n  suggestions.on('click', '.suggestion', function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (!e.originalEvent) {\n      clickHandler(e);\n    } else if (dblTimeout) {\n      dblclickHandler(e);\n    } else {\n      clickHandler(e);\n    }\n  }).on('keydown', '.suggestion', function (e) {\n    if (e.which === 32) {\n      e.preventDefault();\n      e.stopPropagation();\n      clickHandler(e);\n    } else if (e.which === 13) {\n      e.preventDefault();\n      e.stopPropagation();\n      dblclickHandler(e);\n    }\n  }).on('dblclick', '.suggestion', function (e) {\n    e.preventDefault();\n  });\n\n  /**\n   * Click event handler\n   * @param {Event} e\n   * @return {void}\n   */\n  function clickHandler(e) {\n    e.preventDefault();\n    const tmpl = $(e.currentTarget);\n    const suggestion_uri = tmpl.attr('resource');\n    if (!suggestion_uri) {\n      return;\n    }\n    const suggestion = new veda.IndividualModel(suggestion_uri);\n    tmpl.toggleClass('selected');\n    if (isSingle) {\n      tmpl.siblings().removeClass('selected');\n    }\n    if ( selected.indexOf(suggestion) >= 0 ) {\n      if (isSingle) {\n        selected = [suggestion];\n        setValue(selected);\n        fulltextMenu.hide();\n        $(document).off('click', clickOutsideMenuHandler);\n        $(document).off('keydown', arrowHandler);\n      } else {\n        selected = selected.filter(function (value) {\n          return value !== suggestion;\n        });\n      }\n    } else {\n      if (isSingle) {\n        selected = [suggestion];\n        setValue(selected);\n        fulltextMenu.hide();\n        $(document).off('click', clickOutsideMenuHandler);\n        $(document).off('keydown', arrowHandler);\n      } else {\n        selected.push(suggestion);\n      }\n    }\n    dblTimeout = setTimeout(function () {\n      dblTimeout = undefined;\n    }, 300);\n    fulltext.focus();\n  }\n\n  /**\n   * Double click event handler\n   * @param {Event} e\n   * @return {void}\n   */\n  function dblclickHandler(e) {\n    e.preventDefault();\n    if ( !$(e.target).hasClass('selected') ) {\n      clickHandler(e);\n    }\n    dblTimeout = clearTimeout(dblTimeout);\n    setValue(selected);\n    fulltextMenu.hide();\n    $(document).off('click', clickOutsideMenuHandler);\n    $(document).off('keydown', arrowHandler);\n    fulltext.focus();\n  }\n\n  /**\n   * Click outside menu handler\n   * @param {Event} e\n   * @return {void}\n   */\n  function clickOutsideMenuHandler(e) {\n    if ( !$(e.target).closest(fulltextMenu).length && e.target !== fulltext[0] ) {\n      if ( fulltextMenu.is(':visible') ) {\n        if ( selected.length ) {\n          setValue(selected);\n        }\n        fulltextMenu.hide();\n        $(document).off('click', clickOutsideMenuHandler);\n        $(document).off('keydown', arrowHandler);\n      }\n    }\n  }\n\n  /**\n   * Arrow press handler\n   * @param {Event} e\n   * @return {void}\n   */\n  function arrowHandler(e) {\n    if ( e.which === 40 ) { // Down\n      e.preventDefault();\n      e.stopPropagation();\n      const active = suggestions.find('.active').removeClass('active');\n      const next = active.next();\n      if ( next.length ) {\n        next.addClass('active').focus();\n      } else {\n        suggestions.children().first().addClass('active').focus();\n      }\n    } else if ( e.which === 38 ) { // Up\n      e.preventDefault();\n      e.stopPropagation();\n      const active = suggestions.find('.active').removeClass('active');\n      const prev = active.prev();\n      if ( prev.length ) {\n        prev.addClass('active').focus();\n      } else {\n        suggestions.children().last().addClass('active').focus();\n      }\n    } else if ( e.which === 32 && fulltextMenu.find(':focus').length ) { // Space\n      e.preventDefault(); // Prevent scrolling on space\n    }\n  }\n\n  /**\n   * Set property values to individual\n   * @param {Array} values\n   * @return {void}\n   */\n  function setValue(values) {\n    if ( complex ) {\n      individual.clearValue(rel_uri);\n      individual.clearValue(rel_uri + '.v-s:employee');\n      individual.clearValue(rel_uri + '.v-s:occupation');\n      individual.clearValue(rel_uri + '.v-s:parentUnit');\n      if (chosenActorType === 'v-s:Appointment') {\n        individual.set(rel_uri, values);\n      } else if (chosenActorType === 'v-s:Person') {\n        Promise.all(values.map(function (value) {\n          if ( value.hasValue('rdf:type', 'v-s:Appointment') ) {\n            return value['v-s:employee'][0].load();\n          } else if ( value.hasValue('rdf:type', 'v-s:Person') ) {\n            return value;\n          }\n        })).then(function (persons) {\n          individual.set(rel_uri + '.v-s:employee', persons);\n        });\n      } else if (chosenActorType === 'v-s:Position') {\n        Promise.all(values.map(function (value) {\n          if ( value.hasValue('rdf:type', 'v-s:Appointment') ) {\n            return value['v-s:occupation'][0].load();\n          } else if ( value.hasValue('rdf:type', 'v-s:Position') ) {\n            return value;\n          }\n        })).then(function (positions) {\n          individual.set(rel_uri + '.v-s:occupation', positions);\n        });\n      } else if (chosenActorType === 'v-s:Department') {\n        Promise.all(values.map(function (value) {\n          if ( value.hasValue('rdf:type', 'v-s:Appointment') ) {\n            return value['v-s:parentUnit'][0].load();\n          } else if ( value.hasValue('rdf:type', 'v-s:Department') ) {\n            return value;\n          }\n        })).then(function (departments) {\n          individual.set(rel_uri + '.v-s:parentUnit', departments);\n        });\n      }\n    } else {\n      individual.clearValue(rel_uri);\n      if (chosenActorType === 'v-s:Appointment') {\n        individual.set(rel_uri, values);\n      } else if (chosenActorType === 'v-s:Person') {\n        Promise.all(values.map(function (value) {\n          if ( value.hasValue('rdf:type', 'v-s:Appointment') ) {\n            return value['v-s:employee'][0].load();\n          } else if ( value.hasValue('rdf:type', 'v-s:Person') ) {\n            return value;\n          }\n        })).then(function (persons) {\n          individual.set(rel_uri, persons);\n        });\n      } else if (chosenActorType === 'v-s:Position') {\n        Promise.all(values.map(function (value) {\n          if ( value.hasValue('rdf:type', 'v-s:Appointment') ) {\n            return value['v-s:occupation'][0].load();\n          } else if ( value.hasValue('rdf:type', 'v-s:Position') ) {\n            return value;\n          }\n        })).then(function (positions) {\n          individual.set(rel_uri, positions);\n        });\n      } else if (chosenActorType === 'v-s:Department') {\n        Promise.all(values.map(function (value) {\n          if ( value.hasValue('rdf:type', 'v-s:Appointment') ) {\n            return value['v-s:parentUnit'][0].load();\n          } else if ( value.hasValue('rdf:type', 'v-s:Department') ) {\n            return value;\n          }\n        })).then(function (departments) {\n          individual.set(rel_uri, departments);\n        });\n      }\n    }\n  }\n\n  /**\n   * Individual property modified event handler\n   * @param {Array} values\n   * @return {void}\n   */\n  function propertyModifiedHandler(values) {\n    if ( isSingle && (individual.hasValue(rel_uri) || individual.hasValue(rel_uri + '.v-s:employee') || individual.hasValue(rel_uri + '.v-s:occupation') || individual.hasValue(rel_uri + '.v-s:parentUnit')) ) {\n      const value = individual.get(rel_uri).concat(individual.get(rel_uri + '.v-s:employee'), individual.get(rel_uri + '.v-s:occupation'), individual.get(rel_uri + '.v-s:parentUnit')).filter(Boolean)[0];\n      value.load().then(function(value) {\n        const newValueStr = value.toString();\n        const oldValueStr = fulltext.val();\n        if (newValueStr != oldValueStr) {\n          fulltext.val(newValueStr);\n        }\n      });\n    } else {\n      fulltext.val('');\n    }\n  }\n  individual.on( [rel_uri, rel_uri + '.v-s:employee', rel_uri + '.v-s:occupation', rel_uri + '.v-s:parentUnit'].join(' '), propertyModifiedHandler);\n  control.one('remove', function () {\n    [rel_uri, rel_uri + '.v-s:employee', rel_uri + '.v-s:occupation', rel_uri + '.v-s:parentUnit'].forEach((prop) => individual.off(prop, propertyModifiedHandler));\n  });\n  propertyModifiedHandler();\n\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n  });\n  this.append(control);\n  return this;\n};\n$.fn.veda_actor.defaults = {\n  template: $('#actor-control-template').html(),\n};\n\n// SELECT CONTROL\n\n$.fn.veda_select = function (params) {\n  const opts = $.extend( {}, $.fn.veda_select.defaults, params );\n  const control = $(opts.template);\n  const individual = opts.individual;\n  const property_uri = opts.property_uri || opts.rel_uri;\n  const spec = opts.spec;\n  const first_opt = $('option', control);\n  const rangeRestriction = spec && spec.hasValue('v-ui:rangeRestriction') ? spec['v-ui:rangeRestriction'][0] : undefined;\n  const range = rangeRestriction ? [rangeRestriction] : (new veda.IndividualModel(property_uri))['rdfs:range'];\n  const queryPrefix = this.attr('data-query-prefix') || ( spec && spec.hasValue('v-ui:queryPrefix') ? spec['v-ui:queryPrefix'][0] : range.map(function (item) {\n    return '\\'rdf:type\\'===\\'' + item.id + '\\'';\n  }).join(' || ') );\n  const sort = this.attr('data-sort') || ( spec && spec.hasValue('v-ui:sort') && spec['v-ui:sort'][0].toString() );\n  let placeholder = this.attr('placeholder') || ( spec && spec.hasValue('v-ui:placeholder') ? spec['v-ui:placeholder'].map(Util.formatValue).join(' ') : new veda.IndividualModel('v-s:SelectValueBundle') );\n  const source = this.attr('data-source') || undefined;\n  const template = this.attr('data-template') || '{@.rdfs:label}';\n  let options = [];\n  const isSingle = this.attr('data-single') || ( spec && spec.hasValue('v-ui:maxCardinality') ? spec['v-ui:maxCardinality'][0] === 1 : true );\n  let withDeleted = false || this.attr('data-deleted');\n\n  if (placeholder instanceof veda.IndividualModel) {\n    placeholder.load().then(function (placeholderLoaded) {\n      placeholder = placeholderLoaded.toString();\n      populate();\n    });\n  } else {\n    populate();\n  }\n\n  const tabindex = this.attr('tabindex');\n  if (tabindex) {\n    this.removeAttr('tabindex');\n    control.attr('tabindex', tabindex);\n  }\n\n  control.on('mousedown', function (e) {\n    populate();\n  });\n\n  control.change(function (e) {\n    const value = $('option:selected', control).data('value');\n    if (isSingle) {\n      individual.set(property_uri, [value]);\n    } else {\n      if ( !individual.hasValue(property_uri, value) ) {\n        individual.addValue(property_uri, value);\n      }\n      $(e.delegateTarget).children(':first').prop('selected', true);\n    }\n  });\n\n  individual.on(property_uri, handler);\n  control.one('remove', function () {\n    individual.off(property_uri, handler);\n  });\n\n  if (template) {\n    this.removeAttr('data-template');\n  }\n\n  /**\n   * Populate options list\n   * @return {Promise}\n   */\n  function populate() {\n    if (spec && spec.hasValue('v-ui:optionValue')) {\n      options = spec['v-ui:optionValue'];\n      return renderOptions(options);\n    } else if (source) {\n      return Promise.resolve(eval(source))\n        .then(renderOptions)\n        .catch(function (error) {\n          console.log('Source error', source);\n        });\n    } else if (queryPrefix) {\n      return interpolate(queryPrefix, individual)\n        .then(function (queryPrefix) {\n          return ftQuery(queryPrefix, undefined, sort, withDeleted);\n        })\n        .then(renderOptions)\n        .catch(function (error) {\n          console.log('Query prefix error', queryPrefix);\n        });\n    }\n  }\n\n  /**\n   * Render options list\n   * @param {Array} options\n   * @return {Promise}\n   */\n  function renderOptions(options) {\n    control.empty();\n    first_opt.text(placeholder).data('value', null).appendTo(control);\n    const optionsPromises = options.map(function (value, index) {\n      if (index >= 100) {\n        return;\n      }\n      const opt = first_opt.clone().appendTo(control);\n      return renderValue(value, template).then((rendered) => {\n        opt.text(rendered).data('value', value);\n        if (value instanceof veda.IndividualModel && value.hasValue('v-s:deleted', true)) {\n          opt.addClass('deleted');\n        }\n        if ( isSingle && individual.hasValue(property_uri, value) ) {\n          opt.prop('selected', true);\n        }\n        return rendered;\n      });\n    });\n    return Promise.all(optionsPromises);\n  }\n\n  /**\n   * Individual property modified handler to indicate chosen option\n   * @return {void}\n   */\n  function handler() {\n    if (isSingle) {\n      populate().then(function () {\n        $('option', control).each(function (i, el) {\n          const value = $(el).data('value');\n          const hasValue = !!value && individual.hasValue(property_uri, value);\n          $(el).prop('selected', hasValue);\n        });\n      });\n    }\n  }\n\n  if (spec && spec.hasValue('v-ui:tooltip')) {\n    control.tooltip({\n      title: spec['v-ui:tooltip'].join(', '),\n      placement: 'top',\n      container: 'body',\n      trigger: 'hover',\n      animation: false,\n    });\n    control.one('remove', function () {\n      control.tooltip('destroy');\n    });\n  }\n\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n    if (e.type === 'search') {\n      const dataDeleted = $(e.delegateTarget).data('deleted');\n      withDeleted = typeof dataDeleted === 'boolean' ? dataDeleted : true;\n    }\n  });\n  this.on('update', function (e) {\n    e.stopPropagation();\n    populate();\n  });\n  this.append(control);\n  return this;\n};\n$.fn.veda_select.defaults = {\n  template: $('#select-control-template').html(),\n};\n\n// CHECKBOX GROUP CONTROL\n\n$.fn.veda_checkbox = function (params) {\n  const opts = $.extend( {}, $.fn.veda_checkbox.defaults, params );\n  const self = this;\n  const individual = opts.individual;\n  const property_uri = opts.property_uri || opts.rel_uri;\n  const spec = opts.spec;\n  const rangeRestriction = spec && spec.hasValue('v-ui:rangeRestriction') ? spec['v-ui:rangeRestriction'][0] : undefined;\n  const range = rangeRestriction ? [rangeRestriction] : (new veda.IndividualModel(property_uri))['rdfs:range'];\n  const queryPrefix = this.attr('data-query-prefix') || ( spec && spec.hasValue('v-ui:queryPrefix') ? spec['v-ui:queryPrefix'][0] : range.map(function (item) {\n    return '\\'rdf:type\\'===\\'' + item.id + '\\'';\n  }).join(' || ') );\n  const sort = this.attr('data-sort') || ( spec && spec.hasValue('v-ui:sort') && spec['v-ui:sort'][0].toString() );\n  const source = this.attr('data-source') || undefined;\n  const template = this.attr('data-template') || '{@.rdfs:label}';\n  let options = [];\n  let withDeleted = false || this.attr('data-deleted');\n\n  populate();\n\n  individual.on(property_uri, handler);\n  this.one('remove', function () {\n    individual.off(property_uri, handler);\n  });\n\n  if (template) {\n    this.removeAttr('data-template');\n  }\n\n  /**\n   * Populate options list\n   * @return {Promise}\n   */\n  function populate() {\n    if (spec && spec.hasValue('v-ui:optionValue')) {\n      options = spec['v-ui:optionValue'];\n      return renderOptions(options);\n    } else if (source) {\n      return Promise.resolve(eval(source))\n        .then(renderOptions)\n        .catch(function (error) {\n          console.log('Source error', source);\n        });\n    } else if (queryPrefix) {\n      return interpolate(queryPrefix, individual)\n        .then(function (queryPrefix) {\n          return ftQuery(queryPrefix, undefined, sort, withDeleted);\n        })\n        .then(renderOptions)\n        .catch(function (error) {\n          console.log('Query prefix error', queryPrefix);\n        });\n    }\n  }\n\n  /**\n   * Render options list\n   * @param {Array} options\n   * @return {Promise}\n   */\n  function renderOptions(options) {\n    self.empty();\n    const optionsPromises = options.map(function (value, index) {\n      if (index >= 100) {\n        return;\n      }\n      const hld = $(opts.template).appendTo(self);\n      return renderValue(value, template).then((rendered) => {\n        const lbl = $('label', hld).append( rendered );\n        const chk = $('input', lbl).data('value', value);\n        if (value instanceof veda.IndividualModel && value.hasValue('v-s:deleted', true)) {\n          hld.addClass('deleted');\n        }\n        const hasValue = individual.hasValue(property_uri, value);\n        chk.prop('checked', hasValue);\n        chk.change(function () {\n          if ( chk.is(':checked') ) {\n            individual.addValue(property_uri, value);\n          } else {\n            individual.removeValue(property_uri, value);\n          }\n        });\n        if (opts.mode === 'view') {\n          hld.addClass('disabled');\n          chk.attr('disabled', 'disabled');\n        }\n      });\n    });\n    return Promise.all(optionsPromises);\n  }\n\n  /**\n   * Individual property modified handler to indicate chosen option\n   * @return {void}\n   */\n  function handler() {\n    $('input', self).each(function (i, el) {\n      const value = $(el).data('value');\n      const hasValue = individual.hasValue(property_uri, value);\n      $(el).prop('checked', hasValue);\n    });\n  }\n\n  if (spec && spec.hasValue('v-ui:tooltip')) {\n    this.tooltip({\n      title: spec['v-ui:tooltip'].join(', '),\n      placement: 'left',\n      container: 'body',\n      trigger: 'hover',\n      animation: false,\n    }).one('remove', function (e) {\n      $(e.delegateTarget).tooltip('destroy');\n    });\n  }\n\n  this.on('update', function (e) {\n    e.stopPropagation();\n    populate();\n  });\n\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n    if (e.type === 'view') {\n      $(e.delegateTarget).children().addClass('disabled');\n      $('input', e.delegateTarget).attr('disabled', 'true');\n    } else {\n      $(e.delegateTarget).children().removeClass('disabled');\n      $('input', e.delegateTarget).removeAttr('disabled');\n    }\n    if (e.type === 'search') {\n      const dataDeleted = $(e.delegateTarget).data('deleted');\n      withDeleted = typeof dataDeleted === 'boolean' ? dataDeleted : true;\n    }\n  });\n  return this;\n};\n$.fn.veda_checkbox.defaults = {\n  template: $('#checkbox-control-template').html(),\n};\n\n// RADIO GROUP CONTROL\n\n$.fn.veda_radio = function (params) {\n  const opts = $.extend( {}, $.fn.veda_radio.defaults, params );\n  const self = this;\n  const individual = opts.individual;\n  const property_uri = opts.property_uri || opts.rel_uri;\n  const spec = opts.spec;\n  const rangeRestriction = spec && spec.hasValue('v-ui:rangeRestriction') ? spec['v-ui:rangeRestriction'][0] : undefined;\n  const range = rangeRestriction ? [rangeRestriction] : (new veda.IndividualModel(property_uri))['rdfs:range'];\n  const queryPrefix = this.attr('data-query-prefix') || ( spec && spec.hasValue('v-ui:queryPrefix') ? spec['v-ui:queryPrefix'][0] : range.map(function (item) {\n    return '\\'rdf:type\\'===\\'' + item.id + '\\'';\n  }).join(' || ') );\n  const sort = this.attr('data-sort') || ( spec && spec.hasValue('v-ui:sort') && spec['v-ui:sort'][0].toString() );\n  const source = this.attr('data-source') || undefined;\n  const template = this.attr('data-template') || '{@.rdfs:label}';\n  let options = [];\n  let withDeleted = false || this.attr('data-deleted');\n\n  populate();\n\n  individual.on(property_uri, handler);\n  this.one('remove', function () {\n    individual.off(property_uri, handler);\n  });\n\n  if (template) {\n    this.removeAttr('data-template');\n  }\n\n  /**\n   * Populate options list\n   * @return {Promise}\n   */\n  function populate() {\n    if (spec && spec.hasValue('v-ui:optionValue')) {\n      options = spec['v-ui:optionValue'];\n      return renderOptions(options);\n    } else if (source) {\n      return Promise.resolve(eval(source))\n        .then(renderOptions)\n        .catch(function (error) {\n          console.log('Source error', source);\n        });\n    } else if (queryPrefix) {\n      return interpolate(queryPrefix, individual)\n        .then(function (queryPrefix) {\n          return ftQuery(queryPrefix, undefined, sort, withDeleted);\n        })\n        .then(renderOptions)\n        .catch(function (error) {\n          console.log('Query prefix error', queryPrefix);\n        });\n    }\n  }\n\n  /**\n   * Render options list\n   * @param {Array} options\n   * @return {void}\n   */\n  function renderOptions(options) {\n    self.empty();\n    options.forEach(function (value, index) {\n      if (index >= 100) {\n        return;\n      }\n      const hld = $(opts.template).appendTo(self);\n      return renderValue(value, template).then((rendered) => {\n        const lbl = $('label', hld).append( rendered );\n        const rad = $('input', lbl).data('value', value);\n        if (value instanceof veda.IndividualModel && value.hasValue('v-s:deleted', true)) {\n          hld.addClass('deleted');\n        }\n        const hasValue = individual.hasValue(property_uri, value);\n        rad.prop('checked', hasValue);\n        rad.change(function () {\n          if ( rad.is(':checked') ) {\n            individual.set(property_uri, [value]);\n          } else {\n            individual.removeValue(property_uri, value);\n          }\n        });\n        if (opts.mode === 'view') {\n          hld.addClass('disabled');\n          rad.attr('disabled', 'disabled');\n        }\n      });\n    });\n  }\n\n  /**\n   * Individual property modified handler to indicate chosen option\n   * @return {void}\n   */\n  function handler() {\n    $('input', self).each(function (i, el) {\n      const value = $(el).data('value');\n      const hasValue = individual.hasValue(property_uri, value);\n      $(el).prop('checked', hasValue);\n    });\n  }\n\n  if (spec && spec.hasValue('v-ui:tooltip')) {\n    this.tooltip({\n      title: spec['v-ui:tooltip'].join(', '),\n      placement: 'left',\n      container: 'body',\n      trigger: 'hover',\n      animation: false,\n    }).one('remove', function (e) {\n      $(e.delegateTarget).tooltip('destroy');\n    });\n  }\n\n  this.on('update', function (e) {\n    e.stopPropagation();\n    populate();\n  });\n\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n    if (e.type === 'view') {\n      $('div.radio', e.delegateTarget).addClass('disabled');\n      $('input', e.delegateTarget).attr('disabled', 'true');\n    } else {\n      $('div.radio', e.delegateTarget).removeClass('disabled');\n      $('input', e.delegateTarget).removeAttr('disabled');\n    }\n    if (e.type === 'search') {\n      const dataDeleted = $(e.delegateTarget).data('deleted');\n      withDeleted = typeof dataDeleted === 'boolean' ? dataDeleted : true;\n    }\n  });\n  return this;\n};\n$.fn.veda_radio.defaults = {\n  template: $('#radio-control-template').html(),\n};\n\n// BOOLEAN RADIO\n\n$.fn.veda_booleanRadio = function (params) {\n  const opts = $.extend( {}, $.fn.veda_booleanRadio.defaults, params );\n  const self = this;\n  const individual = opts.individual;\n  const property_uri = opts.property_uri || opts.rel_uri;\n  const spec = opts.spec;\n  const trueOption = {\n    label: spec && spec.hasValue('v-ui:trueLabel') ?\n      Promise.resolve(spec.get('v-ui:trueLabel').map(Util.formatValue).join(' ')) :\n      (new veda.IndividualModel('v-s:YesBundle')).load().then(function(loaded) {\n        return loaded.get('rdfs:label').map(Util.formatValue).join(' ');\n      }),\n    value: true,\n  };\n  const falseOption = {\n    label: spec && spec.hasValue('v-ui:falseLabel') ?\n      Promise.resolve(spec.get('v-ui:falseLabel').map(Util.formatValue).join(' ')) :\n      (new veda.IndividualModel('v-s:NoBundle')).load().then(function(loaded) {\n        return loaded.get('rdfs:label').map(Util.formatValue).join(' ');\n      }),\n    value: false,\n  };\n  const options = [trueOption, falseOption];\n\n  renderOptions();\n\n  individual.on(property_uri, handler);\n  this.one('remove', function () {\n    individual.off(property_uri, handler);\n  });\n\n  /**\n   * Render options list\n   * @param {Array} options\n   * @return {void}\n   */\n  function renderOptions() {\n    self.empty();\n    options.map(function (option) {\n      const hld = $(opts.template).appendTo(self);\n      option.label.then(function(label) {\n        const lbl = $('label', hld).append( label );\n        const rad = $('input', lbl).data('value', option.value);\n        const hasValue = individual.hasValue(property_uri, option.value);\n        rad.prop('checked', hasValue);\n        rad.change(function () {\n          if ( rad.is(':checked') ) {\n            individual.set(property_uri, [rad.data('value')]);\n          } else {\n            individual.set(property_uri, individual.get(property_uri).filter( function (i) {\n              return i.valueOf() !== rad.data('value').valueOf();\n            }));\n          }\n        });\n      });\n    });\n  }\n\n  /**\n   * Individual property modified handler to indicate chosen option\n   * @return {void}\n   */\n  function handler() {\n    $('input', self).each(function (i, el) {\n      const value = $(el).data('value');\n      const hasValue = individual.hasValue(property_uri, value);\n      $(el).prop('checked', hasValue);\n    });\n  }\n\n  if (spec && spec.hasValue('v-ui:tooltip')) {\n    this.tooltip({\n      title: spec['v-ui:tooltip'].join(', '),\n      placement: 'left',\n      container: 'body',\n      trigger: 'hover',\n      animation: false,\n    }).one('remove', function (e) {\n      $(e.delegateTarget).tooltip('destroy');\n    });\n  }\n\n  this.on('update', function (e) {\n    e.stopPropagation();\n    renderOptions();\n  });\n\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n    if (e.type === 'view') {\n      $('div.radio', e.delegateTarget).addClass('disabled');\n      $('input', e.delegateTarget).attr('disabled', 'true');\n      $(e.delegateTarget).removeClass('has-error');\n    } else {\n      $('div.radio', e.delegateTarget).removeClass('disabled');\n      $('input', e.delegateTarget).removeAttr('disabled');\n    }\n  });\n  return this;\n};\n$.fn.veda_booleanRadio.defaults = {\n  template: $('#radio-control-template').html(),\n};\n\n// SOURCE CODE CONTROL\n$.fn.veda_source = function (options) {\n  const opts = $.extend( {}, $.fn.veda_source.defaults, options );\n  const control = $(opts.template);\n  const individual = opts.individual;\n  const property_uri = opts.property_uri;\n  const editorEl = control.get(0);\n\n  opts.value = individual.hasValue(property_uri) ? individual.get(property_uri)[0].toString() : '';\n  opts.change = function (value) {\n    individual.set(property_uri, [value]);\n  };\n\n  if (typeof this.attr('data-mode') !== 'undefined') opts.sourceMode = this.attr('data-mode');\n  if (property_uri === 'v-s:script') opts.sourceMode = 'ace/mode/javascript';\n  if (property_uri === 'v-ui:template') opts.sourceMode = 'ace/mode/html';\n\n  const debounce = function (f, ms) {\n    let skip = false;\n    return function(...args) {\n      if (skip) return;\n      skip = true;\n      setTimeout(() => skip = false, ms);\n      return f(...args);\n    };\n  };\n\n  System.import('ace').then((module) => {\n    const ace = module.default;\n\n    const editor = ace.edit(editorEl, {\n      mode: opts.sourceMode,\n      readOnly: opts.mode === 'view',\n      selectionStyle: 'text',\n      fontSize: 14,\n      value: opts.value,\n    });\n\n    this.on('view edit search', function (e) {\n      e.stopPropagation();\n      e.type === 'view' ? ( editor.setReadOnly(true) ) :\n        e.type === 'edit' ? ( editor.setReadOnly(false) ) :\n          e.type === 'search' ? ( editor.setReadOnly(false) ) :\n            true;\n    });\n\n    const editorHandler = function(delta) {\n      const value = opts.parser( editor.session.getValue() );\n      opts.change(value);\n    };\n    const debouncedEditorHandler = debounce(editorHandler, 100);\n\n    editor.session.on('change', debouncedEditorHandler);\n\n    const individualHandler = function (values) {\n      const value = opts.parser( editor.session.getValue() );\n      if (!values.length || values[0].toString() !== value) {\n        editor.setValue( values.length ? values[0].toString() : '' );\n      }\n    };\n    const debouncedIndividualHandler = debounce(individualHandler, 100);\n\n    individual.on(property_uri, debouncedIndividualHandler);\n    this.one('remove', function () {\n      individual.off(property_uri, debouncedIndividualHandler);\n      editor.destroy();\n    });\n  });\n\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n  });\n\n  this.append(control);\n  return this;\n};\n$.fn.veda_source.defaults = {\n  value: '',\n  template: $('#source-control-template').html(),\n  mode: 'javascript',\n  parser: function (input) {\n    return (input || null);\n  },\n};\n\n// FILE UPLOAD CONTROL\n\n/**\n * Load image to browser\n * @param {File} imageFile - value from file input\n * @return {Promise}\n */\nfunction loadImage(imageFile) {\n  return new Promise(function (resolve, reject) {\n    const reader = new FileReader();\n    reader.onload = function(e) {\n      const image = new Image();\n      image.onload = function() {\n        resolve(image);\n      };\n      image.onerror = function () {\n        reject( new Error('Image load error') );\n      };\n      image.src = e.target.result;\n    };\n    reader.onerror = function () {\n      reject( new Error('File reader error') );\n    };\n    reader.readAsDataURL(imageFile);\n  });\n}\n\n/**\n * Resize image to max width\n * @param {Image} image\n * @param {number} maxWidth - width in pixels\n * @return {Promise}\n */\nfunction resizeImage (image, maxWidth) {\n  return new Promise(function (resolve, reject) {\n    if (image.width <= maxWidth) {\n      resolve(image);\n    } else {\n      const temp = $('<div></div>').append(image);\n      System.import('cropper/cropper.min.js').then(function (module) {\n        const Cropper = module.default;\n        System.import('cropper/cropper.min.css').then(function (module) {\n          const styleSheet = module.default;\n          document.adoptedStyleSheets = [...document.adoptedStyleSheets, styleSheet];\n\n          const cropper = new Cropper(image, {\n            autoCrop: false,\n            ready: function (event) {\n              console.log('Crop ready');\n              const ratio = image.height / image.width;\n              const resized = new Image();\n              resized.src = cropper.getCroppedCanvas({\n                maxWidth: maxWidth,\n                maxHeight: Math.floor(maxWidth * ratio),\n              }).toDataURL('image/jpeg');\n              resolve(resized);\n              cropper.destroy();\n            },\n          });\n        });\n      });\n    }\n  });\n}\n\n/**\n * Crop image\n * @param {Image} imageForCrop\n * @param {number} ratio\n * @param {number} maxWidth\n * @return {Promise}\n */\nfunction cropImage(imageForCrop, ratio, maxWidth) {\n  const modal = $( $('#confirm-modal-template').html() );\n  modal.modal();\n  $('body').append(modal);\n  const container = $('.modal-body', modal);\n  imageForCrop.style.cssText = 'display:block; width:100%';\n  const temp = $('<div></div>').append(imageForCrop);\n  container.append(temp);\n\n  return new Promise(function (resolve, reject) {\n    System.import('cropper/cropper.min.js').then(function (module) {\n      const Cropper = module.default;\n      System.import('cropper/cropper.min.css').then(function (module) {\n        const styleSheet = module.default;\n        document.adoptedStyleSheets = [...document.adoptedStyleSheets, styleSheet];\n\n        // in templates ratio=h/w, in crop ratio=w/h\n        const cropper = new Cropper(imageForCrop, {\n          aspectRatio: 1 / ratio,\n          movable: false,\n          rotable: false,\n          scalable: false,\n          ready: function (event) {\n            console.log('Crop ready');\n          },\n        });\n\n        $('.modal-footer > .ok', modal).click(function () {\n          const img = new Image();\n          img.src = cropper.getCroppedCanvas({\n            maxWidth: maxWidth,\n            maxHeight: Math.floor(maxWidth*ratio),\n          }).toDataURL('image/jpeg');\n          resolve(img);\n          cropper.destroy();\n        });\n        $('.modal-footer > .cancel', modal).click(function () {\n          resolve(false);\n        });\n        modal.on('hidden.bs.modal', function () {\n          modal.remove();\n          resolve(false);\n          cropper.destroy();\n        });\n      });\n    });\n  });\n};\n\n$.fn.veda_file = function( options ) {\n  const opts = $.extend( {}, $.fn.veda_file.defaults, options );\n  const control = $(opts.template);\n  const fileInput = control.find('input');\n  const indicatorPercentage = $('.indicator-percentage', control);\n  const indicatorSpinner = $('.indicator-spinner', control);\n  const spec = opts.spec;\n  const individual = opts.individual;\n  const rel_uri = opts.property_uri;\n  const rangeRestriction = spec && spec.hasValue('v-ui:rangeRestriction') ? spec['v-ui:rangeRestriction'][0] : undefined;\n  const range = rangeRestriction ? [rangeRestriction] : new veda.IndividualModel(rel_uri)['rdfs:range'];\n  const isSingle = spec && spec.hasValue('v-ui:maxCardinality') ? spec['v-ui:maxCardinality'][0] === 1 : true;\n  const accept = this.attr('accept');\n  const maxWidth = this.attr('data-max-width') || 2048;\n  const targetRatio = this.attr('data-ratio');\n\n  if (!isSingle) {\n    fileInput.attr('multiple', 'multiple');\n  }\n  if (accept) {\n    fileInput.attr('accept', accept);\n  }\n\n  const progress = function (progressEvent) {\n    if (progressEvent.lengthComputable) {\n      try {\n        const percentComplete = Math.round(progressEvent.loaded / progressEvent.total * 100);\n        indicatorPercentage.text(percentComplete + '%').show();\n      } catch (err) {\n        console.log('Progress indicator error', error);\n      }\n    } else {\n      indicatorSpinner.show();\n    }\n  };\n\n  const createFileIndividual = function (file, name, parent) {\n    const fileName = file.name || name;\n    const uri = veda.Util.guid();\n    const path = '/' + new Date().toISOString().substring(0, 10).split('-').join('/');\n    const fileIndividual = new veda.IndividualModel();\n    fileIndividual['rdf:type'] = range;\n    fileIndividual['v-s:fileName'] = [fileName];\n    fileIndividual['rdfs:label'] = [fileName];\n    fileIndividual['v-s:fileSize'] = [file.size];\n    fileIndividual['v-s:fileUri'] = [uri];\n    fileIndividual['v-s:filePath'] = [path];\n    fileIndividual['v-s:parent'] = [parent];\n    return new Promise(function (resolve, reject) {\n      // If file is image && !thumbnail\n      if ( file.name && (/^(?!thumbnail-).+\\.(jpg|jpeg|gif|png|bmp|svg)$/i).test(file.name) ) {\n        loadImage(file)\n          .then(function (image) {\n            if (targetRatio) {\n              const curRatio = image.height / image.width;\n              console.log('curRatio: ', curRatio);\n              if ( !((targetRatio - 0.1) < curRatio && curRatio < (targetRatio + 0.1)) ) {\n                return cropImage(image, targetRatio, maxWidth);\n              };\n            };\n            return image;\n          }).then(function(image) {\n            if (image === false) {\n              reject(Error('Cropper canceled'));\n            } else {\n              file = image;\n              return resizeImage(image, 256).then(function(thumbnail) {\n                createFileIndividual(thumbnail, 'thumbnail-' + fileName, fileIndividual)\n                  .then(function (thumbnailIndividual) {\n                    fileIndividual['v-s:thumbnail'] = [thumbnailIndividual];\n                    resolve(fileIndividual);\n                  });\n              });\n            };\n          });\n      } else {\n        resolve(fileIndividual);\n      }\n    }).then(function () {\n      return veda.Backend.uploadFile({\n        file: file,\n        path: path,\n        uri: uri,\n        progress: progress,\n      });\n    }).then(function () {\n      return fileIndividual.save();\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  fileInput.change(function (e) {\n    const self = e.delegateTarget;\n    const fileIndividualPromises = [];\n    for (let i = 0, file; (file = self.files && self.files[i]); i++) {\n      const fileIndividualPromise = createFileIndividual(file, undefined, individual);\n      fileIndividualPromises.push(fileIndividualPromise);\n    }\n    if (!fileIndividualPromises.length) {\n      return;\n    }\n    control.addClass('disabled');\n    fileInput.attr('disabled', 'disabled');\n    Promise.all(fileIndividualPromises)\n      .then(function (fileIndividuals) {\n        control.removeClass('disabled');\n        fileInput.removeAttr('disabled');\n        self.value = '';\n        indicatorSpinner.empty().hide();\n        indicatorPercentage.empty().hide();\n        if (isSingle) {\n          individual.set(rel_uri, fileIndividuals);\n        } else {\n          individual.addValue(rel_uri, fileIndividuals);\n        }\n      })\n      .catch(function (error) {\n        console.log(error);\n      })\n      .then(function () {\n        control.removeClass('disabled');\n        fileInput.removeAttr('disabled');\n      });\n  });\n\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n  });\n  this.append(control);\n  return this;\n};\n\n$.fn.veda_file.defaults = {\n  template: $('#file-control-template').html(),\n};\n\n// OBJECT PROPERTY CONTROL\n$.fn.veda_link = function( options ) {\n  const opts = $.extend( {}, $.fn.veda_link.defaults, options );\n  const control = $(opts.template);\n  const template = this.attr('data-template') || '{@.rdfs:label}';\n  const individual = opts.individual;\n  const spec = opts.spec;\n  const placeholder = this.attr('placeholder') || ( spec && spec.hasValue('v-ui:placeholder') ? spec['v-ui:placeholder'].map(Util.formatValue).join(' ') : new veda.IndividualModel('v-s:StartTypingBundle') );\n  const rel_uri = opts.property_uri;\n  const rangeRestriction = spec && spec.hasValue('v-ui:rangeRestriction') ? spec['v-ui:rangeRestriction'][0] : undefined;\n  const range = rangeRestriction ? [rangeRestriction] : new veda.IndividualModel(rel_uri)['rdfs:range'];\n  const queryPrefix = this.attr('data-query-prefix') || ( spec && spec.hasValue('v-ui:queryPrefix') ? spec['v-ui:queryPrefix'][0].toString() : range.map(function (item) {\n    return '\\'rdf:type\\'===\\'' + item.id + '\\'';\n  }).join(' || ') );\n  const source = this.attr('data-source') || undefined;\n  const sort = this.attr('data-sort') || ( spec && spec.hasValue('v-ui:sort') && spec['v-ui:sort'][0].toString() );\n  let isSingle = this.attr('data-single') || ( spec && spec.hasValue('v-ui:maxCardinality') ? spec['v-ui:maxCardinality'][0] === 1 : true );\n  let withDeleted = false || this.attr('data-deleted');\n\n  const tabindex = this.attr('tabindex');\n  if (tabindex) {\n    this.removeAttr('tabindex');\n    control.find('textarea').attr('tabindex', tabindex);\n  }\n\n  if (template) {\n    this.removeAttr('data-template');\n  }\n\n  // Select value\n  const select = function (selected) {\n    selected = selected instanceof Array ? selected : [selected];\n    if (isSingle) {\n      individual.set(rel_uri, [selected[0]]);\n    } else {\n      const filtered = selected.filter( function (i) {\n        return individual.get(rel_uri).indexOf(i) < 0;\n      });\n      individual.set(rel_uri, individual.get(rel_uri).concat(filtered));\n    }\n  };\n\n  const createValue = function () {\n    const newVal = new veda.IndividualModel();\n    newVal['rdf:type'] = rangeRestriction ? [rangeRestriction] : [(new veda.IndividualModel(rel_uri))['rdfs:range'][0]];\n    return newVal;\n  };\n\n  // Create feature\n  const create = $('.create', control);\n  if ( this.hasClass('create') || this.hasClass('full') ) {\n    const inModal = this.hasClass('create-modal');\n    const rel_range = rangeRestriction ? rangeRestriction : (new veda.IndividualModel(rel_uri))['rdfs:range'][0];\n    rel_range.rights.then(function (rights) {\n      if ( !rights.hasValue('v-s:canCreate', true) && opts.mode !== 'search' ) {\n        create.addClass('disabled');\n        create.off('click keyup');\n      } else {\n        create.on('click keydown', function (e) {\n          if (e.type !== 'click' && e.which !== 13 && e.which !== 32) {\n            return;\n          }\n          e.preventDefault();\n          e.stopPropagation();\n          const newVal = createValue();\n          if ( inModal ) {\n            let modal = $('#individual-modal-template').html();\n            modal = $(modal).modal({'show': false});\n            $('body').append(modal);\n            modal.modal('show');\n            create.one('remove', function () {\n              modal.modal('hide').remove();\n              $(document).off('keyup', escHandler);\n            });\n            const ok = $('#ok', modal).click(function (e) {\n              select(newVal);\n              $(document).off('keyup', escHandler);\n            });\n            const close = $('.close', modal).click(function (e) {\n              newVal.delete();\n              $(document).off('keyup', escHandler);\n            });\n            const escHandler = function (e) {\n              if (e.keyCode === 27) {\n                close.click();\n              }\n            };\n            $(document).on('keyup', escHandler);\n            const cntr = $('.modal-body', modal);\n            newVal.one('beforeReset', function () {\n              modal.modal('hide').remove();\n            });\n            newVal.one('afterSave', function () {\n              select(newVal);\n              modal.modal('hide').remove();\n            });\n            newVal.present(cntr, undefined, 'edit').then(function (tmpl) {\n              $('.action', tmpl).remove();\n              const validation = tmpl.data('validation');\n              if ( validation && validation.state ) {\n                ok.removeAttr('disabled');\n              } else {\n                ok.attr('disabled', 'disabled');\n              }\n              tmpl.on('internal-validated', function (e, validation) {\n                if (validation.state) {\n                  ok.removeAttr('disabled');\n                } else {\n                  ok.attr('disabled', 'disabled');\n                }\n              });\n            });\n          } else {\n            select(newVal);\n          }\n        });\n      }\n    });\n\n\n    // Hide create button for single value relations if value exists\n    if (isSingle) {\n      const singleValueHandler = function (values) {\n        if (values.length) {\n          create.hide();\n        } else {\n          create.show();\n        }\n      };\n      individual.on(rel_uri, singleValueHandler);\n      create.one('remove', function () {\n        individual.off(rel_uri, singleValueHandler);\n      });\n      singleValueHandler(individual.get(rel_uri));\n    }\n  } else {\n    create.remove();\n  }\n\n  // Tree feature\n  const tree = $('.tree', control);\n  if ( this.hasClass('tree') || this.hasClass('full') ) {\n    const treeTmpl = new veda.IndividualModel('v-ui:TreeTemplate');\n    const modal = $('#individual-modal-template').html();\n    tree.on('click keydown', function (e) {\n      if (e.type !== 'click' && e.which !== 13 && e.which !== 32) {\n        return;\n      }\n      e.preventDefault();\n      e.stopPropagation();\n      const $modal = $(modal);\n      const cntr = $('.modal-body', $modal);\n      $modal.on('hidden.bs.modal', function (e) {\n        $modal.remove();\n      });\n      $modal.modal();\n      $('body').append($modal);\n\n      const extra = {\n        target: individual,\n        target_rel_uri: rel_uri,\n        isSingle: isSingle,\n        withDeleted: withDeleted,\n        sort: sort,\n      };\n      spec.present(cntr, treeTmpl, undefined, extra);\n    });\n  } else {\n    tree.remove();\n  }\n\n  // Fulltext search feature\n  let selected = [];\n  const fulltext = $('.fulltext', control);\n  const fulltextMenu = $('.fulltext-menu', control);\n  if ( this.hasClass('fulltext') || this.hasClass('full') ) {\n    if (placeholder instanceof veda.IndividualModel) {\n      placeholder.load().then(function (placeholder) {\n        fulltext.attr({\n          'placeholder': placeholder.toString(),\n          'name': (individual.hasValue('rdf:type') ? individual['rdf:type'][0].id + '_' + rel_uri : rel_uri).toLowerCase().replace(/[-:]/g, '_'),\n        });\n      });\n    } else {\n      fulltext.attr({\n        'placeholder': placeholder,\n        'name': (individual.hasValue('rdf:type') ? individual['rdf:type'][0].id + '_' + rel_uri : rel_uri).toLowerCase().replace(/[-:]/g, '_'),\n      });\n    }\n\n    fulltext.on('input change focus blur', function (e) {\n      const fulltext = $(e.target);\n      const value = fulltext.val();\n      if (value) {\n        const rows = value.split('\\n').length;\n        fulltext.prop('rows', rows);\n      } else {\n        fulltext.prop('rows', 1);\n      }\n    });\n\n    const header = $('.header', control);\n    Promise.all([\n      new veda.IndividualModel('v-s:SelectAll').load(),\n      new veda.IndividualModel('v-s:CancelSelection').load(),\n      new veda.IndividualModel('v-s:InvertSelection').load(),\n    ]).then(function (actions) {\n      header.find('.select-all')\n        .click(function () {\n          suggestions.children(':not(.selected)').click();\n        })\n        .text( actions[0].toString() );\n      header.find('.cancel-selection')\n        .click(function () {\n          suggestions.children('.selected').click();\n        })\n        .text( actions[1].toString() );\n      header.find('.invert-selection')\n        .click(function () {\n          suggestions.children().click();\n        })\n        .text( actions[2].toString() );\n      header.find('.close-menu')\n        .click(function () {\n          individual.set(rel_uri, selected);\n          fulltextMenu.hide();\n          $(document).off('click', clickOutsideMenuHandler);\n          $(document).off('keydown', arrowHandler);\n        })\n        .text( 'Ok' );\n    });\n    if (isSingle) {\n      header.hide();\n    }\n\n    this.on('view edit search', function (e) {\n      e.stopPropagation();\n      if (e.type === 'search') {\n        const isSingle = false || $(e.delegateTarget).data('single');\n        if (isSingle) {\n          header.hide();\n        } else {\n          header.show();\n        }\n      }\n    });\n\n    const performSearch = function (value) {\n      if (source) {\n        return Promise.resolve(eval(source))\n          .then(renderResults)\n          .catch(function (error) {\n            console.log('Source error', source);\n          });\n      } else {\n        interpolate(queryPrefix, individual).then(function (queryPrefix) {\n          ftQuery(queryPrefix, value, sort, withDeleted)\n            .then(renderResults)\n            .catch(function (error) {\n              console.log('Fulltext query error', error);\n            });\n        });\n      }\n    };\n\n    const inputHandler = (function () {\n      let timeout;\n      const minLength = 3;\n      const nav_keys = [37, 38, 39, 40, 9, 16]; // Arrows, shift, tab\n      return function (e) {\n        if (timeout) {\n          clearTimeout(timeout);\n        }\n        if (nav_keys.indexOf(e.which) >= 0) {\n          return;\n        }\n        timeout = setTimeout(function () {\n          const value = e.target.value;\n          if (value.length >= minLength) {\n            performSearch(value);\n          } else if (!value.length) {\n            if (isSingle) {\n              individual.clearValue(rel_uri);\n            }\n            suggestions.empty();\n            fulltextMenu.hide();\n            $(document).off('click', clickOutsideMenuHandler);\n            $(document).off('keydown', arrowHandler);\n          }\n        }, 750);\n      };\n    }());\n    fulltext.on('keydown', inputHandler);\n\n    const renderResults = function (results) {\n      suggestions.empty();\n      selected = individual.get(rel_uri);\n      if (results.length) {\n        const promises = results.map((value) => {\n          return renderValue(value, template).then((rendered) => {\n            const tmpl = $('<a href=\\'#\\' class=\\'suggestion\\'></a>')\n              .text( rendered )\n              .attr('resource', value.id);\n            if (individual.hasValue(rel_uri, value)) {\n              tmpl.addClass('selected');\n            }\n            if (value.hasValue('v-s:deleted', true)) {\n              tmpl.addClass('deleted');\n            }\n            if (value.hasValue('v-s:valid', false) && !value.hasValue('v-s:deleted', true) ) {\n              tmpl.addClass('invalid');\n            }\n            return tmpl;\n          })\n        });\n        Promise.all(promises).then((renderedList) => {\n          suggestions.append(renderedList);\n          $(document).off('click', clickOutsideMenuHandler);\n          $(document).off('keydown', arrowHandler);\n          fulltextMenu.show();\n          $(document).on('click', clickOutsideMenuHandler);\n          $(document).on('keydown', arrowHandler);\n        });\n      } else {\n        fulltextMenu.hide();\n        $(document).off('click', clickOutsideMenuHandler);\n        $(document).off('keydown', arrowHandler);\n      }\n    };\n\n    const suggestions = $('.suggestions', control);\n    let dblTimeout;\n    suggestions.on('click', '.suggestion', function (e) {\n      e.preventDefault();\n      e.stopPropagation();\n      if (!e.originalEvent) {\n        clickHandler(e);\n      } else if (dblTimeout) {\n        dblclickHandler(e);\n      } else {\n        clickHandler(e);\n      }\n    }).on('keydown', '.suggestion', function (e) {\n      if (e.which === 32) {\n        e.preventDefault();\n        e.stopPropagation();\n        clickHandler(e);\n      } else if (e.which === 13) {\n        e.preventDefault();\n        e.stopPropagation();\n        dblclickHandler(e);\n      }\n    }).on('dblclick', '.suggestion', function (e) {\n      e.preventDefault();\n    });\n\n    const clickHandler = function (e) {\n      e.preventDefault();\n      const tmpl = $(e.target);\n      const suggestion_uri = tmpl.attr('resource');\n      if (!suggestion_uri) {\n        return;\n      }\n      const suggestion = new veda.IndividualModel(suggestion_uri);\n      tmpl.toggleClass('selected');\n      if (isSingle) {\n        tmpl.siblings().removeClass('selected');\n      }\n      if ( selected.indexOf(suggestion) >= 0 ) {\n        if (isSingle) {\n          individual.set(rel_uri, [suggestion]);\n          fulltextMenu.hide();\n          $(document).off('click', clickOutsideMenuHandler);\n          $(document).off('keydown', arrowHandler);\n        } else {\n          selected = selected.filter(function (value) {\n            return value !== suggestion;\n          });\n        }\n      } else {\n        if (isSingle) {\n          selected = [suggestion];\n          individual.set(rel_uri, selected);\n          fulltextMenu.hide();\n          $(document).off('click', clickOutsideMenuHandler);\n          $(document).off('keydown', arrowHandler);\n        } else {\n          selected.push(suggestion);\n        }\n      }\n      dblTimeout = setTimeout(function () {\n        dblTimeout = undefined;\n      }, 300);\n      fulltext.focus();\n    };\n\n    const dblclickHandler = function (e) {\n      e.preventDefault();\n      if ( !$(e.target).hasClass('selected') ) {\n        clickHandler(e);\n      }\n      dblTimeout = clearTimeout(dblTimeout);\n      individual.set(rel_uri, selected);\n      fulltextMenu.hide();\n      $(document).off('click', clickOutsideMenuHandler);\n      $(document).off('keydown', arrowHandler);\n      fulltext.focus();\n    };\n\n    const clickOutsideMenuHandler = function (e) {\n      if ( !$(e.target).closest(fulltextMenu).length ) {\n        if ( fulltextMenu.is(':visible') ) {\n          individual.set(rel_uri, selected);\n          fulltextMenu.hide();\n          $(document).off('click', clickOutsideMenuHandler);\n          $(document).off('keydown', arrowHandler);\n        }\n      }\n    };\n\n    const arrowHandler = function(e) {\n      if ( e.which === 40 ) { // Down\n        e.preventDefault();\n        const active = suggestions.find('.active').removeClass('active');\n        const next = active.next();\n        if ( next.length ) {\n          next.addClass('active').focus();\n        } else {\n          suggestions.children().first().addClass('active').focus();\n        }\n      } else if ( e.which === 38 ) { // Up\n        e.preventDefault();\n        const active = suggestions.find('.active').removeClass('active');\n        const prev = active.prev();\n        if ( prev.length ) {\n          prev.addClass('active').focus();\n        } else {\n          suggestions.children().last().addClass('active').focus();\n        }\n      } else if ( e.which === 32 && fulltextMenu.find(':focus').length ) { // Space\n        e.preventDefault(); // Prevent scrolling on space\n      }\n    };\n\n    const propertyModifiedHandler = function (value) {\n      if ( isSingle && individual.hasValue(rel_uri) ) {\n        individual.get(rel_uri)[0].load()\n          .then((value) => renderValue(value, template))\n          .then((rendered) => {\n            const value = fulltext.val();\n            if (value != rendered) {\n              fulltext.val(rendered);\n            }\n          });\n      } else {\n        fulltext.val('');\n      }\n    };\n\n    individual.on(rel_uri, propertyModifiedHandler);\n    control.one('remove', function () {\n      individual.off(rel_uri, propertyModifiedHandler);\n    });\n    propertyModifiedHandler();\n\n    // Dropdown feature\n    const dropdown = $('.dropdown', control);\n    if ( this.hasClass('dropdown') && this.hasClass('fulltext') || this.hasClass('full') ) {\n      dropdown.on('click keydown', function (e) {\n        if (e.type !== 'click' && e.which !== 13 && e.which !== 32) {\n          return;\n        }\n        e.preventDefault();\n        e.stopPropagation();\n        const suggestions = $('.suggestions', control);\n        if ( suggestions.is(':empty') ) {\n          performSearch();\n        } else if ( fulltextMenu.is(':visible') ) {\n          fulltextMenu.hide();\n          $(document).off('click', clickOutsideMenuHandler);\n          $(document).off('keydown', arrowHandler);\n        } else {\n          $(document).off('click', clickOutsideMenuHandler);\n          $(document).off('keydown', arrowHandler);\n          fulltextMenu.show();\n          $(document).on('click', clickOutsideMenuHandler);\n          $(document).on('keydown', arrowHandler);\n        }\n      });\n      const downHandler = function (e) {\n        if ( e.which === 40) {\n          e.stopPropagation();\n          dropdown.click();\n        }\n      };\n      fulltext.on('focus', function (e) {\n        fulltext.off('keydown', downHandler).one('keydown', downHandler);\n      });\n    } else {\n      dropdown.remove();\n    }\n  } else {\n    fulltext.remove();\n    fulltextMenu.remove();\n    $('.dropdown', control).remove();\n  }\n\n  // Clear feature\n  if (isSingle && opts.mode !== 'search' && ( this.hasClass('fulltext') || this.hasClass('full') ) ) {\n    $('.clear', control).on('click keydown', function (e) {\n      if (e.type !== 'click' && e.which !== 13 && e.which !== 32) {\n        return;\n      }\n      e.preventDefault();\n      e.stopPropagation();\n      selected = [];\n      $('.suggestions', control).empty();\n      individual.clearValue(rel_uri);\n      fulltext.val('').focus();\n    });\n    this.on('view edit search', function (e) {\n      e.stopPropagation();\n      if (e.type === 'search') {\n        const isSingle = false || $(e.delegateTarget).data('single');\n        if (!isSingle) {\n          $('.clear', control).remove();\n        }\n      }\n    });\n  } else {\n    $('.clear', control).remove();\n  }\n\n  if ( !$('.fulltext', control).length ) {\n    $('.input-group', control).toggleClass('input-group btn-group');\n    $('.input-group-addon', control).toggleClass('input-group-addon btn-default btn-primary');\n  }\n\n  this.on('view edit search', function (e) {\n    e.stopPropagation();\n    if (e.type === 'search') {\n      isSingle = false || $(e.delegateTarget).data('single');\n      const dataDeleted = $(e.delegateTarget).data('deleted');\n      withDeleted = typeof dataDeleted === 'boolean' ? dataDeleted : true;\n    }\n  });\n\n  if (spec && spec.hasValue('v-ui:tooltip')) {\n    control.tooltip({\n      title: spec['v-ui:tooltip'].join(', '),\n      placement: 'top',\n      container: 'body',\n      trigger: 'manual',\n      animation: false,\n    });\n    control.one('remove', function () {\n      control.tooltip('destroy');\n    });\n    $('textarea', control).on('focusin', function () {\n      control.tooltip('show');\n    }).on('focusout change', function () {\n      control.tooltip('hide');\n    });\n  }\n\n  this.append(control);\n  return this;\n};\n$.fn.veda_link.defaults = {\n  template: $('#link-control-template').html(),\n};\n\n/* UTILS */\n\n/**\n * Perform full text search query\n * @param {string} prefix\n * @param {string} input\n * @param {string} sort\n * @param {Boolean} withDeleted\n * @return {Promise}\n */\nfunction ftQuery(prefix, input, sort, withDeleted) {\n  input = input ? input.trim() : '';\n  let queryString = '';\n  if ( input ) {\n    const lines = input.split('\\n').filter(Boolean);\n    const lineQueries = lines.map(function (line) {\n      const special = line && line.indexOf('==') > 0 ? line : false;\n      if (special) {\n        return special;\n      }\n      const words = line.trim().replace(/[-*\\s]+/g, ' ').split(' ');\n      return words.filter(Boolean).map(function (word) {\n        return '\\'*\\' == \\'' + word + '*\\'';\n      }).join(' && ');\n    });\n    queryString = lineQueries.filter(Boolean).join(' || ');\n  }\n  if (prefix) {\n    queryString = queryString ? '(' + prefix + ') && (' + queryString + ')' : '(' + prefix + ')';\n  }\n\n  const result = [];\n\n  return incrementalSearch(0, 100, [])\n    .then(function (results) {\n      if (withDeleted) {\n        queryString = queryString + ' && (\\'v-s:deleted\\' == true )';\n        return incrementalSearch(0, 100, results);\n      } else {\n        return results;\n      }\n    })\n    .then(function (results) {\n      results = veda.Util.unique( results );\n      const getList = results.filter( function (uri, i) {\n        const cached = veda.cache.get(uri);\n        if ( cached ) {\n          result[i] = cached.load();\n          return false;\n        } else {\n          return true;\n        }\n      });\n      if (getList.length) {\n        return veda.Backend.get_individuals({\n          ticket: veda.ticket,\n          uris: getList,\n        });\n      } else {\n        return [];\n      }\n    })\n    .then(function (individuals) {\n      for (let i = 0, j = 0, length = individuals.length; i < length; i++) {\n        while (result[j++]); // Fast forward to empty element\n        result[j-1] = new veda.IndividualModel(individuals[i]).init();\n      }\n      return Promise.all(result);\n    }).then(function (fulfilled) {\n      return fulfilled.filter(Boolean);\n    });\n\n  /**\n   * Perform full text search query incrementally\n   * @param {string} cursor\n   * @param {string} limit\n   * @param {Array} results\n   * @return {Promise}\n   */\n  function incrementalSearch(cursor, limit, results) {\n    return veda.Backend.query({\n      ticket: veda.ticket,\n      query: queryString,\n      sort: sort ? sort : '\\'rdfs:label' + (veda.user.getLanguage()[0] ? '_' + veda.user.getLanguage()[0].toLowerCase() : '') + '\\' asc',\n      from: cursor,\n      top: 10,\n      limit: 1000,\n    }).then(function (queryResult) {\n      results = results.concat(queryResult.result);\n      const cursor = queryResult.cursor;\n      const estimated = queryResult.estimated;\n      if (results.length >= limit || cursor >= estimated) {\n        return results;\n      } else {\n        return incrementalSearch(cursor, limit, results);\n      }\n    });\n  }\n}\n\n/**\n * Render option value\n * @param {IndividualModel|string|number|Boolean|Date} value\n * @return {Promise<string>}\n */\nfunction renderValue(value, template) {\n  if (value instanceof veda.IndividualModel) {\n    return value.load().then(function (value) {\n      if (template) {\n        return interpolate(template, value);\n      } else {\n        return value.toString();\n      }\n    });\n  } else {\n    return Promise.resolve(veda.Util.formatValue(value));\n  }\n}\n\n/**\n * Interpolate string for rendering\n * @param {string} str\n * @return {Promise}\n */\nfunction interpolate (template, individual) {\n  const promises = [];\n  const re_interpolate = /{\\s*(.*?)\\s*}/g;\n  const re_evaluate = /{{\\s*(.*?)\\s*}}/g;\n  template.replace(re_evaluate, (match, group) => {\n    const rendered = eval(group);\n    promises.push(rendered);\n    return '';\n  }).replace(re_interpolate, (match, group) => {\n    const properties = group.split('.');\n    let target = properties.shift();\n    if (target === '@') {\n      target = individual;\n    } else {\n      target = new veda.IndividualModel(target);\n    }\n    const rendered = target.getChainValue(...properties).then(values => values.map(Util.formatValue).filter(Boolean).join(' '));\n    promises.push(rendered);\n    return '';\n  });\n  return Promise.all(promises).then(fulfilled => {\n    return template.replace(re_evaluate, () => fulfilled.shift()).replace(re_interpolate, () => fulfilled.shift());\n  });\n}\n"],"file":"veda_controls.js"}