{"version":3,"sources":["../../../source-web/js/browser/veda_workflow_editor.js"],"names":["collectEntities","element","list","prop","props","Object","getOwnPropertyNames","key","length","Array","isArray","forEach","subelement","hasValue","subRdfType","id","add","$","riot","jsWorkflow","ready","jsPlumb","Instance","instance","getInstance","prototype","init","workflowData","veda","net","template","workflow","elementId","selectedElementId","selectedElementType","selectedElementSourceId","process","canvasSizePx","mode","max_process_depth","dragList","propsHead","container","createWorkflowDOM","holder","text","join","present","empty","append","wdata","css","addClass","attr","appendTo","as_start","ctx","get","getContext","globalAlpha","on","e","shiftKey","offsetX","offsetY","show","end","x1","Math","min","x2","max","y1","y2","hide","state","$state","Util","escape4$","addToDragList","stopPropagation","buttons","clearRect","delegateTarget","offsetWidth","offsetHeight","beginPath","x","y","rect","fill","draggable","drag","event","ui","moveCanvas","position","left","top","defocus","importDefaults","Endpoint","HoverPaintStyle","strokeStyle","lineWidth","ConnectionOverlays","location","width","foldback","label","cssClass","Container","newLeft","newTop","bind","transition","route","flowId","getData","setPaintStyle","component","sourceId","about","IndividualModel","info","originalSourceId","newSourceId","removeSubIndividual","connection","concat","source","flowExists","filter","flow","targetId","addValue","setData","subNetViewButton","executorMark","load","then","executor","updateSVGBackground","item","svgBackground","hasClass","showProcessRunPath","workItem","depth","previousWorkItem","select","target","each","pathCounterLabel","getOverlay","getLabel","removeOverlay","addOverlay","addVarProperty","stateId","mapping","varId","variable","individualM","forSubIndividual","push","addToDragSelection","clearDragList","clearDragSelection","bindStateEvents","windows","find","droppable","hoverClass","drop","taskId","$div","dialog","modal","resizable","trigger","_this","currentElement","alreadySelected","ctrlKey","removeClass","menu","html","i","el","wi","$item","preventDefault","getAllConnections","idx","o","setVisible","$contextMenu","display","pageX","document","pageY","height","showModal","round","pos","makeSource","anchor","dragOptions","isSource","isTarget","connector","stub","gap","paintStyle","fillStyle","radius","connectorStyle","outlineColor","outlineWidth","maxConnections","onMaxConnections","alert","makeTarget","dropOptions","reattach","changeScale","scale","parseFloat","setZoom","getSplitJoinType","sj","type","createState","stateElement","deleteState","detachAllConnections","remove","deleteFlow","createFlow","connect","detachable","detach","fireEvent","forceDetach","sourceIndividual","createEmptyNetElement","individual","createNetView","prefetch","prefetched","netElements","slice","hasInput","hasOutput","optimizeView","minx","maxx","miny","maxy","scaleX","clientWidth","scaleY","clientHeight","loadProcessWorkItems","createProcessView","wis","index","wic","parseInt","red","saveMapping","m","v","save","exportTTL","click","blur","getSelector","confirm","getConnections","clone","zoomIn","zoomOut","originalEvent","wheelDelta"],"mappings":"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","sourcesContent":["/**\n * Net editor. Used to create / modify / view workflow nets.\n *\n * Inspired by [http://github.com/hemantsshetty/jsWorkflow][1]\n *\n * [1]: http://github.com/hemantsshetty/jsWorkflow\n */\n\nimport 'jsplumb';\n\nimport $ from 'jquery';\n\nimport riot from '../common/lib/riot.js';\n\nconst jsWorkflow = {};\n\nexport default jsWorkflow;\n\n// Leveraging the ready function of jsPlumb.\njsWorkflow.ready = jsPlumb.ready;\n\n// No API call should be made until the DOM has been initialized.\njsWorkflow.ready(function() {\n  /**\n   * Create a workflow instance.\n   * @constructor Instance\n   */\n  jsWorkflow.Instance = function() {\n    // Get a new instance of jsPlumb.\n    this.instance = jsPlumb.getInstance();\n  };\n\n  /**\n   * Initialize the workflow instance.\n   * @param {String} workflowData Id of an HTML container within which the worlflow is to be rendered\n   * @param {Object} veda global \"veda\" instance\n   * @param {IndividualModel} net individual of rdfs:type \"v-wf:Net\"\n   * @param {Element} template\n   * @param {Element} container\n   */\n  jsWorkflow.Instance.prototype.init = function(workflowData, veda, net, template, container) {\n    let workflow;\n    const canvasSizePx=10000;\n    let elementId;\n    let selectedElementId;\n    let selectedElementType;\n    let selectedElementSourceId;\n    let process;\n    let mode='view';\n    let max_process_depth=0;\n    let dragList = [];\n    const props = $('#props', template);\n    const propsHead = $('#props-head', template);\n\n    if ( net.hasValue('rdf:type', 'v-wf:Net') ) {\n      mode = 'edit';\n      elementId = net.id;\n    } else if ( net.hasValue('rdf:type', 'v-wf:Process') ) {\n      mode = 'view';\n      process = net;\n      net = net.hasValue('v-wf:instanceOf') ? net['v-wf:instanceOf'][0] : [];\n      elementId = net.id;\n    }\n\n    if (typeof workflowData === 'object') {\n      workflow = workflowData.container;\n      jsWorkflow.Instance.createWorkflowDOM(workflowData);\n    } else {\n      workflow = workflowData;\n    }\n    net['offsetX'] = veda['workflow'+elementId+'-offsetX'];\n    net['offsetY'] = veda['workflow'+elementId+'-offsetY'];\n    net['currentScale'] = veda['workflow'+elementId+'-zoom'];\n    if (net['currentScale']==null) net['currentScale'] = 1.0;\n\n    if (!net['offsetX']) {\n      net['offsetX'] = 0;\n    }\n    if (!net['offsetY']) {\n      net['offsetY'] = 0;\n    }\n\n    if (mode === 'view') {\n      const holder = $('<div>');\n      propsHead.text(net['rdfs:label'].join(', '));\n      process.present(holder, 'v-wf:ProcessPropsTemplate');\n      props.empty().append(holder);\n    }\n\n    const wdata = $('#'+workflowData, template);\n\n    wdata.css({\n      'height': canvasSizePx +'px',\n      'width': canvasSizePx+'px',\n    });\n    $('.workflow-wrapper', template).addClass('calculated-height');\n\n    $('<canvas>').attr({\n      'id': 'select_canvas',\n      'width': canvasSizePx +'px',\n      'height': canvasSizePx+'px',\n    }).appendTo(wdata);\n\n    let as_start = null;\n    const ctx = $('#select_canvas', template).get(0).getContext('2d');\n    ctx.globalAlpha = 0.3;\n\n    wdata.on('mousedown', function(e) {\n      if (e.shiftKey) {\n        as_start = [e.offsetX, e.offsetY];\n        $('#select_canvas', template).show();\n      }\n    }).on('mouseup', function(e) {\n      if (e.shiftKey) {\n        end = [e.offsetX, e.offsetY];\n\n        const x1 = Math.min(as_start[0], end[0]) - canvasSizePx/2;\n        const x2 = Math.max(as_start[0], end[0]) - canvasSizePx/2;\n        const y1 = Math.min(as_start[1], end[1]) - canvasSizePx/2;\n        const y2 = Math.max(as_start[1], end[1]) - canvasSizePx/2;\n        $('#select_canvas', template).hide();\n\n        net['v-wf:consistsOf'].forEach(function(state) {\n          if (state.hasValue('v-wf:locationX') && state.hasValue('v-wf:locationY')) {\n            if (\n              x1 <= state['v-wf:locationX'][0] && state['v-wf:locationX'][0] <= x2 &&\n              y1 <= state['v-wf:locationY'][0] && state['v-wf:locationY'][0] <= y2\n            ) {\n              const $state = $('#' + veda.Util.escape4$(state.id), template);\n              instance.addToDragList($state);\n              e.stopPropagation();\n            }\n          }\n        });\n      }\n    }).on('mousemove', function(e) {\n      if (e.shiftKey && e.buttons == 1) {\n        if (!as_start) {\n          return;\n        }\n\n        ctx.clearRect(0, 0, e.delegateTarget.offsetWidth, e.delegateTarget.offsetHeight);\n        ctx.beginPath();\n\n        const x = e.offsetX;\n        const y = e.offsetY;\n\n        ctx.rect(as_start[0], as_start[1], x - as_start[0], y - as_start[1]);\n        ctx.fill();\n      }\n    });\n    wdata.draggable({\n      drag: function (event, ui) {\n        if (!event.shiftKey) {\n          instance.moveCanvas(ui.position.left, ui.position.top);\n          $('#workflow-context-menu', template).hide();\n        } else {\n          return false;\n        }\n      },\n    }).on('click', function(event) {\n      if (!event.shiftKey) {\n        instance.defocus();\n        let holder;\n        if (mode === 'view') {\n          holder = $('<div>');\n          propsHead.text(net['rdfs:label'].join(', '));\n          process.present(holder, 'v-wf:ProcessPropsTemplate');\n          props.empty().append(holder);\n        }\n        if (mode === 'edit') {\n          holder = $('<div>');\n          propsHead.text(net['rdfs:label'].join(', '));\n          net.present(holder, 'v-wf:SimpleNetTemplate', 'edit');\n          props.empty().append(holder);\n        }\n      }\n    });\n\n    const instance = this.instance;\n\n    // Import all the given defaults into this instance.\n    instance.importDefaults({\n      Endpoint: 'Dot',\n      HoverPaintStyle: {\n        strokeStyle: '#6699FF',\n        lineWidth: 1,\n      },\n      ConnectionOverlays: [\n        ['Arrow', {\n          location: 1,\n          id: 'arrow',\n          length: 14,\n          width: 10,\n          foldback: 0.8,\n        }],\n        ['Label', {\n          label: 'transition',\n          id: 'label',\n          cssClass: 'aLabel',\n        }],\n      ],\n      Container: workflow, // Id of the workflow container.\n    });\n\n    instance.moveCanvas = function (newLeft, newTop) {\n      // DEBUG $('#workflow-net-name', template).text(newLeft+\" / \"+newTop);\n\n      // change scale and offset\n      wdata.css({\n        'left': (newLeft)+'px',\n        'top': (newTop)+'px',\n      });\n      veda['workflow'+elementId+'-offsetX'] = newLeft;\n      veda['workflow'+elementId+'-offsetY'] = newTop;\n      net['offsetX'] = newLeft;\n      net['offsetY'] = newTop;\n    };\n\n    if (net['offsetX']!=null && net['offsetX']!=0) {\n      instance.moveCanvas(net['offsetX'], net['offsetY']);\n    } else {\n      instance.moveCanvas(-canvasSizePx/2, -canvasSizePx/2);\n    }\n\n    // Bind a click listener to each transition (connection). On double click, the transition is deleted.\n    if (mode=='edit') {\n      instance.bind('dblclick', function(transition) {\n        riot.route('#/' + transition.id + '///edit');\n      });\n    }\n\n    // Fill info panel on flow click\n    instance.bind('click', function(transition) {\n      const flowId = transition.getData();\n      veda['workflow'+elementId+'-selectedElement'] = transition.id;\n      instance.defocus();\n\n      transition.setPaintStyle({strokeStyle: '#FF0000'});\n\n      if (transition.id == '__label') {\n        transition = transition.component;\n      }\n\n      selectedElementId = transition.id;\n      selectedElementType = 'flow';\n      selectedElementSourceId = transition.sourceId;\n\n      const about = new veda.IndividualModel(flowId);\n      const holder = $('<div>');\n      about.present(holder);\n      props.append(holder);\n      if ( about.hasValue('rdfs:label') ) propsHead.text(about['rdfs:label'].join(', '));\n      else propsHead.text(about.id);\n    });\n\n    instance.bind('connectionMoved', function(info, originalEvent) {\n      if (info.originalSourceId !== info.newSourceId) {\n        net['v-wf:consistsOf'].forEach(function(state) {\n          if (state.id === info.originalSourceId) {\n            state['v-wf:hasFlow'] = veda.Util.removeSubIndividual(state, 'v-wf:hasFlow', info.connection.id);\n          }\n          if (state.id === info.newSourceId) {\n            state['v-wf:hasFlow'] = state.hasValue('v-wf:hasFlow') ? state['v-wf:hasFlow'].concat(new veda.IndividualModel(info.connection.id)):[new veda.IndividualModel(info.connection.id)];\n          }\n        });\n      }\n    });\n\n    // Handle creating new flow event\n    instance.bind('connection', function(info) {\n      const source = new veda.IndividualModel(info.sourceId);\n      const flowExists = source.get('v-wf:hasFlow').filter(function(flow) {\n        return flow.hasValue('v-wf:flowsInto', info.targetId);\n      }).length;\n      if (flowExists) {\n        return;\n      }\n\n      const flow = new veda.IndividualModel(); // Create Flow individual\n      flow['rdf:type'] = 'v-wf:Flow';\n      flow['v-wf:flowsInto'] = info.targetId; // Set Flow target\n      net.addValue('v-wf:consistsOf', flow); // Add new Flow to Net\n      source.addValue('v-wf:hasFlow', flow); // Add new Flow to source\n      info.connection.setData(flow.id);\n    });\n\n    const subNetViewButton = function(state, $state) {\n      if (!state.hasValue('v-wf:subNet')) {\n        return;\n      }\n      $('<span/>', {\n        'click': (function (instance) {\n          riot.route('#/'+state['v-wf:subNet'][0].id+'///edit');\n        }),\n        'class': 'glyphicon glyphicon-search subnet-link',\n      }).appendTo($state);\n    };\n\n    const executorMark = function(state, $state) {\n      if (!state.hasValue('v-wf:executor')) {\n        return;\n      }\n      state['v-wf:executor'][0].load().then(function(executor) {\n        if (executor['rdf:type'][0].id == 'v-s:Appointment') {\n          $('<span/>', {\n            'class': 'glyphicon glyphicon-user',\n          }).appendTo($state);\n        } else {\n          $('<span/>', {\n            'class': 'glyphicon glyphicon-cog',\n          }).appendTo($state);\n        }\n      });\n    };\n\n    instance.updateSVGBackground = function(item) {\n      let svgBackground = '';\n      if (item.hasClass('split-and')) {\n        svgBackground += '<line x1=\\'80\\' y1=\\'25\\' x2=\\'100\\' y2=\\'0\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'80\\' y1=\\'0\\' x2=\\'80\\' y2=\\'50\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'80\\' y1=\\'25\\' x2=\\'100\\' y2=\\'50\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' />';\n      }\n      if (item.hasClass('split-or')) {\n        svgBackground += '<line x1=\\'100\\' y1=\\'25\\' x2=\\'90\\' y2=\\'0\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'90\\' y1=\\'0\\' x2=\\'80\\' y2=\\'25\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'80\\' y1=\\'0\\' x2=\\'80\\' y2=\\'50\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'100\\' y1=\\'25\\' x2=\\'90\\' y2=\\'50\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'90\\' y1=\\'50\\' x2=\\'80\\' y2=\\'25\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' />';\n      }\n      if (item.hasClass('split-xor')) {\n        svgBackground += '<line x1=\\'100\\' y1=\\'25\\' x2=\\'80\\' y2=\\'0\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'80\\' y1=\\'0\\' x2=\\'80\\' y2=\\'50\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'100\\' y1=\\'25\\' x2=\\'80\\' y2=\\'50\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' />';\n      }\n      if (item.hasClass('join-and')) {\n        svgBackground += '<line x1=\\'20\\' y1=\\'25\\' x2=\\'0\\' y2=\\'0\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'20\\' y1=\\'0\\' x2=\\'20\\' y2=\\'50\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'20\\' y1=\\'25\\' x2=\\'0\\' y2=\\'50\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' />';\n      }\n      if (item.hasClass('join-or')) {\n        svgBackground += '<line x1=\\'0\\' y1=\\'25\\' x2=\\'10\\' y2=\\'0\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'10\\' y1=\\'0\\' x2=\\'20\\' y2=\\'25\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'20\\' y1=\\'0\\' x2=\\'20\\' y2=\\'50\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'0\\' y1=\\'25\\' x2=\\'10\\' y2=\\'50\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'10\\' y1=\\'50\\' x2=\\'20\\' y2=\\'25\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' />';\n      }\n      if (item.hasClass('join-xor')) {\n        svgBackground += '<line x1=\\'0\\' y1=\\'25\\' x2=\\'20\\' y2=\\'0\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'20\\' y1=\\'0\\' x2=\\'20\\' y2=\\'50\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' /><line x1=\\'0\\' y1=\\'25\\' x2=\\'20\\' y2=\\'50\\' style=\\'stroke:rgb(0,0,0); stroke-width:1\\' />';\n      }\n      svgBackground = 'url(\"data:image/svg+xml;utf8,<svg xmlns=\\'http://www.w3.org/2000/svg\\' version=\\'1.1\\' preserveAspectRatio=\\'none\\' viewBox=\\'0 0 100 50\\'>' + svgBackground + '</svg>\")';\n      item.css('background', svgBackground);\n    };\n\n    instance.showProcessRunPath = function(workItem, depth) {\n      if (workItem.hasValue('v-wf:previousWorkItem')) {\n        workItem['v-wf:previousWorkItem'].forEach(function(previousWorkItem) {\n          if (workItem.hasValue('v-wf:forNetElement') && previousWorkItem.hasValue('v-wf:forNetElement')) {\n            instance.showProcessRunPath(previousWorkItem, depth+1);\n            instance.select({target: workItem['v-wf:forNetElement'][0].id, source: previousWorkItem['v-wf:forNetElement'][0].id}).each(function(e) {\n              e.addClass('process-path-highlight');\n              const pathCounterLabel = (e.getOverlay('pathCounter')!=undefined)?e.getOverlay('pathCounter').getLabel():'';\n              e.removeOverlay('pathCounter');\n              e.addOverlay(['Label', {label: ((pathCounterLabel!='')?pathCounterLabel+',':'')+(max_process_depth-depth), location: 0.5, id: 'pathCounter', cssClass: 'pathCounterLabel'}]);\n            });\n          }\n        });\n      } else {\n        max_process_depth = depth;\n      }\n    };\n\n    instance.addVarProperty = function(stateId, mapping, varId) {\n      const variable = new veda.IndividualModel(varId);\n\n      const individualM = new veda.IndividualModel(); // create individual (Mapping)\n\n      individualM['rdf:type'] = [new veda.IndividualModel('v-wf:Mapping')];\n      individualM['v-wf:mapToVariable'] = [variable];\n      individualM['v-wf:mappingExpression'] = ['process.getInputVariable (\\''+variable['v-wf:varDefineName'][0]+'\\')'];\n\n      veda.Util.forSubIndividual(net, 'v-wf:consistsOf', stateId, function (state) {\n        state[mapping] = state[mapping].concat(individualM); // <- Add new Mapping to State\n        net['v-wf:consistsOf'] = net['v-wf:consistsOf'].concat(individualM);\n      });\n    };\n\n    instance.addToDragList = function(element) {\n      dragList.push(element);\n      element.addClass('jsplumb-drag-selected');\n      instance.addToDragSelection(element);\n    };\n\n    instance.clearDragList = function() {\n      dragList = [];\n      instance.clearDragSelection();\n    };\n\n    /**\n     * Bind required functional to State elements\n     * @method bindStateEvents\n     * @param {Object} windows List of all State elements\n     */\n    const bindStateEvents = function(windows) {\n      windows.find('.state-name').droppable({\n        hoverClass: 'dragHover',\n        drop: function( event, ui ) {\n          const varId = ui.draggable.attr('resource');\n          const taskId = windows.attr('id');\n          const $div = $('<div />');\n          $div.appendTo($('#main'));\n          $div.dialog({\n            modal: true,\n            resizable: false,\n            buttons: {\n              'v-wf:startingMapping': function() {\n                instance.addVarProperty(taskId, 'v-wf:startingMapping', varId);\n                $(this).dialog('close');\n                $('#'+veda.Util.escape4$(taskId), template).trigger('click');\n              },\n              'v-wf:completedMapping': function() {\n                instance.addVarProperty(taskId, 'v-wf:completedMapping', varId);\n                $(this).dialog('close');\n                $('#'+veda.Util.escape4$(taskId), template).trigger('click');\n              },\n              'v-wf:wosResultsMapping': function() {\n                instance.addVarProperty(taskId, 'v-wf:wosResultsMapping', varId);\n                $(this).dialog('close');\n                $('#'+veda.Util.escape4$(taskId), template).trigger('click');\n              },\n              'v-wf:startingJournalMap': function() {\n                instance.addVarProperty(taskId, 'v-wf:startingJournalMap', varId);\n                $(this).dialog('close');\n                $('#'+veda.Util.escape4$(taskId), template).trigger('click');\n              },\n              'v-wf:completedJournalMap': function() {\n                instance.addVarProperty(taskId, 'v-wf:completedJournalMap', varId);\n                $(this).dialog('close');\n                $('#'+veda.Util.escape4$(taskId), template).trigger('click');\n              },\n              'v-wf:startingExecutorJournalMap': function() {\n                instance.addVarProperty(taskId, 'v-wf:startingExecutorJournalMap', varId);\n                $(this).dialog('close');\n                $('#'+veda.Util.escape4$(taskId), template).trigger('click');\n              },\n              'v-wf:completedExecutorJournalMap': function() {\n                instance.addVarProperty(taskId, 'v-wf:completedExecutorJournalMap', varId);\n                $(this).dialog('close');\n                $('#'+veda.Util.escape4$(taskId), template).trigger('click');\n              },\n            },\n          });\n        },\n      });\n\n      windows.on('click', function(e) {\n        const _this = e.delegateTarget;\n        const currentElement = $(_this);\n        const alreadySelected = currentElement.hasClass('w_active');\n        veda['workflow'+elementId+'-selectedElement'] = _this.id;\n        if (e.ctrlKey) {\n          instance.addToDragList(currentElement);\n          e.stopPropagation();\n          return;\n        }\n\n        if (!alreadySelected) {\n          instance.defocus();\n\n          selectedElementId = _this.id;\n          selectedElementType = 'state';\n          currentElement.addClass('w_active');\n        }\n\n        if (mode=='edit') {\n          e.stopPropagation();\n          if (alreadySelected) {\n            return; // do nothing when click on already selected element\n          }\n\n          const about = new veda.IndividualModel(_this.id);\n          const holder = $('<div>');\n          if (about['rdf:type'][0].id == 'v-wf:Task') {\n            about.present(holder, 'v-wf:TaskTemplateAsProperties', 'edit');\n          } else {\n            about.present(holder, 'v-wf:ConditionTemplateAsProperties', 'edit');\n          }\n          props.append(holder);\n          if ( about.hasValue('rdfs:label') ) propsHead.text(about['rdfs:label'].join(', '));\n          else propsHead.text(about.id);\n        }\n\n\n        // build run path\n        if (mode == 'view') {\n          instance.select().removeClass('process-path-highlight').removeOverlay('pathCounter');\n          const about = new veda.IndividualModel(_this.id);\n          if ( about.hasValue('rdfs:label') ) {\n            propsHead.text(about['rdfs:label'].join(', '));\n          } else {\n            propsHead.text(about.id);\n          }\n\n          // If we have more then one WorkItem - we must choose among them\n          if (currentElement.attr('work-items-count')>1) {\n            e.stopPropagation();\n            const menu = $('#workflow-context-menu ul', template);\n            menu.html('');\n\n            $('[type=\\'work-item\\']', _this).each(function(i, el) {\n              const wi = new veda.IndividualModel($(el).attr('work-item-id'));\n              const $item = $('<li/>').appendTo(menu);\n              $('<a/>', {\n                'text': (wi.hasValue('rdfs:label')?wi['rdfs:label'][0]:wi.id),\n                'href': '#',\n                'click': (function (wi) {\n                  return function (event) {\n                    event.preventDefault();\n                    props.empty();\n                    $('#workflow-context-menu', template).hide();\n                    $.each(instance.getAllConnections(), function (idx, connection) {\n                      const o = connection.getOverlay('flowLabel');\n                      if (o != undefined) o.setVisible(false);\n                    });\n                    instance.showProcessRunPath(wi, 0);\n                    const holder = $('<div>');\n                    wi.present(holder, 'v-wf:WorkItemTemplate');\n                    props.append(holder);\n                  };\n                })(wi),\n              }).appendTo($item);\n            });\n            $contextMenu.css({\n              display: 'block',\n              left: e.pageX-((e.pageX+$contextMenu.width()>$( document ).width())?$contextMenu.width():0),\n              top: e.pageY-((e.pageY+$contextMenu.height()>$( document ).height())?$contextMenu.height():0),\n            });\n          } else {\n            e.stopPropagation();\n            if (alreadySelected) {\n              return; // do nothing when click on already selected element\n            }\n            $('[type=\\'work-item\\']', _this).each(function(i, el) {\n              const wi = new veda.IndividualModel($(el).attr('work-item-id'));\n              $.each(instance.getAllConnections(), function (idx, connection) {\n                const o = connection.getOverlay('flowLabel');\n                if (o != undefined) o.setVisible(false);\n              });\n              instance.showProcessRunPath(wi, 0);\n              const holder = $('<div>');\n              wi.present(holder, new veda.IndividualModel('v-wf:WorkItemTemplate'));\n              props.append(holder);\n            });\n          }\n        }\n      });\n\n      if (mode=='edit') {\n        windows.bind('dblclick', function(e) {\n          const _this = e.delegateTarget;\n          veda.Util.showModal(new veda.IndividualModel($(_this).attr('id')), 'v-wf:TaskTemplateAsModal', 'edit');\n        });\n\n        instance.draggable(windows, {\n          drag: function (event) { // gets called on every drag\n            $('#workflow-context-menu', template).hide();\n            const target = new veda.IndividualModel(event.el.id);\n            target['v-wf:locationX'] = [Math.round(event.pos[0]-canvasSizePx/2)];\n            target['v-wf:locationY'] = [Math.round(event.pos[1]-canvasSizePx/2)];\n          },\n        });\n      }\n\n      // Initialize all State elements as Connection sources.\n      const possibleInAnchors = [\n        [0, 0.1, -1, 0],\n        [0, 0.3, -1, 0],\n        [0, 0.5, -1, 0],\n        [0, 0.7, -1, 0],\n        [0, 0.9, -1, 0],\n        [1, 0.1, 1, 0],\n        [1, 0.3, 1, 0],\n        [1, 0.5, 1, 0],\n        [1, 0.7, 1, 0],\n        [1, 0.9, 1, 0],\n        [0.1, 0, 0, -1],\n        [0.3, 0, 0, -1],\n        [0.5, 0, 0, -1],\n        [0.7, 0, 0, -1],\n        [0.9, 0, 0, -1],\n      ];\n      const possibleOutAnchors = [\n        [0, 0.2, -1, 0],\n        [0, 0.4, -1, 0],\n        [0, 0.6, -1, 0],\n        [0, 0.8, -1, 0],\n        [1, 0.2, 1, 0],\n        [1, 0.4, 1, 0],\n        [1, 0.6, 1, 0],\n        [1, 0.8, 1, 0],\n        [0.2, 0, 0, -1],\n        [0.4, 0, 0, -1],\n        [0.6, 0, 0, -1],\n        [0.8, 0, 0, -1],\n      ];\n      instance.makeSource(windows, {\n        filter: '.ep',\n        anchor: possibleOutAnchors,\n        dragOptions: {\n          isSource: false,\n          isTarget: true,\n        },\n        connector: [\n          'Straight', {\n            stub: 30,\n            gap: 0,\n          },\n        ],\n        paintStyle: {\n          strokeStyle: '#225588',\n          fillStyle: 'transparent',\n          radius: mode=='edit'?4:1,\n          lineWidth: 1,\n        },\n        connectorStyle: {\n          strokeStyle: '#666666',\n          lineWidth: 1,\n          outlineColor: 'transparent',\n          outlineWidth: 4,\n        },\n        maxConnections: 20,\n        onMaxConnections: function(info, e) {\n          alert('Maximum connections (' + info.maxConnections + ') reached');\n        },\n      });\n\n      // Initialize all State elements as connection targets.\n\n      instance.makeTarget(windows, {\n        dropOptions: {\n          isSource: true,\n          isTarget: false,\n          hoverClass: 'dragHover',\n        },\n        reattach: true,\n        anchor: possibleInAnchors,\n        paintStyle: {\n          strokeStyle: '#225588',\n          fillStyle: 'transparent',\n          radius: mode=='edit'?4:1,\n          lineWidth: 1,\n        },\n      });\n    };\n\n    /**\n     * Change current scale.\n     * @param {number} scale new scale\n     */\n    instance.changeScale = function(scale) {\n      $('#workflow-context-menu', template).hide();\n\n      net['currentScale'] = parseFloat(scale);\n      veda['workflow'+elementId+'-zoom'] = net['currentScale'];\n\n      instance.setZoom(net['currentScale']);\n      wdata.css({\n        '-ms-transform': 'scale('+net['currentScale']+','+net['currentScale']+')', /* IE 9 */\n        '-webkit-transform': 'scale('+net['currentScale']+','+net['currentScale']+')', /* Chrome, Safari, Opera */\n        'transform': 'scale('+net['currentScale']+','+net['currentScale']+')',\n      });\n    };\n\n    /**\n     * Generate css class for state (split-[xor-or-and-none] or join-[xor-or-and-none])\n     * @param {String} sj `split` or `join`\n     * @param {veda.IndividualModel} state state\n     * @return {string} css class name for this type of split/join\n     */\n    instance.getSplitJoinType = function(sj, state) {\n      if (!state.hasValue('v-wf:'+sj)) {\n        return ' '+sj+'-no';\n      }\n      const type = state['v-wf:'+sj][0].id;\n      if (type === null || type === undefined || type === '') {\n        return ' '+sj+'-no';\n      }\n\n      if (type == 'v-wf:XOR') return ' '+sj+'-xor';\n      if (type == 'v-wf:OR') return ' '+sj+'-or';\n      if (type == 'v-wf:AND') return ' '+sj+'-and';\n      if (type == 'v-wf:NONE') return ' '+sj+'-none';\n\n      return ' '+sj+'-no';\n    };\n\n    /**\n     * Apply state to canvas\n     * @param {IndividualModel} state\n     */\n    instance.createState = function(state) {\n      if (!state.hasValue('rdf:type')) return;\n      const type = state['rdf:type'][0].id;\n      let stateElement = '';\n      switch (type) {\n      case 'v-wf:InputCondition':\n        stateElement = '<div class=\"w state-io-condition state-io-condition-input\" ' +\n            'id=\"' + state.id + '\" ' +\n            'style=\"font-size:20px;padding-top:10px;'+\n            'left:' + (canvasSizePx/2+state['v-wf:locationX'][0]) + 'px;' +\n            'top:' + (canvasSizePx/2+state['v-wf:locationY'][0]) + 'px;\">' +\n            '<div><span class=\"glyphicon glyphicon-play\" aria-hidden=\"true\"></div>' +\n            (mode=='edit'?'<div class=\"ep\">':'')+'</div></div>';\n        break;\n      case 'v-wf:OutputCondition':\n        stateElement = '<div class=\"w state-io-condition state-io-condition-output\" ' +\n            'id=\"' + state.id + '\" ' +\n            'style=\"font-size:20px;padding-top:10px;' +\n            'left:' + (canvasSizePx/2+state['v-wf:locationX'][0]) + 'px;' +\n            'top: ' + (canvasSizePx/2+state['v-wf:locationY'][0]) + 'px;\">' +\n            '<div><span class=\"glyphicon glyphicon-stop\" aria-hidden=\"true\"></div></div>';\n        break;\n      case 'v-wf:Condition':\n        stateElement = '<div class=\"w state-condition\" ' +\n            'id=\"' + state.id + '\" ' +\n            'style=\"left:' + (canvasSizePx/2+state['v-wf:locationX'][0]) + 'px;' +\n            'top:' + (canvasSizePx/2+state['v-wf:locationY'][0]) + 'px;\">' +\n            '<div class=\"state-name condition-name\">' + state['rdfs:label'][0] + '</div>' +\n            (mode=='edit'?'<div class=\"ep\">':'')+'</div></div>';\n        break;\n      case 'v-wf:Task':\n        stateElement = '<div class=\"w state-task split-join ' +\n            instance.getSplitJoinType('split', state) +\n            instance.getSplitJoinType('join', state) + '\" '+\n            'id=\"' + state.id + '\" ' +\n            'style=\"left:' + (canvasSizePx/2+state['v-wf:locationX'][0]) + 'px; ' +\n            'top: ' + (canvasSizePx/2+state['v-wf:locationY'][0]) + 'px;\">' +\n            '<div class=\"state-name\">' + state['rdfs:label'][0] + '</div>' +\n            (mode=='edit'?'<div class=\"ep\">':'')+'</div></div>';\n        break;\n      }\n      if (stateElement!=='') {\n        wdata.append(stateElement);\n        const $state = $('#' + veda.Util.escape4$(state.id), template);\n        bindStateEvents($state);\n        if (mode=='edit') subNetViewButton(state, $state);\n        executorMark(state, $state);\n        instance.updateSVGBackground($state);\n      }\n    };\n\n    instance.deleteState = function(element) {\n      instance.detachAllConnections(element);\n      instance.remove(element);\n      net['v-wf:consistsOf'] = veda.Util.removeSubIndividual(net, 'v-wf:consistsOf', element.id);\n      net['v-wf:consistsOf'].forEach(function(state) {\n        if (state.hasValue('v-wf:hasFlow')) {\n          state['v-wf:hasFlow'].forEach(function(flow) {\n            if (flow.hasValue('v-wf:flowsInto') && flow['v-wf:flowsInto'][0].id == element.id) {\n              instance.deleteFlow(flow, state);\n            }\n          });\n        }\n      });\n    };\n\n    instance.createFlow = function(state, flow) {\n      const connector = instance.connect({\n        source: state.id,\n        target: flow['v-wf:flowsInto'][0].id,\n        detachable: (mode=='edit'),\n      });\n      if (flow.hasValue('rdfs:label')) {\n        connector.addOverlay(['Label', {label: flow['rdfs:label'][0], location: 0.5, id: 'flowLabel'}]);\n      }\n      connector.setData(flow.id);\n    };\n\n    instance.deleteFlow = function(flow, source) {\n      instance.detach(flow, {fireEvent: false, forceDetach: true});\n      net['v-wf:consistsOf'] = veda.Util.removeSubIndividual(net, 'v-wf:consistsOf', flow.id);\n      const sourceIndividual = new veda.IndividualModel(source.id);\n      sourceIndividual['v-wf:hasFlow'] = veda.Util.removeSubIndividual(sourceIndividual, 'v-wf:hasFlow', flow.id);\n    };\n\n    instance.createEmptyNetElement = function(type) {\n      const individual = new veda.IndividualModel();\n\n      individual['rdfs:label'] = ['', ''];\n      individual['v-wf:locationX'] = [(-canvasSizePx/2-net['offsetX'])/net['currentScale']];\n      individual['v-wf:locationY'] = [(-canvasSizePx/2-net['offsetY'])/net['currentScale']];\n\n      if (type=='condition') {\n        individual['rdf:type'] = [new veda.IndividualModel('v-wf:Condition')];\n        instance.createState(individual);\n      } else if (type=='task') {\n        individual['rdf:type'] = [new veda.IndividualModel('v-wf:Task')];\n        instance.createState(individual);\n      } else if (type=='input') {\n        individual['rdf:type'] = [new veda.IndividualModel('v-wf:InputCondition')];\n        instance.createState(individual);\n      } else if (type=='output') {\n        individual['v-wf:locationX'] = [individual['v-wf:locationX'][0]+200];\n        individual['rdf:type'] = [new veda.IndividualModel('v-wf:OutputCondition')];\n        instance.createState(individual);\n      }\n      net['v-wf:consistsOf'] = net['v-wf:consistsOf'] === undefined ? [individual] : net['v-wf:consistsOf'].concat(individual);\n      return individual;\n    };\n\n    /**\n     * Create workflow Net by given Object (v-wf:Net individual).\n     * @param {IndividualModel} net\n     * @return {IndividualModel} net\n     */\n    instance.createNetView = function(net) {\n      return net.prefetch(Infinity, 'v-wf:consistsOf', 'v-wf:hasFlow', 'v-wf:executor').then(function (prefetched) {\n        net = prefetched[0];\n        $('#workflow-net-name', template).text(net['rdfs:label'][0]);\n        const netElements = prefetched.slice(1);\n        // Create states\n        let hasInput = false;\n        let hasOutput = false;\n        netElements.forEach(function (element) {\n          if ( element.hasValue('rdf:type', 'v-wf:Task') || element.hasValue('rdf:type', 'v-wf:Condition') || element.hasValue('rdf:type', 'v-wf:InputCondition') || element.hasValue('rdf:type', 'v-wf:OutputCondition') ) {\n            instance.createState(element);\n          }\n          hasInput = hasInput || element.hasValue('rdf:type', 'v-wf:InputCondition');\n          hasOutput = hasOutput || element.hasValue('rdf:type', 'v-wf:OutputCondition');\n        });\n        // For empty net\n        if (!hasInput) {\n          instance.createEmptyNetElement('input');\n        }\n        if (!hasOutput) {\n          instance.createEmptyNetElement('output');\n        }\n        netElements.forEach(function (element) {\n          if ( element.hasValue('v-wf:hasFlow') ) {\n            element['v-wf:hasFlow'].forEach(function (flow) {\n              instance.createFlow(element, flow);\n            });\n          }\n        });\n        return net;\n      });\n    };\n\n    /*\n     * Optimize view of net: all elements must be visible and fit screen (through change scale and position of canvas)\n     * @returns\n     */\n    instance.optimizeView = function() {\n      if (!net.hasValue('v-wf:consistsOf')) return;\n      let minx; let maxx; let miny; let maxy; let scale;\n      let offsetX = 0; let offsetY = 0;\n      // read ranges\n      net['v-wf:consistsOf'].forEach(function(state) {\n        if (state.hasValue('v-wf:locationX')) {\n          if (maxx === undefined || state['v-wf:locationX'][0]>maxx) maxx = state['v-wf:locationX'][0];\n          if (minx === undefined || state['v-wf:locationX'][0]<minx) minx = state['v-wf:locationX'][0];\n        }\n        if (state.hasValue('v-wf:locationY')) {\n          if (maxy === undefined || state['v-wf:locationY'][0]>maxy) maxy = state['v-wf:locationY'][0];\n          if (miny === undefined || state['v-wf:locationY'][0]<miny) miny = state['v-wf:locationY'][0];\n        }\n      });\n\n      // TODO update this from css;\n      miny-=25;\n      minx-=25;\n      maxx+=100;\n      maxy+=100;\n\n\n      // read viewport div\n      $('.workflow-canvas-wrapper', template).each(function(i, el) {\n        const scaleX = el.clientWidth/(maxx-minx);\n        const scaleY = el.clientHeight/(maxy-miny);\n        scale = Math.min(scaleX, scaleY);\n        if (scaleX>scaleY) {\n          offsetX = (el.clientWidth - (maxx-minx)*scale) /2;\n        } else {\n          offsetY = (el.clientHeight - (maxy-miny)*scale) /2;\n        }\n      });\n      instance.changeScale(scale);\n      instance.moveCanvas(-minx*scale+offsetX-canvasSizePx/2, -miny*scale+offsetY-canvasSizePx/2);\n    };\n\n    instance.defocus = function() {\n      props.empty();\n      instance.clearDragList();\n      $('.jsplumb-drag-selected', template).removeClass('jsplumb-drag-selected');\n      $('#workflow-context-menu', template).hide();\n      $.each(instance.getAllConnections(), function (idx, connection) {\n        connection.removeClass('process-path-highlight');\n        connection.removeOverlay('pathCounter');\n        const o = connection.getOverlay('flowLabel');\n        if (o != undefined) o.setVisible(true);\n      });\n      $('#'+veda.Util.escape4$(selectedElementId), template).removeClass('w_active');\n      if (selectedElementSourceId!=null) {\n        instance.select({source: selectedElementSourceId}).each(function(e) {\n          e.setPaintStyle({strokeStyle: '#666666'});\n          e.removeOverlay('connLabel');\n        });\n      }\n      selectedElementId = null;\n      selectedElementType = null;\n      selectedElementSourceId = null;\n    };\n\n    instance.loadProcessWorkItems = function(process) {\n      return process.prefetch(Infinity, 'v-wf:workItemList');\n    };\n\n    instance.createProcessView = function(process) {\n      // Apply WorkItems to Net\n      instance.loadProcessWorkItems(process).then(function (wis) {\n        wis = wis.slice(1);\n        $('.w', template).each(function(index, el) {\n          $('span', el).text('');\n          $( el ).css('background-color', 'white').attr('work-items-count', 0).attr('colored-to', '');\n        });\n\n        wis.forEach(function(wi) {\n          if (wi.hasValue('v-wf:forNetElement')) {\n            const state = $('#'+veda.Util.escape4$(wi['v-wf:forNetElement'][0].id), template);\n            if ($(state).find('[work-item-id=\"'+veda.Util.escape4$(wi.id)+'\"]').length == 0) {\n              $('<span/>', {\n                'type': 'work-item',\n                'work-item-id': wi.id,\n              }).appendTo(state);\n            }\n            const wic = parseInt(state.attr('work-items-count'));\n            const red = state.attr('colored-to')=='red';\n            if (wic>0) {\n              state.attr('work-items-count', wic+1);\n              $('.counter', state).remove();\n              $('<span/>', {\n                'class': 'counter',\n                'text': 'x'+(wic+1),\n              }).appendTo(state);\n            } else {\n              state.attr('work-items-count', 1);\n            }\n            if (!wi.hasValue('v-wf:workOrderList')) {\n              state.css('background-color', '#FF3333');\n              state.attr('colored-to', 'red');\n            } else if (wi.hasValue('v-wf:isCompleted') && wi['v-wf:isCompleted'][0]==true && !red) {\n              state.css('background-color', '#88B288');\n              state.attr('colored-to', 'green');\n            } else if (!red) {\n              state.css('background-color', '#FFB266');\n              state.attr('colored-to', 'red');\n            }\n          }\n        });\n      });\n    };\n    let $contextMenu;\n    instance.createNetView(net).then(function (net) {\n      if (net['currentScale']==1.0) {\n        instance.optimizeView();\n      } else {\n        instance.changeScale(net['currentScale']);\n      }\n\n      if (mode=='view') {\n        instance.createProcessView(process);\n      }\n\n      $('#'+veda.Util.escape4$(veda['workflow'+elementId+'-selectedElement']), template).trigger('click');\n\n      /* CONTEXT MENU [BEGIN] */\n      $contextMenu = $('#workflow-context-menu', template);\n      /* CONTEXT MENU [END]*/\n\n      /* NET MENU [BEGIN] */\n      $('#workflow-save-button', template).on('click', function() {\n        // TODO REFACTOR - recursive save (based on type checking)\n        if (net.hasValue('v-wf:consistsOf')) {\n          net['v-wf:consistsOf'].forEach(function(el) {\n            const saveMapping = function (mapping, el) {\n              if (el.hasValue(mapping)) {\n                el[mapping].forEach(function(m) {\n                  if (m.hasValue('v-wf:mapToVariable')) {\n                    m['v-wf:mapToVariable'].forEach(function(v) {\n                      v.save();\n                    });\n                  }\n                  m.save();\n                });\n              }\n            };\n            saveMapping('v-wf:startingMapping', el);\n            saveMapping('v-wf:completedMapping', el);\n            saveMapping('v-wf:startingExecutorJournalMap', el);\n            saveMapping('v-wf:completedExecutorJournalMap', el);\n            saveMapping('v-wf:startingJournalMap', el);\n            saveMapping('v-wf:completedJournalMap', el);\n            if (el.hasValue('v-wf:executor')) {\n              el['v-wf:executor'].forEach(function(e) {\n                e.save();\n              });\n            }\n            el.save();\n          });\n        }\n        net.save();\n      });\n\n      $('#workflow-export-ttl', template).on('click', function() {\n        const list = [net].concat(net['v-wf:consistsOf']);\n        collectEntities(net, list);\n        veda.Util.exportTTL(list);\n      });\n\n      // Add new State event.\n      $('.create-state', template).bind('click', function(e) {\n        const _this = e.delegateTarget;\n        const individual = instance.createEmptyNetElement($(_this).hasClass('create-condition') ? 'condition' : 'task');\n        $('#' + veda.Util.escape4$(individual.id), template).click();\n        $(_this).blur();\n      });\n\n      $('.delete-state', template).on('click', function() {\n        if (dragList.length > 0) {\n          dragList.forEach(function(item) {\n            instance.deleteState(instance.getSelector('#'+veda.Util.escape4$(item.attr('id')))[0]);\n          });\n        } else if (selectedElementType == 'state') {\n          if (confirm('Delete state ' + selectedElementId + ' ?')) {\n            instance.deleteState(instance.getSelector('#'+veda.Util.escape4$(selectedElementId))[0]);\n          }\n        } else if (selectedElementType == 'flow') {\n          if (confirm('Delete flow ' + selectedElementId + ' ?')) {\n            instance.getConnections({\n              source: selectedElementSourceId,\n            }).forEach(function(connection) {\n              if (connection.id == selectedElementId) {\n                instance.deleteFlow(connection, new veda.IndividualModel(selectedElementSourceId));\n              }\n            });\n          }\n        }\n      });\n\n      $('.process-refresh', template).on('click', function() {\n        instance.createProcessView(process);\n      });\n\n      $('.to-net-editor', template).on('click', function() {\n        riot.route('#/' + net.id + '///edit');\n      });\n\n      $('.copy-net-element', template).on('click', function() {\n        if (typeof selectedElementId !== 'undefined') {\n          const individual = new veda.IndividualModel(selectedElementId);\n          if (individual.hasValue('rdf:type')) {\n            if (individual['rdf:type'][0].id === 'v-wf:Task' || individual['rdf:type'][0].id === 'v-wf:Condition') {\n              individual.clone().then(function (clone) {\n                clone['v-wf:locationX'] = [individual['v-wf:locationX'][0] + 50];\n                clone['v-wf:locationY'] = [individual['v-wf:locationY'][0] + 50];\n                clone['v-wf:hasFlow'] = [];\n                instance.createState(clone);\n                net['v-wf:consistsOf'] = net['v-wf:consistsOf'].concat(clone);\n              });\n            }\n          }\n        }\n      });\n\n      /* ZOOM [BEGIN] */\n      const zoomIn = function () {\n        if (net['currentScale']<1) {\n          return instance.changeScale(net['currentScale'] + 0.1);\n        }\n        if (net['currentScale']<2) {\n          return instance.changeScale(net['currentScale'] + 0.25);\n        }\n      };\n      const zoomOut = function () {\n        if (net['currentScale']>1) {\n          return instance.changeScale(net['currentScale'] - 0.25);\n        }\n        if (net['currentScale']>0.2) {\n          return instance.changeScale(net['currentScale'] - 0.1);\n        }\n      };\n\n      $('.zoom-in', template).on('click', zoomIn);\n      $('.zoom-out', template).on('click', zoomOut);\n      wdata.bind('mousewheel', function(e) {\n        if ( e.originalEvent.wheelDelta > 0 ) {\n          zoomIn();\n        } else {\n          zoomOut();\n        }\n      });\n\n      $('.zoom-default', template).on('click', function() {\n        instance.optimizeView();\n      });\n\n      $('#full-width', template).on('click', function() {\n        instance.optimizeView();\n      });\n      /* ZOOM [END] */\n\n      /* NET MENU [END] */\n\n      return instance;\n    });\n  };\n});\n\n/**\n * Collect entities\n * @param {Object} element\n * @param {Object} list\n */\nfunction collectEntities(element, list) {\n  const props = Object.getOwnPropertyNames(element);\n  for (let key = 0; key < props.length; key++) {\n    const prop = props[key];\n    if (element[prop] && Array.isArray(element[prop])) {\n      element[prop].forEach(function(subelement) {\n        if (typeof subelement.hasValue === 'function' && subelement.hasValue('rdf:type')) {\n          subelement['rdf:type'].forEach(function (subRdfType) {\n            if (subRdfType.id == 'v-wf:VarDefine' || subRdfType.id == 'v-wf:Transform' || subRdfType.id == 'v-wf:Mapping') {\n              list.add(subelement);\n            }\n            if (subRdfType.id == 'v-wf:Mapping') {\n              list.add(subelement['v-wf:mapToVariable'][0]);\n            }\n          });\n        }\n      });\n    }\n  }\n}\n"],"file":"veda_workflow_editor.js"}