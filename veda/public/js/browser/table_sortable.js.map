{"version":3,"sources":["../../../source-web/js/browser/table_sortable.js"],"names":["$","System","import","then","module","moment","default","fn","tableSortable","clicked","each","i","el","table","hasClass","tbody","children","thead","ths","find","addClass","th","index","click","e","rows","preventDefault","stopPropagation","$this","target","siblings","removeClass","sort","orderDesc","orderAsc","detach","appendTo","order","compare","a","b","valueA","text","toLowerCase","trim","valueB","isNaN","isValid","valueOf","parseFloat"],"mappings":"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","sourcesContent":["// Sortable table plugin\n\nimport $ from 'jquery';\n\nSystem.import('moment').then((module) => {\n  const moment = module.default;\n\n  $.fn.tableSortable = function (clicked) {\n    return this.each((i, el) => {\n      const table = $(el);\n      if ( table.hasClass('table-sortable-done') ) {\n        return;\n      }\n      const tbody = table.children('tbody');\n      const thead = table.children('thead');\n      const ths = thead.find('tr:last-child > th');\n      table.addClass('table-sortable-done');\n\n      ths.each((i, el) => {\n        const th = $(el);\n        const index = th.index();\n\n        th.click((e) => {\n          const rows = tbody.children();\n          e.preventDefault();\n          e.stopPropagation();\n          const $this = $(e.target);\n          $this.siblings().removeClass('asc desc');\n          if ( $this.hasClass('asc') ) {\n            $this.removeClass('asc').addClass('desc');\n            rows.sort(orderDesc);\n          } else if ( $this.hasClass('desc') ) {\n            $this.addClass('asc').removeClass('desc');\n            rows.sort(orderAsc);\n          } else {\n            $this.addClass('asc');\n            rows.sort(orderAsc);\n          }\n          rows.detach().appendTo(tbody);\n        });\n\n        const order = function (compare) {\n          return function (a, b) {\n            let valueA = $(a).children(':nth-child(' + (index + 1) + ')').text().toLowerCase().trim();\n            let valueB = $(b).children(':nth-child(' + (index + 1) + ')').text().toLowerCase().trim();\n            if ( !isNaN(valueA) ) {\n              valueA = parseFloat(valueA);\n              valueB = parseFloat(valueB);\n            } else if ( moment(valueA, ['DD.MM.YYYY HH:mm:ss', 'DD.MM.YYYY', 'YYYY-MM-DDTHH:mm:ss.SSSZ', 'YYYY-MM-DD']).isValid() ) {\n              valueA = moment(valueA, ['DD.MM.YYYY HH:mm:ss', 'DD.MM.YYYY', 'YYYY-MM-DDTHH:mm:ss.SSSZ', 'YYYY-MM-DD']).valueOf();\n              valueB = moment(valueB, ['DD.MM.YYYY HH:mm:ss', 'DD.MM.YYYY', 'YYYY-MM-DDTHH:mm:ss.SSSZ', 'YYYY-MM-DD']).valueOf();\n            }\n            if ( compare(valueA, valueB) ) {\n              return -1;\n            } else if ( valueA == valueB ) {\n              return 0;\n            } else {\n              return 1;\n            }\n          };\n        };\n\n        const orderAsc = order((a, b) => a < b);\n        const orderDesc = order((a, b) => a > b);\n      });\n\n      clicked.click();\n    });\n  };\n});\n"],"file":"table_sortable.js"}